// ===========================================================================
// ======= THIS FILE IS AUTOGENERATED. PLEASE EDIT pga_gen.py INSTEAD ========
// ===========================================================================

// This module lays out the 3D projective geometric algebra (PGA)
// that we will be using. The metric is R(3,0,1).


// The following conventions are used for coefficients of the basis:
// a0
// + a1 * e0 + a2 * e1 + a3 * e2 + a4 * e3
// + a5 * e01 + a6 * e02 + a7 * e03 + a8 * e12 + a9 * e31 + a10 * e23
// + a11 * e021 + a12 * e013 + a13 * e032 + a14 * e123
// + a15 * e0123

// Operators:
// *  geometric product
// ^  wedge (meet)
// &  vee (join)
// |  dot

// This file heavily inspired by https://bivector.net/tools.html and their generated rust code.
// Hopefully the conventions here are the same as ganja.js and company,
// so there is good interoperability.
// One exception is that using ! to take the dual has been removed (use .dual())

use crate::global::{Float, FLOAT_DIVISION_EPSILON};
use std::ops::{Add, Sub, Mul, Neg, BitXor, BitAnd, BitOr};

pub trait Reverse {
    fn reverse(self) -> Self;
}

pub trait Dual {
    type Output;
    fn dual(self) -> Self::Output;
}

pub trait Conjugate {
    fn conjugate(self) -> Self;
}

pub trait Normalize {
    fn norm(self) -> Float;

    // Return a normalized copy
    fn hat(self) -> Self where Self: Copy + Mul<Float, Output=Self> {
        assert!(self.is_finite(), "norm is zero");
        self * (1. / self.norm())
    }

    fn is_finite(self) -> bool where Self: Copy {
        return self.norm() > FLOAT_DIVISION_EPSILON;
    }
}

pub trait NormalizeInfinite {
    fn inorm(self) -> Float;

    // Return a infinite-normalized copy
    fn ihat(self) -> Self where Self: Copy + Mul<Float, Output=Self> {
        assert!(self.is_infinite(), "inorm is zero");
        self * (1. / self.inorm())
    }

    fn is_infinite(self) -> bool where Self: Copy {
        return self.inorm() > FLOAT_DIVISION_EPSILON;
    }
}

pub trait Project<Entity> {
    fn project(self, r: Entity) -> Self;
}

pub trait Reflect<Entity> {
    fn reflect(self, r: Entity) -> Self;
}

pub trait Transform<Entity> {
    fn transform(self, r: Entity) -> Self;
}

// ===========================================================================
// Float
// ===========================================================================

impl Reverse for Float {
    fn reverse(self) -> Float {
        self
    }
}

impl Dual for Float {
    type Output = Pseudoscalar;

    fn dual(self) -> Pseudoscalar {
        Pseudoscalar {
            a15: self,
        }
    }
}

impl Conjugate for Float {
    fn conjugate(self) -> Float {
        self
    }
}

impl Normalize for Float {
    fn norm(self) -> Float {
        self.abs()
    }
}

impl NormalizeInfinite for Float {
    fn inorm(self) -> Float {
        0.
    }
}

impl Add<Vector> for Float {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Bivector> for Float {
    type Output = ScalarAndBivector;

    fn add(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
        }
    }
}

impl Add<Trivector> for Float {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: 0.,
        }
    }
}

impl Add<Pseudoscalar> for Float {
    type Output = FullMultivector;

    fn add(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: r.a15,
        }
    }
}

impl Add<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn add(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self + r.a0,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
        }
    }
}

impl Add<FullMultivector> for Float {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self + r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Vector> for Float {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Bivector> for Float {
    type Output = ScalarAndBivector;

    fn sub(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
        }
    }
}

impl Sub<Trivector> for Float {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: 0.,
        }
    }
}

impl Sub<Pseudoscalar> for Float {
    type Output = FullMultivector;

    fn sub(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -r.a15,
        }
    }
}

impl Sub<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn sub(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self - r.a0,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
        }
    }
}

impl Sub<FullMultivector> for Float {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self - r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Vector> for Float {
    type Output = Vector;

    fn mul(self, r: Vector) -> Vector {
        Vector {
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
        }
    }
}

impl Mul<Bivector> for Float {
    type Output = Bivector;

    fn mul(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl Mul<Trivector> for Float {
    type Output = Trivector;

    fn mul(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
        }
    }
}

impl Mul<Pseudoscalar> for Float {
    type Output = Pseudoscalar;

    fn mul(self, r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: self * r.a15,
        }
    }
}

impl Mul<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn mul(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self * r.a0,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl Mul<FullMultivector> for Float {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self * r.a0,
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
            a15: self * r.a15,
        }
    }
}

impl BitXor<Vector> for Float {
    type Output = Vector;

    fn bitxor(self, r: Vector) -> Vector {
        Vector {
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
        }
    }
}

impl BitXor<Bivector> for Float {
    type Output = Bivector;

    fn bitxor(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl BitXor<Trivector> for Float {
    type Output = Trivector;

    fn bitxor(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
        }
    }
}

impl BitXor<Pseudoscalar> for Float {
    type Output = Pseudoscalar;

    fn bitxor(self, r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: self * r.a15,
        }
    }
}

impl BitXor<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn bitxor(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self * r.a0,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl BitXor<FullMultivector> for Float {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self * r.a0,
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
            a15: self * r.a15,
        }
    }
}

impl BitAnd<Vector> for Float {
    type Output = Float;

    fn bitand(self, _r: Vector) -> Float {
        0.
    }
}

impl BitAnd<Bivector> for Float {
    type Output = Float;

    fn bitand(self, _r: Bivector) -> Float {
        0.
    }
}

impl BitAnd<Trivector> for Float {
    type Output = Float;

    fn bitand(self, _r: Trivector) -> Float {
        0.
    }
}

impl BitAnd<Pseudoscalar> for Float {
    type Output = Float;

    fn bitand(self, r: Pseudoscalar) -> Float {
        self * r.a15
    }
}

impl BitAnd<ScalarAndBivector> for Float {
    type Output = Float;

    fn bitand(self, _r: ScalarAndBivector) -> Float {
        0.
    }
}

impl BitAnd<FullMultivector> for Float {
    type Output = Float;

    fn bitand(self, r: FullMultivector) -> Float {
        self * r.a15
    }
}

impl BitOr<Vector> for Float {
    type Output = Vector;

    fn bitor(self, r: Vector) -> Vector {
        Vector {
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
        }
    }
}

impl BitOr<Bivector> for Float {
    type Output = Bivector;

    fn bitor(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl BitOr<Trivector> for Float {
    type Output = Trivector;

    fn bitor(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
        }
    }
}

impl BitOr<Pseudoscalar> for Float {
    type Output = Pseudoscalar;

    fn bitor(self, r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: self * r.a15,
        }
    }
}

impl BitOr<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn bitor(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self * r.a0,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl BitOr<FullMultivector> for Float {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self * r.a0,
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
            a15: self * r.a15,
        }
    }
}

impl Project<Float> for Float {
    fn project(self, r: Float) -> Float {
        self * r.powi(2)
    }
}

impl Project<Vector> for Float {
    fn project(self, r: Vector) -> Float {
        self * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2))
    }
}

impl Project<Trivector> for Float {
    fn project(self, r: Trivector) -> Float {
        -self * r.a14.powi(2)
    }
}

impl Project<Pseudoscalar> for Float {
    fn project(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

impl Reflect<Float> for Float {
    fn reflect(self, r: Float) -> Float {
        self * r.powi(2)
    }
}

impl Reflect<Vector> for Float {
    fn reflect(self, r: Vector) -> Float {
        self * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2))
    }
}

impl Reflect<Trivector> for Float {
    fn reflect(self, r: Trivector) -> Float {
        -self * r.a14.powi(2)
    }
}

impl Reflect<Pseudoscalar> for Float {
    fn reflect(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

impl Transform<Float> for Float {
    fn transform(self, r: Float) -> Float {
        self * r.powi(2)
    }
}

impl Transform<Vector> for Float {
    fn transform(self, r: Vector) -> Float {
        self * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2))
    }
}

impl Transform<Trivector> for Float {
    fn transform(self, r: Trivector) -> Float {
        self * r.a14.powi(2)
    }
}

impl Transform<Pseudoscalar> for Float {
    fn transform(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

// ===========================================================================
// Vector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct Vector {
    a1: Float,
    a2: Float,
    a3: Float,
    a4: Float,
}

impl Reverse for Vector {
    fn reverse(self) -> Vector {
        Vector {
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
        }
    }
}

impl Dual for Vector {
    type Output = Trivector;

    fn dual(self) -> Trivector {
        Trivector {
            a11: self.a4,
            a12: self.a3,
            a13: self.a2,
            a14: self.a1,
        }
    }
}

impl Conjugate for Vector {
    fn conjugate(self) -> Vector {
        Vector {
            a1: -self.a1,
            a2: -self.a2,
            a3: -self.a3,
            a4: -self.a4,
        }
    }
}

impl Normalize for Vector {
    fn norm(self) -> Float {
        (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)).sqrt()
    }
}

impl NormalizeInfinite for Vector {
    fn inorm(self) -> Float {
        self.a1.abs()
    }
}

impl Vector {
    pub fn new(a1: Float, a2: Float, a3: Float, a4: Float) -> Vector {
        Vector {a1, a2, a3, a4}
    }

    pub fn zero() -> Vector {
        Default::default()
    }

    pub fn as_tuple(&self) -> (Float, Float, Float, Float) {
        (self.a1, self.a2, self.a3, self.a4)
    }

    pub fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Neg for Vector {
    type Output = Vector;

    fn neg(self) -> Vector {
        Vector {
            a1: -self.a1,
            a2: -self.a2,
            a3: -self.a3,
            a4: -self.a4,
        }
    }
}

impl Add<Float> for Vector {
    type Output = FullMultivector;

    fn add(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Vector> for Vector {
    type Output = Vector;

    fn add(self, r: Vector) -> Vector {
        Vector {
            a1: self.a1 + r.a1,
            a2: self.a2 + r.a2,
            a3: self.a3 + r.a3,
            a4: self.a4 + r.a4,
        }
    }
}

impl Add<Bivector> for Vector {
    type Output = FullMultivector;

    fn add(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Trivector> for Vector {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: 0.,
        }
    }
}

impl Add<Pseudoscalar> for Vector {
    type Output = FullMultivector;

    fn add(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: r.a15,
        }
    }
}

impl Add<ScalarAndBivector> for Vector {
    type Output = FullMultivector;

    fn add(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: self.a1 + r.a1,
            a2: self.a2 + r.a2,
            a3: self.a3 + r.a3,
            a4: self.a4 + r.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Float> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: -r,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Vector> for Vector {
    type Output = Vector;

    fn sub(self, r: Vector) -> Vector {
        Vector {
            a1: self.a1 - r.a1,
            a2: self.a2 - r.a2,
            a3: self.a3 - r.a3,
            a4: self.a4 - r.a4,
        }
    }
}

impl Sub<Bivector> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Trivector> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: 0.,
        }
    }
}

impl Sub<Pseudoscalar> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -r.a15,
        }
    }
}

impl Sub<ScalarAndBivector> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: self.a1 - r.a1,
            a2: self.a2 - r.a2,
            a3: self.a3 - r.a3,
            a4: self.a4 - r.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Float> for Vector {
    type Output = Vector;

    fn mul(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
        }
    }
}

impl Mul<Vector> for Vector {
    type Output = ScalarAndBivector;

    fn mul(self, r: Vector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a5: self.a1 * r.a2 - self.a2 * r.a1,
            a6: self.a1 * r.a3 - self.a3 * r.a1,
            a7: self.a1 * r.a4 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2,
            a9: -self.a2 * r.a4 + self.a4 * r.a2,
            a10: self.a3 * r.a4 - self.a4 * r.a3,
        }
    }
}

impl Mul<Bivector> for Vector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: -self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: 0.,
        }
    }
}

impl Mul<Trivector> for Vector {
    type Output = FullMultivector;

    fn mul(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a2 * r.a11 - self.a4 * r.a13,
            a7: -self.a2 * r.a12 + self.a3 * r.a13,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl Mul<Pseudoscalar> for Vector {
    type Output = Trivector;

    fn mul(self, r: Pseudoscalar) -> Trivector {
        Trivector {
            a11: self.a4 * r.a15,
            a12: self.a3 * r.a15,
            a13: self.a2 * r.a15,
            a14: 0.,
        }
    }
}

impl Mul<ScalarAndBivector> for Vector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: 0.,
        }
    }
}

impl Mul<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0,
            a5: self.a1 * r.a2 - self.a2 * r.a1 - self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a1 * r.a3 + self.a2 * r.a11 - self.a3 * r.a1 - self.a4 * r.a13,
            a7: self.a1 * r.a4 - self.a2 * r.a12 + self.a3 * r.a13 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2 + self.a4 * r.a14,
            a9: -self.a2 * r.a4 + self.a3 * r.a14 + self.a4 * r.a2,
            a10: self.a2 * r.a14 + self.a3 * r.a4 - self.a4 * r.a3,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a4 * r.a15,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a3 * r.a15 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a2 * r.a15 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl BitXor<Float> for Vector {
    type Output = Vector;

    fn bitxor(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
        }
    }
}

impl BitXor<Vector> for Vector {
    type Output = Bivector;

    fn bitxor(self, r: Vector) -> Bivector {
        Bivector {
            a5: self.a1 * r.a2 - self.a2 * r.a1,
            a6: self.a1 * r.a3 - self.a3 * r.a1,
            a7: self.a1 * r.a4 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2,
            a9: -self.a2 * r.a4 + self.a4 * r.a2,
            a10: self.a3 * r.a4 - self.a4 * r.a3,
        }
    }
}

impl BitXor<Bivector> for Vector {
    type Output = Trivector;

    fn bitxor(self, r: Bivector) -> Trivector {
        Trivector {
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
        }
    }
}

impl BitXor<Trivector> for Vector {
    type Output = Pseudoscalar;

    fn bitxor(self, r: Trivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl BitXor<Pseudoscalar> for Vector {
    type Output = Float;

    fn bitxor(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

impl BitXor<ScalarAndBivector> for Vector {
    type Output = FullMultivector;

    fn bitxor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1 * r.a0,
            a2: self.a2 * r.a0,
            a3: self.a3 * r.a0,
            a4: self.a4 * r.a0,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: 0.,
        }
    }
}

impl BitXor<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1 * r.a0,
            a2: self.a2 * r.a0,
            a3: self.a3 * r.a0,
            a4: self.a4 * r.a0,
            a5: self.a1 * r.a2 - self.a2 * r.a1,
            a6: self.a1 * r.a3 - self.a3 * r.a1,
            a7: self.a1 * r.a4 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2,
            a9: -self.a2 * r.a4 + self.a4 * r.a2,
            a10: self.a3 * r.a4 - self.a4 * r.a3,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl BitAnd<Float> for Vector {
    type Output = Float;

    fn bitand(self, _r: Float) -> Float {
        0.
    }
}

impl BitAnd<Vector> for Vector {
    type Output = Float;

    fn bitand(self, _r: Vector) -> Float {
        0.
    }
}

impl BitAnd<Bivector> for Vector {
    type Output = Float;

    fn bitand(self, _r: Bivector) -> Float {
        0.
    }
}

impl BitAnd<Trivector> for Vector {
    type Output = Float;

    fn bitand(self, r: Trivector) -> Float {
        -self.a1 * r.a14 - self.a2 * r.a13 - self.a3 * r.a12 - self.a4 * r.a11
    }
}

impl BitAnd<Pseudoscalar> for Vector {
    type Output = Vector;

    fn bitand(self, r: Pseudoscalar) -> Vector {
        Vector {
            a1: self.a1 * r.a15,
            a2: self.a2 * r.a15,
            a3: self.a3 * r.a15,
            a4: self.a4 * r.a15,
        }
    }
}

impl BitAnd<ScalarAndBivector> for Vector {
    type Output = Float;

    fn bitand(self, _r: ScalarAndBivector) -> Float {
        0.
    }
}

impl BitAnd<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a1 * r.a14 - self.a2 * r.a13 - self.a3 * r.a12 - self.a4 * r.a11,
            a1: self.a1 * r.a15,
            a2: self.a2 * r.a15,
            a3: self.a3 * r.a15,
            a4: self.a4 * r.a15,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Float> for Vector {
    type Output = Vector;

    fn bitor(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
        }
    }
}

impl BitOr<Vector> for Vector {
    type Output = Float;

    fn bitor(self, r: Vector) -> Float {
        self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4
    }
}

impl BitOr<Bivector> for Vector {
    type Output = Vector;

    fn bitor(self, r: Bivector) -> Vector {
        Vector {
            a1: -self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: -self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10,
        }
    }
}

impl BitOr<Trivector> for Vector {
    type Output = Bivector;

    fn bitor(self, r: Trivector) -> Bivector {
        Bivector {
            a5: -self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a2 * r.a11 - self.a4 * r.a13,
            a7: -self.a2 * r.a12 + self.a3 * r.a13,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
        }
    }
}

impl BitOr<Pseudoscalar> for Vector {
    type Output = Trivector;

    fn bitor(self, r: Pseudoscalar) -> Trivector {
        Trivector {
            a11: self.a4 * r.a15,
            a12: self.a3 * r.a15,
            a13: self.a2 * r.a15,
            a14: 0.,
        }
    }
}

impl BitOr<ScalarAndBivector> for Vector {
    type Output = Vector;

    fn bitor(self, r: ScalarAndBivector) -> Vector {
        Vector {
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0,
        }
    }
}

impl BitOr<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0,
            a5: -self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a2 * r.a11 - self.a4 * r.a13,
            a7: -self.a2 * r.a12 + self.a3 * r.a13,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
            a11: self.a4 * r.a15,
            a12: self.a3 * r.a15,
            a13: self.a2 * r.a15,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Project<Float> for Vector {
    fn project(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r.powi(2),
            a2: self.a2 * r.powi(2),
            a3: self.a3 * r.powi(2),
            a4: self.a4 * r.powi(2),
        }
    }
}

impl Project<Vector> for Vector {
    fn project(self, r: Vector) -> Vector {
        Vector {
            a1: r.a1 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
            a2: r.a2 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
            a3: r.a3 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
            a4: r.a4 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
        }
    }
}

impl Project<Trivector> for Vector {
    fn project(self, r: Trivector) -> Vector {
        Vector {
            a1: r.a14 * (self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11),
            a2: -self.a2 * r.a14.powi(2),
            a3: -self.a3 * r.a14.powi(2),
            a4: -self.a4 * r.a14.powi(2),
        }
    }
}

impl Project<Pseudoscalar> for Vector {
    fn project(self, _r: Pseudoscalar) -> Vector {
        Vector {
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }
}

impl Reflect<Float> for Vector {
    fn reflect(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r.powi(2),
            a2: self.a2 * r.powi(2),
            a3: self.a3 * r.powi(2),
            a4: self.a4 * r.powi(2),
        }
    }
}

impl Reflect<Vector> for Vector {
    fn reflect(self, r: Vector) -> Vector {
        Vector {
            a1: -self.a1 * r.a2.powi(2) - self.a1 * r.a3.powi(2) - self.a1 * r.a4.powi(2) + 2. * self.a2 * r.a1 * r.a2 + 2. * self.a3 * r.a1 * r.a3 + 2. * self.a4 * r.a1 * r.a4,
            a2: r.a2 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) - r.a3 * (self.a2 * r.a3 - self.a3 * r.a2) - r.a4 * (self.a2 * r.a4 - self.a4 * r.a2),
            a3: r.a2 * (self.a2 * r.a3 - self.a3 * r.a2) + r.a3 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) - r.a4 * (self.a3 * r.a4 - self.a4 * r.a3),
            a4: r.a2 * (self.a2 * r.a4 - self.a4 * r.a2) + r.a3 * (self.a3 * r.a4 - self.a4 * r.a3) + r.a4 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
        }
    }
}

impl Reflect<Bivector> for Vector {
    fn reflect(self, r: Bivector) -> Vector {
        Vector {
            a1: -self.a1 * r.a8.powi(2) - self.a1 * r.a9.powi(2) - self.a1 * r.a10.powi(2) + 2. * self.a2 * r.a6 * r.a8 - 2. * self.a2 * r.a7 * r.a9 - 2. * self.a3 * r.a5 * r.a8 + 2. * self.a3 * r.a7 * r.a10 + 2. * self.a4 * r.a5 * r.a9 - 2. * self.a4 * r.a6 * r.a10,
            a2: r.a8 * (self.a2 * r.a8 - self.a4 * r.a10) + r.a9 * (self.a2 * r.a9 - self.a3 * r.a10) - r.a10 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8),
            a3: r.a8 * (self.a3 * r.a8 - self.a4 * r.a9) - r.a9 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) - r.a10 * (self.a2 * r.a9 - self.a3 * r.a10),
            a4: -2. * self.a2 * r.a8 * r.a10 - 2. * self.a3 * r.a8 * r.a9 - self.a4 * r.a8.powi(2) + self.a4 * r.a9.powi(2) + self.a4 * r.a10.powi(2),
        }
    }
}

impl Reflect<Trivector> for Vector {
    fn reflect(self, r: Trivector) -> Vector {
        Vector {
            a1: r.a14 * (self.a1 * r.a14 + 2. * self.a2 * r.a13 + 2. * self.a3 * r.a12 + 2. * self.a4 * r.a11),
            a2: -self.a2 * r.a14.powi(2),
            a3: -self.a3 * r.a14.powi(2),
            a4: -self.a4 * r.a14.powi(2),
        }
    }
}

impl Reflect<Pseudoscalar> for Vector {
    fn reflect(self, _r: Pseudoscalar) -> Vector {
        Vector {
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }
}

impl Transform<Float> for Vector {
    fn transform(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r.powi(2),
            a2: self.a2 * r.powi(2),
            a3: self.a3 * r.powi(2),
            a4: self.a4 * r.powi(2),
        }
    }
}

impl Transform<Vector> for Vector {
    fn transform(self, r: Vector) -> Vector {
        Vector {
            a1: -self.a1 * r.a2.powi(2) - self.a1 * r.a3.powi(2) - self.a1 * r.a4.powi(2) + 2. * self.a2 * r.a1 * r.a2 + 2. * self.a3 * r.a1 * r.a3 + 2. * self.a4 * r.a1 * r.a4,
            a2: r.a2 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) - r.a3 * (self.a2 * r.a3 - self.a3 * r.a2) - r.a4 * (self.a2 * r.a4 - self.a4 * r.a2),
            a3: r.a2 * (self.a2 * r.a3 - self.a3 * r.a2) + r.a3 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) - r.a4 * (self.a3 * r.a4 - self.a4 * r.a3),
            a4: r.a2 * (self.a2 * r.a4 - self.a4 * r.a2) + r.a3 * (self.a3 * r.a4 - self.a4 * r.a3) + r.a4 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
        }
    }
}

impl Transform<Bivector> for Vector {
    fn transform(self, r: Bivector) -> Vector {
        Vector {
            a1: self.a1 * r.a8.powi(2) + self.a1 * r.a9.powi(2) + self.a1 * r.a10.powi(2) - 2. * self.a2 * r.a6 * r.a8 + 2. * self.a2 * r.a7 * r.a9 + 2. * self.a3 * r.a5 * r.a8 - 2. * self.a3 * r.a7 * r.a10 - 2. * self.a4 * r.a5 * r.a9 + 2. * self.a4 * r.a6 * r.a10,
            a2: -r.a8 * (self.a2 * r.a8 - self.a4 * r.a10) - r.a9 * (self.a2 * r.a9 - self.a3 * r.a10) + r.a10 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8),
            a3: -r.a8 * (self.a3 * r.a8 - self.a4 * r.a9) + r.a9 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + r.a10 * (self.a2 * r.a9 - self.a3 * r.a10),
            a4: r.a8 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + r.a9 * (self.a3 * r.a8 - self.a4 * r.a9) + r.a10 * (self.a2 * r.a8 - self.a4 * r.a10),
        }
    }
}

impl Transform<Trivector> for Vector {
    fn transform(self, r: Trivector) -> Vector {
        Vector {
            a1: r.a14 * (-self.a1 * r.a14 - 2. * self.a2 * r.a13 - 2. * self.a3 * r.a12 - 2. * self.a4 * r.a11),
            a2: self.a2 * r.a14.powi(2),
            a3: self.a3 * r.a14.powi(2),
            a4: self.a4 * r.a14.powi(2),
        }
    }
}

impl Transform<Pseudoscalar> for Vector {
    fn transform(self, _r: Pseudoscalar) -> Vector {
        Vector {
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }
}

impl Transform<ScalarAndBivector> for Vector {
    fn transform(self, r: ScalarAndBivector) -> Vector {
        Vector {
            a1: self.a1 * r.a0.powi(2) + self.a1 * r.a8.powi(2) + self.a1 * r.a9.powi(2) + self.a1 * r.a10.powi(2) + 2. * self.a2 * r.a0 * r.a5 - 2. * self.a2 * r.a6 * r.a8 + 2. * self.a2 * r.a7 * r.a9 + 2. * self.a3 * r.a0 * r.a6 + 2. * self.a3 * r.a5 * r.a8 - 2. * self.a3 * r.a7 * r.a10 + 2. * self.a4 * r.a0 * r.a7 - 2. * self.a4 * r.a5 * r.a9 + 2. * self.a4 * r.a6 * r.a10,
            a2: r.a0 * (self.a2 * r.a0 + self.a3 * r.a8 - self.a4 * r.a9) + r.a8 * (-self.a2 * r.a8 + self.a3 * r.a0 + self.a4 * r.a10) - r.a9 * (self.a2 * r.a9 - self.a3 * r.a10 + self.a4 * r.a0) + r.a10 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8),
            a3: r.a0 * (-self.a2 * r.a8 + self.a3 * r.a0 + self.a4 * r.a10) - r.a8 * (self.a2 * r.a0 + self.a3 * r.a8 - self.a4 * r.a9) + r.a9 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + r.a10 * (self.a2 * r.a9 - self.a3 * r.a10 + self.a4 * r.a0),
            a4: r.a0 * (self.a2 * r.a9 - self.a3 * r.a10 + self.a4 * r.a0) + r.a8 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + r.a9 * (self.a2 * r.a0 + self.a3 * r.a8 - self.a4 * r.a9) - r.a10 * (-self.a2 * r.a8 + self.a3 * r.a0 + self.a4 * r.a10),
        }
    }
}

// ===========================================================================
// Bivector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct Bivector {
    a5: Float,
    a6: Float,
    a7: Float,
    a8: Float,
    a9: Float,
    a10: Float,
}

impl Reverse for Bivector {
    fn reverse(self) -> Bivector {
        Bivector {
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }
}

impl Dual for Bivector {
    type Output = Bivector;

    fn dual(self) -> Bivector {
        Bivector {
            a5: self.a10,
            a6: self.a9,
            a7: self.a8,
            a8: self.a7,
            a9: self.a6,
            a10: self.a5,
        }
    }
}

impl Conjugate for Bivector {
    fn conjugate(self) -> Bivector {
        Bivector {
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }
}

impl Normalize for Bivector {
    fn norm(self) -> Float {
        (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)).sqrt()
    }
}

impl NormalizeInfinite for Bivector {
    fn inorm(self) -> Float {
        (self.a5.powi(2) + self.a6.powi(2) + self.a7.powi(2)).sqrt()
    }
}

impl Bivector {
    pub fn new(a5: Float, a6: Float, a7: Float, a8: Float, a9: Float, a10: Float) -> Bivector {
        Bivector {a5, a6, a7, a8, a9, a10}
    }

    pub fn zero() -> Bivector {
        Default::default()
    }

    pub fn as_tuple(&self) -> (Float, Float, Float, Float, Float, Float) {
        (self.a5, self.a6, self.a7, self.a8, self.a9, self.a10)
    }

    pub fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Neg for Bivector {
    type Output = Bivector;

    fn neg(self) -> Bivector {
        Bivector {
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }
}

impl Add<Float> for Bivector {
    type Output = ScalarAndBivector;

    fn add(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: r,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }
}

impl Add<Vector> for Bivector {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Bivector> for Bivector {
    type Output = Bivector;

    fn add(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
        }
    }
}

impl Add<Trivector> for Bivector {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: 0.,
        }
    }
}

impl Add<Pseudoscalar> for Bivector {
    type Output = FullMultivector;

    fn add(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: r.a15,
        }
    }
}

impl Add<ScalarAndBivector> for Bivector {
    type Output = ScalarAndBivector;

    fn add(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: r.a0,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
        }
    }
}

impl Add<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Float> for Bivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -r,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }
}

impl Sub<Vector> for Bivector {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Bivector> for Bivector {
    type Output = Bivector;

    fn sub(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
        }
    }
}

impl Sub<Trivector> for Bivector {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: 0.,
        }
    }
}

impl Sub<Pseudoscalar> for Bivector {
    type Output = FullMultivector;

    fn sub(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -r.a15,
        }
    }
}

impl Sub<ScalarAndBivector> for Bivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -r.a0,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
        }
    }
}

impl Sub<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Float> for Bivector {
    type Output = Bivector;

    fn mul(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl Mul<Vector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a8 * r.a3 - self.a9 * r.a4,
            a3: -self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a9 * r.a2 - self.a10 * r.a3,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: 0.,
        }
    }
}

impl Mul<Bivector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7,
            a6: self.a5 * r.a8 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7,
            a7: -self.a5 * r.a9 + self.a6 * r.a10 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a9 * r.a10 - self.a10 * r.a9,
            a9: -self.a8 * r.a10 + self.a10 * r.a8,
            a10: self.a8 * r.a9 - self.a9 * r.a8,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<Trivector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a13: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Mul<Pseudoscalar> for Bivector {
    type Output = Bivector;

    fn mul(self, r: Pseudoscalar) -> Bivector {
        Bivector {
            a5: -self.a10 * r.a15,
            a6: -self.a9 * r.a15,
            a7: -self.a8 * r.a15,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Mul<ScalarAndBivector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7,
            a6: self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7,
            a7: -self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: -self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14,
            a3: -self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4,
            a4: -self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a10 * r.a15,
            a6: self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 - self.a9 * r.a15 + self.a10 * r.a7,
            a7: -self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 - self.a8 * r.a15 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: -self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a7 * r.a14 - self.a8 * r.a1 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: self.a5 * r.a4 - self.a6 * r.a14 - self.a7 * r.a2 - self.a8 * r.a13 - self.a9 * r.a1 + self.a10 * r.a11,
            a13: -self.a5 * r.a14 - self.a6 * r.a4 + self.a7 * r.a3 + self.a8 * r.a12 - self.a9 * r.a11 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Float> for Bivector {
    type Output = Bivector;

    fn bitxor(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl BitXor<Vector> for Bivector {
    type Output = Trivector;

    fn bitxor(self, r: Vector) -> Trivector {
        Trivector {
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
        }
    }
}

impl BitXor<Bivector> for Bivector {
    type Output = Pseudoscalar;

    fn bitxor(self, r: Bivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Trivector> for Bivector {
    type Output = Float;

    fn bitxor(self, _r: Trivector) -> Float {
        0.
    }
}

impl BitXor<Pseudoscalar> for Bivector {
    type Output = Float;

    fn bitxor(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

impl BitXor<ScalarAndBivector> for Bivector {
    type Output = FullMultivector;

    fn bitxor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5 * r.a0,
            a6: self.a6 * r.a0,
            a7: self.a7 * r.a0,
            a8: self.a8 * r.a0,
            a9: self.a9 * r.a0,
            a10: self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5 * r.a0,
            a6: self.a6 * r.a0,
            a7: self.a7 * r.a0,
            a8: self.a8 * r.a0,
            a9: self.a9 * r.a0,
            a10: self.a10 * r.a0,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitAnd<Float> for Bivector {
    type Output = Float;

    fn bitand(self, _r: Float) -> Float {
        0.
    }
}

impl BitAnd<Vector> for Bivector {
    type Output = Float;

    fn bitand(self, _r: Vector) -> Float {
        0.
    }
}

impl BitAnd<Bivector> for Bivector {
    type Output = Float;

    fn bitand(self, r: Bivector) -> Float {
        self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5
    }
}

impl BitAnd<Trivector> for Bivector {
    type Output = Vector;

    fn bitand(self, r: Trivector) -> Vector {
        Vector {
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
        }
    }
}

impl BitAnd<Pseudoscalar> for Bivector {
    type Output = Bivector;

    fn bitand(self, r: Pseudoscalar) -> Bivector {
        Bivector {
            a5: self.a5 * r.a15,
            a6: self.a6 * r.a15,
            a7: self.a7 * r.a15,
            a8: self.a8 * r.a15,
            a9: self.a9 * r.a15,
            a10: self.a10 * r.a15,
        }
    }
}

impl BitAnd<ScalarAndBivector> for Bivector {
    type Output = Float;

    fn bitand(self, r: ScalarAndBivector) -> Float {
        self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5
    }
}

impl BitAnd<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a5: self.a5 * r.a15,
            a6: self.a6 * r.a15,
            a7: self.a7 * r.a15,
            a8: self.a8 * r.a15,
            a9: self.a9 * r.a15,
            a10: self.a10 * r.a15,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Float> for Bivector {
    type Output = Bivector;

    fn bitor(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl BitOr<Vector> for Bivector {
    type Output = Vector;

    fn bitor(self, r: Vector) -> Vector {
        Vector {
            a1: self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a8 * r.a3 - self.a9 * r.a4,
            a3: -self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a9 * r.a2 - self.a10 * r.a3,
        }
    }
}

impl BitOr<Bivector> for Bivector {
    type Output = Float;

    fn bitor(self, r: Bivector) -> Float {
        -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10
    }
}

impl BitOr<Trivector> for Bivector {
    type Output = Vector;

    fn bitor(self, r: Trivector) -> Vector {
        Vector {
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
        }
    }
}

impl BitOr<Pseudoscalar> for Bivector {
    type Output = Bivector;

    fn bitor(self, r: Pseudoscalar) -> Bivector {
        Bivector {
            a5: -self.a10 * r.a15,
            a6: -self.a9 * r.a15,
            a7: -self.a8 * r.a15,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl BitOr<ScalarAndBivector> for Bivector {
    type Output = ScalarAndBivector;

    fn bitor(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a5: self.a5 * r.a0,
            a6: self.a6 * r.a0,
            a7: self.a7 * r.a0,
            a8: self.a8 * r.a0,
            a9: self.a9 * r.a0,
            a10: self.a10 * r.a0,
        }
    }
}

impl BitOr<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14,
            a3: -self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4,
            a4: -self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a5 * r.a0 - self.a10 * r.a15,
            a6: self.a6 * r.a0 - self.a9 * r.a15,
            a7: self.a7 * r.a0 - self.a8 * r.a15,
            a8: self.a8 * r.a0,
            a9: self.a9 * r.a0,
            a10: self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Project<Float> for Bivector {
    fn project(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
        }
    }
}

impl Project<Vector> for Bivector {
    fn project(self, r: Vector) -> Bivector {
        Bivector {
            a5: -r.a1 * (self.a8 * r.a3 - self.a9 * r.a4) + r.a2 * (self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4),
            a6: r.a1 * (self.a8 * r.a2 - self.a10 * r.a4) + r.a3 * (self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4),
            a7: -r.a1 * (self.a9 * r.a2 - self.a10 * r.a3) + r.a4 * (self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4),
            a8: r.a2 * (self.a8 * r.a2 - self.a10 * r.a4) + r.a3 * (self.a8 * r.a3 - self.a9 * r.a4),
            a9: r.a2 * (self.a9 * r.a2 - self.a10 * r.a3) - r.a4 * (self.a8 * r.a3 - self.a9 * r.a4),
            a10: -r.a3 * (self.a9 * r.a2 - self.a10 * r.a3) - r.a4 * (self.a8 * r.a2 - self.a10 * r.a4),
        }
    }
}

impl Project<Bivector> for Bivector {
    fn project(self, r: Bivector) -> Bivector {
        Bivector {
            a5: -r.a5 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a6: -r.a6 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a7: -r.a7 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a8: -r.a8 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a9: -r.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a10: -r.a10 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
        }
    }
}

impl Project<Trivector> for Bivector {
    fn project(self, r: Trivector) -> Bivector {
        Bivector {
            a5: r.a14 * (-self.a8 * r.a12 + self.a9 * r.a11),
            a6: r.a14 * (self.a8 * r.a13 - self.a10 * r.a11),
            a7: r.a14 * (-self.a9 * r.a13 + self.a10 * r.a12),
            a8: -self.a8 * r.a14.powi(2),
            a9: -self.a9 * r.a14.powi(2),
            a10: -self.a10 * r.a14.powi(2),
        }
    }
}

impl Project<Pseudoscalar> for Bivector {
    fn project(self, _r: Pseudoscalar) -> Bivector {
        Bivector {
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Reflect<Float> for Bivector {
    fn reflect(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
        }
    }
}

impl Reflect<Vector> for Bivector {
    fn reflect(self, r: Vector) -> Bivector {
        Bivector {
            a5: -self.a5 * r.a2.powi(2) + self.a5 * r.a3.powi(2) + self.a5 * r.a4.powi(2) - 2. * self.a6 * r.a2 * r.a3 - 2. * self.a7 * r.a2 * r.a4 + 2. * self.a8 * r.a1 * r.a3 - 2. * self.a9 * r.a1 * r.a4,
            a6: -2. * self.a5 * r.a2 * r.a3 + self.a6 * r.a2.powi(2) - self.a6 * r.a3.powi(2) + self.a6 * r.a4.powi(2) - 2. * self.a7 * r.a3 * r.a4 - 2. * self.a8 * r.a1 * r.a2 + 2. * self.a10 * r.a1 * r.a4,
            a7: -2. * self.a5 * r.a2 * r.a4 - 2. * self.a6 * r.a3 * r.a4 + self.a7 * r.a2.powi(2) + self.a7 * r.a3.powi(2) - self.a7 * r.a4.powi(2) + 2. * self.a9 * r.a1 * r.a2 - 2. * self.a10 * r.a1 * r.a3,
            a8: -r.a2 * (self.a8 * r.a2 - self.a10 * r.a4) - r.a3 * (self.a8 * r.a3 - self.a9 * r.a4) + r.a4 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2),
            a9: -r.a2 * (self.a9 * r.a2 - self.a10 * r.a3) + r.a3 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + r.a4 * (self.a8 * r.a3 - self.a9 * r.a4),
            a10: r.a2 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + r.a3 * (self.a9 * r.a2 - self.a10 * r.a3) + r.a4 * (self.a8 * r.a2 - self.a10 * r.a4),
        }
    }
}

impl Reflect<Bivector> for Bivector {
    fn reflect(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a5 * r.a8.powi(2) + self.a5 * r.a9.powi(2) - self.a5 * r.a10.powi(2) - 2. * self.a6 * r.a9 * r.a10 - 2. * self.a7 * r.a8 * r.a10 - 2. * self.a8 * r.a5 * r.a8 - 2. * self.a8 * r.a7 * r.a10 - 2. * self.a9 * r.a5 * r.a9 - 2. * self.a9 * r.a6 * r.a10 - 2. * self.a10 * r.a5 * r.a10 + 2. * self.a10 * r.a6 * r.a9 + 2. * self.a10 * r.a7 * r.a8,
            a6: -2. * self.a5 * r.a9 * r.a10 + self.a6 * r.a8.powi(2) - self.a6 * r.a9.powi(2) + self.a6 * r.a10.powi(2) - 2. * self.a7 * r.a8 * r.a9 - 2. * self.a8 * r.a6 * r.a8 - 2. * self.a8 * r.a7 * r.a9 + 2. * self.a9 * r.a5 * r.a10 - 2. * self.a9 * r.a6 * r.a9 + 2. * self.a9 * r.a7 * r.a8 - 2. * self.a10 * r.a5 * r.a9 - 2. * self.a10 * r.a6 * r.a10,
            a7: -2. * self.a5 * r.a8 * r.a10 - 2. * self.a6 * r.a8 * r.a9 - self.a7 * r.a8.powi(2) + self.a7 * r.a9.powi(2) + self.a7 * r.a10.powi(2) + 2. * self.a8 * r.a5 * r.a10 + 2. * self.a8 * r.a6 * r.a9 - 2. * self.a8 * r.a7 * r.a8 - 2. * self.a9 * r.a6 * r.a8 - 2. * self.a9 * r.a7 * r.a9 - 2. * self.a10 * r.a5 * r.a8 - 2. * self.a10 * r.a7 * r.a10,
            a8: -r.a8 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + r.a9 * (self.a8 * r.a9 - self.a9 * r.a8) + r.a10 * (self.a8 * r.a10 - self.a10 * r.a8),
            a9: -r.a8 * (self.a8 * r.a9 - self.a9 * r.a8) - r.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + r.a10 * (self.a9 * r.a10 - self.a10 * r.a9),
            a10: -2. * self.a8 * r.a8 * r.a10 - 2. * self.a9 * r.a9 * r.a10 + self.a10 * r.a8.powi(2) + self.a10 * r.a9.powi(2) - self.a10 * r.a10.powi(2),
        }
    }
}

impl Reflect<Trivector> for Bivector {
    fn reflect(self, r: Trivector) -> Bivector {
        Bivector {
            a5: r.a14 * (self.a5 * r.a14 - 2. * self.a8 * r.a12 + 2. * self.a9 * r.a11),
            a6: r.a14 * (self.a6 * r.a14 + 2. * self.a8 * r.a13 - 2. * self.a10 * r.a11),
            a7: r.a14 * (self.a7 * r.a14 - 2. * self.a9 * r.a13 + 2. * self.a10 * r.a12),
            a8: -self.a8 * r.a14.powi(2),
            a9: -self.a9 * r.a14.powi(2),
            a10: -self.a10 * r.a14.powi(2),
        }
    }
}

impl Reflect<Pseudoscalar> for Bivector {
    fn reflect(self, _r: Pseudoscalar) -> Bivector {
        Bivector {
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Transform<Float> for Bivector {
    fn transform(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
        }
    }
}

impl Transform<Vector> for Bivector {
    fn transform(self, r: Vector) -> Bivector {
        Bivector {
            a5: -self.a5 * r.a2.powi(2) + self.a5 * r.a3.powi(2) + self.a5 * r.a4.powi(2) - 2. * self.a6 * r.a2 * r.a3 - 2. * self.a7 * r.a2 * r.a4 + 2. * self.a8 * r.a1 * r.a3 - 2. * self.a9 * r.a1 * r.a4,
            a6: -2. * self.a5 * r.a2 * r.a3 + self.a6 * r.a2.powi(2) - self.a6 * r.a3.powi(2) + self.a6 * r.a4.powi(2) - 2. * self.a7 * r.a3 * r.a4 - 2. * self.a8 * r.a1 * r.a2 + 2. * self.a10 * r.a1 * r.a4,
            a7: -2. * self.a5 * r.a2 * r.a4 - 2. * self.a6 * r.a3 * r.a4 + self.a7 * r.a2.powi(2) + self.a7 * r.a3.powi(2) - self.a7 * r.a4.powi(2) + 2. * self.a9 * r.a1 * r.a2 - 2. * self.a10 * r.a1 * r.a3,
            a8: -r.a2 * (self.a8 * r.a2 - self.a10 * r.a4) - r.a3 * (self.a8 * r.a3 - self.a9 * r.a4) + r.a4 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2),
            a9: -r.a2 * (self.a9 * r.a2 - self.a10 * r.a3) + r.a3 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + r.a4 * (self.a8 * r.a3 - self.a9 * r.a4),
            a10: r.a2 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + r.a3 * (self.a9 * r.a2 - self.a10 * r.a3) + r.a4 * (self.a8 * r.a2 - self.a10 * r.a4),
        }
    }
}

impl Transform<Bivector> for Bivector {
    fn transform(self, r: Bivector) -> Bivector {
        Bivector {
            a5: -self.a5 * r.a8.powi(2) - self.a5 * r.a9.powi(2) + self.a5 * r.a10.powi(2) + 2. * self.a6 * r.a9 * r.a10 + 2. * self.a7 * r.a8 * r.a10 + 2. * self.a8 * r.a5 * r.a8 + 2. * self.a8 * r.a7 * r.a10 + 2. * self.a9 * r.a5 * r.a9 + 2. * self.a9 * r.a6 * r.a10 + 2. * self.a10 * r.a5 * r.a10 - 2. * self.a10 * r.a6 * r.a9 - 2. * self.a10 * r.a7 * r.a8,
            a6: 2. * self.a5 * r.a9 * r.a10 - self.a6 * r.a8.powi(2) + self.a6 * r.a9.powi(2) - self.a6 * r.a10.powi(2) + 2. * self.a7 * r.a8 * r.a9 + 2. * self.a8 * r.a6 * r.a8 + 2. * self.a8 * r.a7 * r.a9 - 2. * self.a9 * r.a5 * r.a10 + 2. * self.a9 * r.a6 * r.a9 - 2. * self.a9 * r.a7 * r.a8 + 2. * self.a10 * r.a5 * r.a9 + 2. * self.a10 * r.a6 * r.a10,
            a7: 2. * self.a5 * r.a8 * r.a10 + 2. * self.a6 * r.a8 * r.a9 + self.a7 * r.a8.powi(2) - self.a7 * r.a9.powi(2) - self.a7 * r.a10.powi(2) - 2. * self.a8 * r.a5 * r.a10 - 2. * self.a8 * r.a6 * r.a9 + 2. * self.a8 * r.a7 * r.a8 + 2. * self.a9 * r.a6 * r.a8 + 2. * self.a9 * r.a7 * r.a9 + 2. * self.a10 * r.a5 * r.a8 + 2. * self.a10 * r.a7 * r.a10,
            a8: r.a8 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) - r.a9 * (self.a8 * r.a9 - self.a9 * r.a8) - r.a10 * (self.a8 * r.a10 - self.a10 * r.a8),
            a9: r.a8 * (self.a8 * r.a9 - self.a9 * r.a8) + r.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) - r.a10 * (self.a9 * r.a10 - self.a10 * r.a9),
            a10: r.a8 * (self.a8 * r.a10 - self.a10 * r.a8) + r.a9 * (self.a9 * r.a10 - self.a10 * r.a9) + r.a10 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
        }
    }
}

impl Transform<Trivector> for Bivector {
    fn transform(self, r: Trivector) -> Bivector {
        Bivector {
            a5: r.a14 * (-self.a5 * r.a14 + 2. * self.a8 * r.a12 - 2. * self.a9 * r.a11),
            a6: r.a14 * (-self.a6 * r.a14 - 2. * self.a8 * r.a13 + 2. * self.a10 * r.a11),
            a7: r.a14 * (-self.a7 * r.a14 + 2. * self.a9 * r.a13 - 2. * self.a10 * r.a12),
            a8: self.a8 * r.a14.powi(2),
            a9: self.a9 * r.a14.powi(2),
            a10: self.a10 * r.a14.powi(2),
        }
    }
}

impl Transform<Pseudoscalar> for Bivector {
    fn transform(self, _r: Pseudoscalar) -> Bivector {
        Bivector {
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Transform<ScalarAndBivector> for Bivector {
    fn transform(self, r: ScalarAndBivector) -> Bivector {
        Bivector {
            a5: self.a5 * r.a0.powi(2) - self.a5 * r.a8.powi(2) - self.a5 * r.a9.powi(2) + self.a5 * r.a10.powi(2) + 2. * self.a6 * r.a0 * r.a8 + 2. * self.a6 * r.a9 * r.a10 - 2. * self.a7 * r.a0 * r.a9 + 2. * self.a7 * r.a8 * r.a10 - 2. * self.a8 * r.a0 * r.a6 + 2. * self.a8 * r.a5 * r.a8 + 2. * self.a8 * r.a7 * r.a10 + 2. * self.a9 * r.a0 * r.a7 + 2. * self.a9 * r.a5 * r.a9 + 2. * self.a9 * r.a6 * r.a10 + 2. * self.a10 * r.a5 * r.a10 - 2. * self.a10 * r.a6 * r.a9 - 2. * self.a10 * r.a7 * r.a8,
            a6: -2. * self.a5 * r.a0 * r.a8 + 2. * self.a5 * r.a9 * r.a10 + self.a6 * r.a0.powi(2) - self.a6 * r.a8.powi(2) + self.a6 * r.a9.powi(2) - self.a6 * r.a10.powi(2) + 2. * self.a7 * r.a0 * r.a10 + 2. * self.a7 * r.a8 * r.a9 + 2. * self.a8 * r.a0 * r.a5 + 2. * self.a8 * r.a6 * r.a8 + 2. * self.a8 * r.a7 * r.a9 - 2. * self.a9 * r.a5 * r.a10 + 2. * self.a9 * r.a6 * r.a9 - 2. * self.a9 * r.a7 * r.a8 - 2. * self.a10 * r.a0 * r.a7 + 2. * self.a10 * r.a5 * r.a9 + 2. * self.a10 * r.a6 * r.a10,
            a7: 2. * self.a5 * r.a0 * r.a9 + 2. * self.a5 * r.a8 * r.a10 - 2. * self.a6 * r.a0 * r.a10 + 2. * self.a6 * r.a8 * r.a9 + self.a7 * r.a0.powi(2) + self.a7 * r.a8.powi(2) - self.a7 * r.a9.powi(2) - self.a7 * r.a10.powi(2) - 2. * self.a8 * r.a5 * r.a10 - 2. * self.a8 * r.a6 * r.a9 + 2. * self.a8 * r.a7 * r.a8 - 2. * self.a9 * r.a0 * r.a5 + 2. * self.a9 * r.a6 * r.a8 + 2. * self.a9 * r.a7 * r.a9 + 2. * self.a10 * r.a0 * r.a6 + 2. * self.a10 * r.a5 * r.a8 + 2. * self.a10 * r.a7 * r.a10,
            a8: r.a0 * (self.a8 * r.a0 - self.a9 * r.a10 + self.a10 * r.a9) + r.a8 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + r.a9 * (-self.a8 * r.a9 + self.a9 * r.a8 + self.a10 * r.a0) - r.a10 * (self.a8 * r.a10 + self.a9 * r.a0 - self.a10 * r.a8),
            a9: r.a0 * (self.a8 * r.a10 + self.a9 * r.a0 - self.a10 * r.a8) - r.a8 * (-self.a8 * r.a9 + self.a9 * r.a8 + self.a10 * r.a0) + r.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + r.a10 * (self.a8 * r.a0 - self.a9 * r.a10 + self.a10 * r.a9),
            a10: r.a0 * (-self.a8 * r.a9 + self.a9 * r.a8 + self.a10 * r.a0) + r.a8 * (self.a8 * r.a10 + self.a9 * r.a0 - self.a10 * r.a8) - r.a9 * (self.a8 * r.a0 - self.a9 * r.a10 + self.a10 * r.a9) + r.a10 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
        }
    }
}

// ===========================================================================
// Trivector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct Trivector {
    a11: Float,
    a12: Float,
    a13: Float,
    a14: Float,
}

impl Reverse for Trivector {
    fn reverse(self) -> Trivector {
        Trivector {
            a11: -self.a11,
            a12: -self.a12,
            a13: -self.a13,
            a14: -self.a14,
        }
    }
}

impl Dual for Trivector {
    type Output = Vector;

    fn dual(self) -> Vector {
        Vector {
            a1: self.a14,
            a2: self.a13,
            a3: self.a12,
            a4: self.a11,
        }
    }
}

impl Conjugate for Trivector {
    fn conjugate(self) -> Trivector {
        Trivector {
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
        }
    }
}

impl Normalize for Trivector {
    fn norm(self) -> Float {
        self.a14.abs()
    }
}

impl NormalizeInfinite for Trivector {
    fn inorm(self) -> Float {
        (self.a11.powi(2) + self.a12.powi(2) + self.a13.powi(2)).sqrt()
    }
}

impl Trivector {
    pub fn new(a11: Float, a12: Float, a13: Float, a14: Float) -> Trivector {
        Trivector {a11, a12, a13, a14}
    }

    pub fn zero() -> Trivector {
        Default::default()
    }

    pub fn as_tuple(&self) -> (Float, Float, Float, Float) {
        (self.a11, self.a12, self.a13, self.a14)
    }

    pub fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Neg for Trivector {
    type Output = Trivector;

    fn neg(self) -> Trivector {
        Trivector {
            a11: -self.a11,
            a12: -self.a12,
            a13: -self.a13,
            a14: -self.a14,
        }
    }
}

impl Add<Float> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Add<Vector> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Add<Bivector> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Add<Trivector> for Trivector {
    type Output = Trivector;

    fn add(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a11 + r.a11,
            a12: self.a12 + r.a12,
            a13: self.a13 + r.a13,
            a14: self.a14 + r.a14,
        }
    }
}

impl Add<Pseudoscalar> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: r.a15,
        }
    }
}

impl Add<ScalarAndBivector> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Add<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: self.a11 + r.a11,
            a12: self.a12 + r.a12,
            a13: self.a13 + r.a13,
            a14: self.a14 + r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Float> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: -r,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Sub<Vector> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Sub<Bivector> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Sub<Trivector> for Trivector {
    type Output = Trivector;

    fn sub(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a11 - r.a11,
            a12: self.a12 - r.a12,
            a13: self.a13 - r.a13,
            a14: self.a14 - r.a14,
        }
    }
}

impl Sub<Pseudoscalar> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: -r.a15,
        }
    }
}

impl Sub<ScalarAndBivector> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Sub<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: self.a11 - r.a11,
            a12: self.a12 - r.a12,
            a13: self.a13 - r.a13,
            a14: self.a14 - r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Float> for Trivector {
    type Output = Trivector;

    fn mul(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
        }
    }
}

impl Mul<Vector> for Trivector {
    type Output = FullMultivector;

    fn mul(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a11 * r.a2 - self.a13 * r.a4,
            a7: -self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl Mul<Bivector> for Trivector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a11 * r.a10 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: self.a11 * r.a9 - self.a12 * r.a8 + self.a14 * r.a5,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Mul<Trivector> for Trivector {
    type Output = ScalarAndBivector;

    fn mul(self, r: Trivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a14 * r.a14,
            a5: self.a13 * r.a14 - self.a14 * r.a13,
            a6: self.a12 * r.a14 - self.a14 * r.a12,
            a7: self.a11 * r.a14 - self.a14 * r.a11,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Mul<Pseudoscalar> for Trivector {
    type Output = Vector;

    fn mul(self, r: Pseudoscalar) -> Vector {
        Vector {
            a1: self.a14 * r.a15,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }
}

impl Mul<ScalarAndBivector> for Trivector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11 * r.a0 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a11 * r.a10 + self.a12 * r.a0 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: self.a11 * r.a9 - self.a12 * r.a8 + self.a13 * r.a0 + self.a14 * r.a5,
            a14: self.a14 * r.a0,
            a15: 0.,
        }
    }
}

impl Mul<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14 * r.a14,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: -self.a11 * r.a3 + self.a12 * r.a4 + self.a13 * r.a14 - self.a14 * r.a13,
            a6: self.a11 * r.a2 + self.a12 * r.a14 - self.a13 * r.a4 - self.a14 * r.a12,
            a7: self.a11 * r.a14 - self.a12 * r.a2 + self.a13 * r.a3 - self.a14 * r.a11,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
            a11: self.a11 * r.a0 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a11 * r.a10 + self.a12 * r.a0 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: self.a11 * r.a9 - self.a12 * r.a8 + self.a13 * r.a0 + self.a14 * r.a5,
            a14: self.a14 * r.a0,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl BitXor<Float> for Trivector {
    type Output = Trivector;

    fn bitxor(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
        }
    }
}

impl BitXor<Vector> for Trivector {
    type Output = Pseudoscalar;

    fn bitxor(self, r: Vector) -> Pseudoscalar {
        Pseudoscalar {
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl BitXor<Bivector> for Trivector {
    type Output = Float;

    fn bitxor(self, _r: Bivector) -> Float {
        0.
    }
}

impl BitXor<Trivector> for Trivector {
    type Output = Float;

    fn bitxor(self, _r: Trivector) -> Float {
        0.
    }
}

impl BitXor<Pseudoscalar> for Trivector {
    type Output = Float;

    fn bitxor(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

impl BitXor<ScalarAndBivector> for Trivector {
    type Output = Trivector;

    fn bitxor(self, r: ScalarAndBivector) -> Trivector {
        Trivector {
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
        }
    }
}

impl BitXor<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl BitAnd<Float> for Trivector {
    type Output = Float;

    fn bitand(self, _r: Float) -> Float {
        0.
    }
}

impl BitAnd<Vector> for Trivector {
    type Output = Float;

    fn bitand(self, r: Vector) -> Float {
        self.a11 * r.a4 + self.a12 * r.a3 + self.a13 * r.a2 + self.a14 * r.a1
    }
}

impl BitAnd<Bivector> for Trivector {
    type Output = Vector;

    fn bitand(self, r: Bivector) -> Vector {
        Vector {
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
        }
    }
}

impl BitAnd<Trivector> for Trivector {
    type Output = Bivector;

    fn bitand(self, r: Trivector) -> Bivector {
        Bivector {
            a5: -self.a11 * r.a12 + self.a12 * r.a11,
            a6: self.a11 * r.a13 - self.a13 * r.a11,
            a7: -self.a12 * r.a13 + self.a13 * r.a12,
            a8: -self.a11 * r.a14 + self.a14 * r.a11,
            a9: -self.a12 * r.a14 + self.a14 * r.a12,
            a10: -self.a13 * r.a14 + self.a14 * r.a13,
        }
    }
}

impl BitAnd<Pseudoscalar> for Trivector {
    type Output = Trivector;

    fn bitand(self, r: Pseudoscalar) -> Trivector {
        Trivector {
            a11: self.a11 * r.a15,
            a12: self.a12 * r.a15,
            a13: self.a13 * r.a15,
            a14: self.a14 * r.a15,
        }
    }
}

impl BitAnd<ScalarAndBivector> for Trivector {
    type Output = Vector;

    fn bitand(self, r: ScalarAndBivector) -> Vector {
        Vector {
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
        }
    }
}

impl BitAnd<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a11 * r.a4 + self.a12 * r.a3 + self.a13 * r.a2 + self.a14 * r.a1,
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
            a5: -self.a11 * r.a12 + self.a12 * r.a11,
            a6: self.a11 * r.a13 - self.a13 * r.a11,
            a7: -self.a12 * r.a13 + self.a13 * r.a12,
            a8: -self.a11 * r.a14 + self.a14 * r.a11,
            a9: -self.a12 * r.a14 + self.a14 * r.a12,
            a10: -self.a13 * r.a14 + self.a14 * r.a13,
            a11: self.a11 * r.a15,
            a12: self.a12 * r.a15,
            a13: self.a13 * r.a15,
            a14: self.a14 * r.a15,
            a15: 0.,
        }
    }
}

impl BitOr<Float> for Trivector {
    type Output = Trivector;

    fn bitor(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
        }
    }
}

impl BitOr<Vector> for Trivector {
    type Output = Bivector;

    fn bitor(self, r: Vector) -> Bivector {
        Bivector {
            a5: -self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a11 * r.a2 - self.a13 * r.a4,
            a7: -self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
        }
    }
}

impl BitOr<Bivector> for Trivector {
    type Output = Vector;

    fn bitor(self, r: Bivector) -> Vector {
        Vector {
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
        }
    }
}

impl BitOr<Trivector> for Trivector {
    type Output = Float;

    fn bitor(self, r: Trivector) -> Float {
        -self.a14 * r.a14
    }
}

impl BitOr<Pseudoscalar> for Trivector {
    type Output = Vector;

    fn bitor(self, r: Pseudoscalar) -> Vector {
        Vector {
            a1: self.a14 * r.a15,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }
}

impl BitOr<ScalarAndBivector> for Trivector {
    type Output = FullMultivector;

    fn bitor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
            a15: 0.,
        }
    }
}

impl BitOr<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14 * r.a14,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: -self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a11 * r.a2 - self.a13 * r.a4,
            a7: -self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
            a15: 0.,
        }
    }
}

impl Project<Float> for Trivector {
    fn project(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r.powi(2),
            a12: self.a12 * r.powi(2),
            a13: self.a13 * r.powi(2),
            a14: self.a14 * r.powi(2),
        }
    }
}

impl Project<Vector> for Trivector {
    fn project(self, r: Vector) -> Trivector {
        Trivector {
            a11: -self.a14 * r.a1 * r.a4 + r.a2 * (self.a11 * r.a2 - self.a13 * r.a4) + r.a3 * (self.a11 * r.a3 - self.a12 * r.a4),
            a12: -self.a14 * r.a1 * r.a3 + r.a2 * (self.a12 * r.a2 - self.a13 * r.a3) - r.a4 * (self.a11 * r.a3 - self.a12 * r.a4),
            a13: -self.a14 * r.a1 * r.a2 - r.a3 * (self.a12 * r.a2 - self.a13 * r.a3) - r.a4 * (self.a11 * r.a2 - self.a13 * r.a4),
            a14: self.a14 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
        }
    }
}

impl Project<Trivector> for Trivector {
    fn project(self, r: Trivector) -> Trivector {
        Trivector {
            a11: -self.a14 * r.a11 * r.a14,
            a12: -self.a14 * r.a12 * r.a14,
            a13: -self.a14 * r.a13 * r.a14,
            a14: -self.a14 * r.a14.powi(2),
        }
    }
}

impl Project<Pseudoscalar> for Trivector {
    fn project(self, _r: Pseudoscalar) -> Trivector {
        Trivector {
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
        }
    }
}

impl Reflect<Float> for Trivector {
    fn reflect(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r.powi(2),
            a12: self.a12 * r.powi(2),
            a13: self.a13 * r.powi(2),
            a14: self.a14 * r.powi(2),
        }
    }
}

impl Reflect<Vector> for Trivector {
    fn reflect(self, r: Vector) -> Trivector {
        Trivector {
            a11: self.a11 * r.a2.powi(2) + self.a11 * r.a3.powi(2) - self.a11 * r.a4.powi(2) - 2. * self.a12 * r.a3 * r.a4 - 2. * self.a13 * r.a2 * r.a4 - 2. * self.a14 * r.a1 * r.a4,
            a12: -2. * self.a11 * r.a3 * r.a4 + self.a12 * r.a2.powi(2) - self.a12 * r.a3.powi(2) + self.a12 * r.a4.powi(2) - 2. * self.a13 * r.a2 * r.a3 - 2. * self.a14 * r.a1 * r.a3,
            a13: -2. * self.a11 * r.a2 * r.a4 - 2. * self.a12 * r.a2 * r.a3 - self.a13 * r.a2.powi(2) + self.a13 * r.a3.powi(2) + self.a13 * r.a4.powi(2) - 2. * self.a14 * r.a1 * r.a2,
            a14: self.a14 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
        }
    }
}

impl Reflect<Bivector> for Trivector {
    fn reflect(self, r: Bivector) -> Trivector {
        Trivector {
            a11: -self.a11 * r.a8.powi(2) + self.a11 * r.a9.powi(2) + self.a11 * r.a10.powi(2) - 2. * self.a12 * r.a8 * r.a9 - 2. * self.a13 * r.a8 * r.a10 + 2. * self.a14 * r.a5 * r.a9 - 2. * self.a14 * r.a6 * r.a10,
            a12: -2. * self.a11 * r.a8 * r.a9 + self.a12 * r.a8.powi(2) - self.a12 * r.a9.powi(2) + self.a12 * r.a10.powi(2) - 2. * self.a13 * r.a9 * r.a10 - 2. * self.a14 * r.a5 * r.a8 + 2. * self.a14 * r.a7 * r.a10,
            a13: -2. * self.a11 * r.a8 * r.a10 - 2. * self.a12 * r.a9 * r.a10 + self.a13 * r.a8.powi(2) + self.a13 * r.a9.powi(2) - self.a13 * r.a10.powi(2) + 2. * self.a14 * r.a6 * r.a8 - 2. * self.a14 * r.a7 * r.a9,
            a14: self.a14 * (-r.a8.powi(2) - r.a9.powi(2) - r.a10.powi(2)),
        }
    }
}

impl Reflect<Trivector> for Trivector {
    fn reflect(self, r: Trivector) -> Trivector {
        Trivector {
            a11: r.a14 * (self.a11 * r.a14 - 2. * self.a14 * r.a11),
            a12: r.a14 * (self.a12 * r.a14 - 2. * self.a14 * r.a12),
            a13: r.a14 * (self.a13 * r.a14 - 2. * self.a14 * r.a13),
            a14: -self.a14 * r.a14.powi(2),
        }
    }
}

impl Reflect<Pseudoscalar> for Trivector {
    fn reflect(self, _r: Pseudoscalar) -> Trivector {
        Trivector {
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
        }
    }
}

impl Transform<Float> for Trivector {
    fn transform(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r.powi(2),
            a12: self.a12 * r.powi(2),
            a13: self.a13 * r.powi(2),
            a14: self.a14 * r.powi(2),
        }
    }
}

impl Transform<Vector> for Trivector {
    fn transform(self, r: Vector) -> Trivector {
        Trivector {
            a11: self.a11 * r.a2.powi(2) + self.a11 * r.a3.powi(2) - self.a11 * r.a4.powi(2) - 2. * self.a12 * r.a3 * r.a4 - 2. * self.a13 * r.a2 * r.a4 - 2. * self.a14 * r.a1 * r.a4,
            a12: -2. * self.a11 * r.a3 * r.a4 + self.a12 * r.a2.powi(2) - self.a12 * r.a3.powi(2) + self.a12 * r.a4.powi(2) - 2. * self.a13 * r.a2 * r.a3 - 2. * self.a14 * r.a1 * r.a3,
            a13: -2. * self.a11 * r.a2 * r.a4 - 2. * self.a12 * r.a2 * r.a3 - self.a13 * r.a2.powi(2) + self.a13 * r.a3.powi(2) + self.a13 * r.a4.powi(2) - 2. * self.a14 * r.a1 * r.a2,
            a14: self.a14 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
        }
    }
}

impl Transform<Bivector> for Trivector {
    fn transform(self, r: Bivector) -> Trivector {
        Trivector {
            a11: self.a11 * r.a8.powi(2) - self.a11 * r.a9.powi(2) - self.a11 * r.a10.powi(2) + 2. * self.a12 * r.a8 * r.a9 + 2. * self.a13 * r.a8 * r.a10 - 2. * self.a14 * r.a5 * r.a9 + 2. * self.a14 * r.a6 * r.a10,
            a12: 2. * self.a11 * r.a8 * r.a9 - self.a12 * r.a8.powi(2) + self.a12 * r.a9.powi(2) - self.a12 * r.a10.powi(2) + 2. * self.a13 * r.a9 * r.a10 + 2. * self.a14 * r.a5 * r.a8 - 2. * self.a14 * r.a7 * r.a10,
            a13: 2. * self.a11 * r.a8 * r.a10 + 2. * self.a12 * r.a9 * r.a10 - self.a13 * r.a8.powi(2) - self.a13 * r.a9.powi(2) + self.a13 * r.a10.powi(2) - 2. * self.a14 * r.a6 * r.a8 + 2. * self.a14 * r.a7 * r.a9,
            a14: self.a14 * (r.a8.powi(2) + r.a9.powi(2) + r.a10.powi(2)),
        }
    }
}

impl Transform<Trivector> for Trivector {
    fn transform(self, r: Trivector) -> Trivector {
        Trivector {
            a11: r.a14 * (-self.a11 * r.a14 + 2. * self.a14 * r.a11),
            a12: r.a14 * (-self.a12 * r.a14 + 2. * self.a14 * r.a12),
            a13: r.a14 * (-self.a13 * r.a14 + 2. * self.a14 * r.a13),
            a14: self.a14 * r.a14.powi(2),
        }
    }
}

impl Transform<Pseudoscalar> for Trivector {
    fn transform(self, _r: Pseudoscalar) -> Trivector {
        Trivector {
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
        }
    }
}

impl Transform<ScalarAndBivector> for Trivector {
    fn transform(self, r: ScalarAndBivector) -> Trivector {
        Trivector {
            a11: self.a11 * r.a0.powi(2) + self.a11 * r.a8.powi(2) - self.a11 * r.a9.powi(2) - self.a11 * r.a10.powi(2) - 2. * self.a12 * r.a0 * r.a10 + 2. * self.a12 * r.a8 * r.a9 + 2. * self.a13 * r.a0 * r.a9 + 2. * self.a13 * r.a8 * r.a10 - 2. * self.a14 * r.a0 * r.a7 - 2. * self.a14 * r.a5 * r.a9 + 2. * self.a14 * r.a6 * r.a10,
            a12: 2. * self.a11 * r.a0 * r.a10 + 2. * self.a11 * r.a8 * r.a9 + self.a12 * r.a0.powi(2) - self.a12 * r.a8.powi(2) + self.a12 * r.a9.powi(2) - self.a12 * r.a10.powi(2) - 2. * self.a13 * r.a0 * r.a8 + 2. * self.a13 * r.a9 * r.a10 - 2. * self.a14 * r.a0 * r.a6 + 2. * self.a14 * r.a5 * r.a8 - 2. * self.a14 * r.a7 * r.a10,
            a13: -2. * self.a11 * r.a0 * r.a9 + 2. * self.a11 * r.a8 * r.a10 + 2. * self.a12 * r.a0 * r.a8 + 2. * self.a12 * r.a9 * r.a10 + self.a13 * r.a0.powi(2) - self.a13 * r.a8.powi(2) - self.a13 * r.a9.powi(2) + self.a13 * r.a10.powi(2) - 2. * self.a14 * r.a0 * r.a5 - 2. * self.a14 * r.a6 * r.a8 + 2. * self.a14 * r.a7 * r.a9,
            a14: self.a14 * (r.a0.powi(2) + r.a8.powi(2) + r.a9.powi(2) + r.a10.powi(2)),
        }
    }
}

// ===========================================================================
// Pseudoscalar
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct Pseudoscalar {
    a15: Float,
}

impl Reverse for Pseudoscalar {
    fn reverse(self) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15,
        }
    }
}

impl Dual for Pseudoscalar {
    type Output = Float;

    fn dual(self) -> Float {
        self.a15
    }
}

impl Conjugate for Pseudoscalar {
    fn conjugate(self) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15,
        }
    }
}

impl Normalize for Pseudoscalar {
    fn norm(self) -> Float {
        0.
    }
}

impl NormalizeInfinite for Pseudoscalar {
    fn inorm(self) -> Float {
        self.a15.abs()
    }
}

impl Pseudoscalar {
    pub fn new(a15: Float) -> Pseudoscalar {
        Pseudoscalar {a15}
    }

    pub fn zero() -> Pseudoscalar {
        Default::default()
    }

    pub fn as_tuple(&self) -> Float {
        self.a15
    }

    pub fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Neg for Pseudoscalar {
    type Output = Pseudoscalar;

    fn neg(self) -> Pseudoscalar {
        Pseudoscalar {
            a15: -self.a15,
        }
    }
}

impl Add<Float> for Pseudoscalar {
    type Output = FullMultivector;

    fn add(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Add<Vector> for Pseudoscalar {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Add<Bivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn add(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Add<Trivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: self.a15,
        }
    }
}

impl Add<Pseudoscalar> for Pseudoscalar {
    type Output = Pseudoscalar;

    fn add(self, r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 + r.a15,
        }
    }
}

impl Add<ScalarAndBivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn add(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Add<FullMultivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: self.a15 + r.a15,
        }
    }
}

impl Sub<Float> for Pseudoscalar {
    type Output = FullMultivector;

    fn sub(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: -r,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Sub<Vector> for Pseudoscalar {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Sub<Bivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn sub(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Sub<Trivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: self.a15,
        }
    }
}

impl Sub<Pseudoscalar> for Pseudoscalar {
    type Output = Pseudoscalar;

    fn sub(self, r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 - r.a15,
        }
    }
}

impl Sub<ScalarAndBivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn sub(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15,
        }
    }
}

impl Sub<FullMultivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: self.a15 - r.a15,
        }
    }
}

impl Mul<Float> for Pseudoscalar {
    type Output = Pseudoscalar;

    fn mul(self, r: Float) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r,
        }
    }
}

impl Mul<Vector> for Pseudoscalar {
    type Output = Trivector;

    fn mul(self, r: Vector) -> Trivector {
        Trivector {
            a11: -self.a15 * r.a4,
            a12: -self.a15 * r.a3,
            a13: -self.a15 * r.a2,
            a14: 0.,
        }
    }
}

impl Mul<Bivector> for Pseudoscalar {
    type Output = Bivector;

    fn mul(self, r: Bivector) -> Bivector {
        Bivector {
            a5: -self.a15 * r.a10,
            a6: -self.a15 * r.a9,
            a7: -self.a15 * r.a8,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Mul<Trivector> for Pseudoscalar {
    type Output = Vector;

    fn mul(self, r: Trivector) -> Vector {
        Vector {
            a1: -self.a15 * r.a14,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }
}

impl Mul<Pseudoscalar> for Pseudoscalar {
    type Output = Float;

    fn mul(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

impl Mul<ScalarAndBivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a15 * r.a10,
            a6: -self.a15 * r.a9,
            a7: -self.a15 * r.a8,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15 * r.a0,
        }
    }
}

impl Mul<FullMultivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -self.a15 * r.a14,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a15 * r.a10,
            a6: -self.a15 * r.a9,
            a7: -self.a15 * r.a8,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a15 * r.a4,
            a12: -self.a15 * r.a3,
            a13: -self.a15 * r.a2,
            a14: 0.,
            a15: self.a15 * r.a0,
        }
    }
}

impl BitXor<Float> for Pseudoscalar {
    type Output = Pseudoscalar;

    fn bitxor(self, r: Float) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r,
        }
    }
}

impl BitXor<Vector> for Pseudoscalar {
    type Output = Float;

    fn bitxor(self, _r: Vector) -> Float {
        0.
    }
}

impl BitXor<Bivector> for Pseudoscalar {
    type Output = Float;

    fn bitxor(self, _r: Bivector) -> Float {
        0.
    }
}

impl BitXor<Trivector> for Pseudoscalar {
    type Output = Float;

    fn bitxor(self, _r: Trivector) -> Float {
        0.
    }
}

impl BitXor<Pseudoscalar> for Pseudoscalar {
    type Output = Float;

    fn bitxor(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

impl BitXor<ScalarAndBivector> for Pseudoscalar {
    type Output = Pseudoscalar;

    fn bitxor(self, r: ScalarAndBivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r.a0,
        }
    }
}

impl BitXor<FullMultivector> for Pseudoscalar {
    type Output = Pseudoscalar;

    fn bitxor(self, r: FullMultivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r.a0,
        }
    }
}

impl BitAnd<Float> for Pseudoscalar {
    type Output = Float;

    fn bitand(self, r: Float) -> Float {
        self.a15 * r
    }
}

impl BitAnd<Vector> for Pseudoscalar {
    type Output = Vector;

    fn bitand(self, r: Vector) -> Vector {
        Vector {
            a1: self.a15 * r.a1,
            a2: self.a15 * r.a2,
            a3: self.a15 * r.a3,
            a4: self.a15 * r.a4,
        }
    }
}

impl BitAnd<Bivector> for Pseudoscalar {
    type Output = Bivector;

    fn bitand(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a15 * r.a5,
            a6: self.a15 * r.a6,
            a7: self.a15 * r.a7,
            a8: self.a15 * r.a8,
            a9: self.a15 * r.a9,
            a10: self.a15 * r.a10,
        }
    }
}

impl BitAnd<Trivector> for Pseudoscalar {
    type Output = Trivector;

    fn bitand(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a15 * r.a11,
            a12: self.a15 * r.a12,
            a13: self.a15 * r.a13,
            a14: self.a15 * r.a14,
        }
    }
}

impl BitAnd<Pseudoscalar> for Pseudoscalar {
    type Output = Pseudoscalar;

    fn bitand(self, r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r.a15,
        }
    }
}

impl BitAnd<ScalarAndBivector> for Pseudoscalar {
    type Output = ScalarAndBivector;

    fn bitand(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a15 * r.a0,
            a5: self.a15 * r.a5,
            a6: self.a15 * r.a6,
            a7: self.a15 * r.a7,
            a8: self.a15 * r.a8,
            a9: self.a15 * r.a9,
            a10: self.a15 * r.a10,
        }
    }
}

impl BitAnd<FullMultivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a15 * r.a0,
            a1: self.a15 * r.a1,
            a2: self.a15 * r.a2,
            a3: self.a15 * r.a3,
            a4: self.a15 * r.a4,
            a5: self.a15 * r.a5,
            a6: self.a15 * r.a6,
            a7: self.a15 * r.a7,
            a8: self.a15 * r.a8,
            a9: self.a15 * r.a9,
            a10: self.a15 * r.a10,
            a11: self.a15 * r.a11,
            a12: self.a15 * r.a12,
            a13: self.a15 * r.a13,
            a14: self.a15 * r.a14,
            a15: self.a15 * r.a15,
        }
    }
}

impl BitOr<Float> for Pseudoscalar {
    type Output = Pseudoscalar;

    fn bitor(self, r: Float) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r,
        }
    }
}

impl BitOr<Vector> for Pseudoscalar {
    type Output = Trivector;

    fn bitor(self, r: Vector) -> Trivector {
        Trivector {
            a11: -self.a15 * r.a4,
            a12: -self.a15 * r.a3,
            a13: -self.a15 * r.a2,
            a14: 0.,
        }
    }
}

impl BitOr<Bivector> for Pseudoscalar {
    type Output = Bivector;

    fn bitor(self, r: Bivector) -> Bivector {
        Bivector {
            a5: -self.a15 * r.a10,
            a6: -self.a15 * r.a9,
            a7: -self.a15 * r.a8,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl BitOr<Trivector> for Pseudoscalar {
    type Output = Vector;

    fn bitor(self, r: Trivector) -> Vector {
        Vector {
            a1: -self.a15 * r.a14,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }
}

impl BitOr<Pseudoscalar> for Pseudoscalar {
    type Output = Float;

    fn bitor(self, _r: Pseudoscalar) -> Float {
        0.
    }
}

impl BitOr<ScalarAndBivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn bitor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a15 * r.a10,
            a6: -self.a15 * r.a9,
            a7: -self.a15 * r.a8,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a15 * r.a0,
        }
    }
}

impl BitOr<FullMultivector> for Pseudoscalar {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -self.a15 * r.a14,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a15 * r.a10,
            a6: -self.a15 * r.a9,
            a7: -self.a15 * r.a8,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a15 * r.a4,
            a12: -self.a15 * r.a3,
            a13: -self.a15 * r.a2,
            a14: 0.,
            a15: self.a15 * r.a0,
        }
    }
}

impl Project<Float> for Pseudoscalar {
    fn project(self, r: Float) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r.powi(2),
        }
    }
}

impl Project<Vector> for Pseudoscalar {
    fn project(self, r: Vector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
        }
    }
}

impl Project<Bivector> for Pseudoscalar {
    fn project(self, r: Bivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * (-r.a8.powi(2) - r.a9.powi(2) - r.a10.powi(2)),
        }
    }
}

impl Project<Trivector> for Pseudoscalar {
    fn project(self, r: Trivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: -self.a15 * r.a14.powi(2),
        }
    }
}

impl Project<Pseudoscalar> for Pseudoscalar {
    fn project(self, _r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: 0.,
        }
    }
}

impl Reflect<Float> for Pseudoscalar {
    fn reflect(self, r: Float) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r.powi(2),
        }
    }
}

impl Reflect<Vector> for Pseudoscalar {
    fn reflect(self, r: Vector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * (-r.a2.powi(2) - r.a3.powi(2) - r.a4.powi(2)),
        }
    }
}

impl Reflect<Bivector> for Pseudoscalar {
    fn reflect(self, r: Bivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * (-r.a8.powi(2) - r.a9.powi(2) - r.a10.powi(2)),
        }
    }
}

impl Reflect<Trivector> for Pseudoscalar {
    fn reflect(self, r: Trivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r.a14.powi(2),
        }
    }
}

impl Reflect<Pseudoscalar> for Pseudoscalar {
    fn reflect(self, _r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: 0.,
        }
    }
}

impl Transform<Float> for Pseudoscalar {
    fn transform(self, r: Float) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * r.powi(2),
        }
    }
}

impl Transform<Vector> for Pseudoscalar {
    fn transform(self, r: Vector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * (-r.a2.powi(2) - r.a3.powi(2) - r.a4.powi(2)),
        }
    }
}

impl Transform<Bivector> for Pseudoscalar {
    fn transform(self, r: Bivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * (r.a8.powi(2) + r.a9.powi(2) + r.a10.powi(2)),
        }
    }
}

impl Transform<Trivector> for Pseudoscalar {
    fn transform(self, r: Trivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: -self.a15 * r.a14.powi(2),
        }
    }
}

impl Transform<Pseudoscalar> for Pseudoscalar {
    fn transform(self, _r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: 0.,
        }
    }
}

impl Transform<ScalarAndBivector> for Pseudoscalar {
    fn transform(self, r: ScalarAndBivector) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a15 * (r.a0.powi(2) + r.a8.powi(2) + r.a9.powi(2) + r.a10.powi(2)),
        }
    }
}

// ===========================================================================
// ScalarAndBivector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct ScalarAndBivector {
    a0: Float,
    a5: Float,
    a6: Float,
    a7: Float,
    a8: Float,
    a9: Float,
    a10: Float,
}

impl Reverse for ScalarAndBivector {
    fn reverse(self) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }
}

impl Dual for ScalarAndBivector {
    type Output = FullMultivector;

    fn dual(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a10,
            a6: self.a9,
            a7: self.a8,
            a8: self.a7,
            a9: self.a6,
            a10: self.a5,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a0,
        }
    }
}

impl Conjugate for ScalarAndBivector {
    fn conjugate(self) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }
}

impl Normalize for ScalarAndBivector {
    fn norm(self) -> Float {
        (self.a0.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)).sqrt()
    }
}

impl NormalizeInfinite for ScalarAndBivector {
    fn inorm(self) -> Float {
        (self.a5.powi(2) + self.a6.powi(2) + self.a7.powi(2)).sqrt()
    }
}

impl ScalarAndBivector {
    pub fn new(a0: Float, a5: Float, a6: Float, a7: Float, a8: Float, a9: Float, a10: Float) -> ScalarAndBivector {
        ScalarAndBivector {a0, a5, a6, a7, a8, a9, a10}
    }

    pub fn zero() -> ScalarAndBivector {
        Default::default()
    }

    pub fn as_tuple(&self) -> (Float, Float, Float, Float, Float, Float, Float) {
        (self.a0, self.a5, self.a6, self.a7, self.a8, self.a9, self.a10)
    }

    pub fn scalar(self) -> Float {
        self.a0
    }

    pub fn bivector(self) -> Bivector {
        Bivector {
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }

    pub fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Neg for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn neg(self) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a0,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }
}

impl Add<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn add(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 + r,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }
}

impl Add<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Bivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn add(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
        }
    }
}

impl Add<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: 0.,
        }
    }
}

impl Add<Pseudoscalar> for ScalarAndBivector {
    type Output = FullMultivector;

    fn add(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: r.a15,
        }
    }
}

impl Add<ScalarAndBivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn add(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 + r.a0,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
        }
    }
}

impl Add<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 + r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 - r,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }
}

impl Sub<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Bivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
        }
    }
}

impl Sub<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: 0.,
        }
    }
}

impl Sub<Pseudoscalar> for ScalarAndBivector {
    type Output = FullMultivector;

    fn sub(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -r.a15,
        }
    }
}

impl Sub<ScalarAndBivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 - r.a0,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
        }
    }
}

impl Sub<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 - r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn mul(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl Mul<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4,
            a3: self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: 0.,
        }
    }
}

impl Mul<Bivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7,
            a6: self.a0 * r.a6 + self.a5 * r.a8 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a0 * r.a11 - self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: self.a0 * r.a12 - self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a13: self.a0 * r.a13 - self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a14: self.a0 * r.a14,
            a15: 0.,
        }
    }
}

impl Mul<Pseudoscalar> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a10 * r.a15,
            a6: -self.a9 * r.a15,
            a7: -self.a8 * r.a15,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a0 * r.a15,
        }
    }
}

impl Mul<ScalarAndBivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7,
            a6: self.a0 * r.a6 + self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a0 * r.a8 + self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14,
            a3: self.a0 * r.a3 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4,
            a4: self.a0 * r.a4 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a10 * r.a15,
            a6: self.a0 * r.a6 + self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 - self.a9 * r.a15 + self.a10 * r.a7,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 - self.a8 * r.a15 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a0 * r.a8 + self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: self.a0 * r.a11 - self.a5 * r.a3 + self.a6 * r.a2 - self.a7 * r.a14 - self.a8 * r.a1 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: self.a0 * r.a12 + self.a5 * r.a4 - self.a6 * r.a14 - self.a7 * r.a2 - self.a8 * r.a13 - self.a9 * r.a1 + self.a10 * r.a11,
            a13: self.a0 * r.a13 - self.a5 * r.a14 - self.a6 * r.a4 + self.a7 * r.a3 + self.a8 * r.a12 - self.a9 * r.a11 - self.a10 * r.a1,
            a14: self.a0 * r.a14 + self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: self.a0 * r.a15 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitxor(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl BitXor<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a0 * r.a1,
            a2: self.a0 * r.a2,
            a3: self.a0 * r.a3,
            a4: self.a0 * r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: 0.,
        }
    }
}

impl BitXor<Bivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5,
            a6: self.a0 * r.a6,
            a7: self.a0 * r.a7,
            a8: self.a0 * r.a8,
            a9: self.a0 * r.a9,
            a10: self.a0 * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Trivector> for ScalarAndBivector {
    type Output = Trivector;

    fn bitxor(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
        }
    }
}

impl BitXor<Pseudoscalar> for ScalarAndBivector {
    type Output = Pseudoscalar;

    fn bitxor(self, r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a0 * r.a15,
        }
    }
}

impl BitXor<ScalarAndBivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitxor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0,
            a1: self.a0 * r.a1,
            a2: self.a0 * r.a2,
            a3: self.a0 * r.a3,
            a4: self.a0 * r.a4,
            a5: self.a0 * r.a5 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: self.a0 * r.a11 - self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a0 * r.a12 + self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: self.a0 * r.a13 - self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a0 * r.a14 + self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: self.a0 * r.a15 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitAnd<Float> for ScalarAndBivector {
    type Output = Float;

    fn bitand(self, _r: Float) -> Float {
        0.
    }
}

impl BitAnd<Vector> for ScalarAndBivector {
    type Output = Float;

    fn bitand(self, _r: Vector) -> Float {
        0.
    }
}

impl BitAnd<Bivector> for ScalarAndBivector {
    type Output = Float;

    fn bitand(self, r: Bivector) -> Float {
        self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5
    }
}

impl BitAnd<Trivector> for ScalarAndBivector {
    type Output = Vector;

    fn bitand(self, r: Trivector) -> Vector {
        Vector {
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
        }
    }
}

impl BitAnd<Pseudoscalar> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitand(self, r: Pseudoscalar) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r.a15,
            a5: self.a5 * r.a15,
            a6: self.a6 * r.a15,
            a7: self.a7 * r.a15,
            a8: self.a8 * r.a15,
            a9: self.a9 * r.a15,
            a10: self.a10 * r.a15,
        }
    }
}

impl BitAnd<ScalarAndBivector> for ScalarAndBivector {
    type Output = Float;

    fn bitand(self, r: ScalarAndBivector) -> Float {
        self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5
    }
}

impl BitAnd<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a15 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a5: self.a5 * r.a15,
            a6: self.a6 * r.a15,
            a7: self.a7 * r.a15,
            a8: self.a8 * r.a15,
            a9: self.a9 * r.a15,
            a10: self.a10 * r.a15,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitor(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl BitOr<Vector> for ScalarAndBivector {
    type Output = Vector;

    fn bitor(self, r: Vector) -> Vector {
        Vector {
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4,
            a3: self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3,
        }
    }
}

impl BitOr<Bivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitor(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a5: self.a0 * r.a5,
            a6: self.a0 * r.a6,
            a7: self.a0 * r.a7,
            a8: self.a0 * r.a8,
            a9: self.a0 * r.a9,
            a10: self.a0 * r.a10,
        }
    }
}

impl BitOr<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitor(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
            a15: 0.,
        }
    }
}

impl BitOr<Pseudoscalar> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitor(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a10 * r.a15,
            a6: -self.a9 * r.a15,
            a7: -self.a8 * r.a15,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a0 * r.a15,
        }
    }
}

impl BitOr<ScalarAndBivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitor(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a5: self.a0 * r.a5 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
        }
    }
}

impl BitOr<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14,
            a3: self.a0 * r.a3 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4,
            a4: self.a0 * r.a4 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a10 * r.a15,
            a6: self.a0 * r.a6 + self.a6 * r.a0 - self.a9 * r.a15,
            a7: self.a0 * r.a7 + self.a7 * r.a0 - self.a8 * r.a15,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
            a15: self.a0 * r.a15,
        }
    }
}

impl Project<Float> for ScalarAndBivector {
    fn project(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r.powi(2),
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
        }
    }
}

impl Project<Vector> for ScalarAndBivector {
    fn project(self, r: Vector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a5: self.a5 * r.a2.powi(2) + self.a6 * r.a2 * r.a3 + self.a7 * r.a2 * r.a4 - self.a8 * r.a1 * r.a3 + self.a9 * r.a1 * r.a4,
            a6: self.a5 * r.a2 * r.a3 + self.a6 * r.a3.powi(2) + self.a7 * r.a3 * r.a4 + self.a8 * r.a1 * r.a2 - self.a10 * r.a1 * r.a4,
            a7: self.a5 * r.a2 * r.a4 + self.a6 * r.a3 * r.a4 + self.a7 * r.a4.powi(2) - self.a9 * r.a1 * r.a2 + self.a10 * r.a1 * r.a3,
            a8: self.a8 * r.a2.powi(2) + self.a8 * r.a3.powi(2) - self.a9 * r.a3 * r.a4 - self.a10 * r.a2 * r.a4,
            a9: -self.a8 * r.a3 * r.a4 + self.a9 * r.a2.powi(2) + self.a9 * r.a4.powi(2) - self.a10 * r.a2 * r.a3,
            a10: -self.a8 * r.a2 * r.a4 - self.a9 * r.a2 * r.a3 + self.a10 * r.a3.powi(2) + self.a10 * r.a4.powi(2),
        }
    }
}

impl Project<Trivector> for ScalarAndBivector {
    fn project(self, r: Trivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a0 * r.a14.powi(2),
            a5: r.a14 * (-self.a8 * r.a12 + self.a9 * r.a11),
            a6: r.a14 * (self.a8 * r.a13 - self.a10 * r.a11),
            a7: r.a14 * (-self.a9 * r.a13 + self.a10 * r.a12),
            a8: -self.a8 * r.a14.powi(2),
            a9: -self.a9 * r.a14.powi(2),
            a10: -self.a10 * r.a14.powi(2),
        }
    }
}

impl Project<Pseudoscalar> for ScalarAndBivector {
    fn project(self, _r: Pseudoscalar) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Reflect<Float> for ScalarAndBivector {
    fn reflect(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r.powi(2),
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
        }
    }
}

impl Reflect<Vector> for ScalarAndBivector {
    fn reflect(self, r: Vector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a5: -self.a5 * r.a2.powi(2) + self.a5 * r.a3.powi(2) + self.a5 * r.a4.powi(2) - 2. * self.a6 * r.a2 * r.a3 - 2. * self.a7 * r.a2 * r.a4 + 2. * self.a8 * r.a1 * r.a3 - 2. * self.a9 * r.a1 * r.a4,
            a6: -2. * self.a5 * r.a2 * r.a3 + self.a6 * r.a2.powi(2) - self.a6 * r.a3.powi(2) + self.a6 * r.a4.powi(2) - 2. * self.a7 * r.a3 * r.a4 - 2. * self.a8 * r.a1 * r.a2 + 2. * self.a10 * r.a1 * r.a4,
            a7: -2. * self.a5 * r.a2 * r.a4 - 2. * self.a6 * r.a3 * r.a4 + self.a7 * r.a2.powi(2) + self.a7 * r.a3.powi(2) - self.a7 * r.a4.powi(2) + 2. * self.a9 * r.a1 * r.a2 - 2. * self.a10 * r.a1 * r.a3,
            a8: -self.a8 * r.a2.powi(2) - self.a8 * r.a3.powi(2) + self.a8 * r.a4.powi(2) + 2. * self.a9 * r.a3 * r.a4 + 2. * self.a10 * r.a2 * r.a4,
            a9: 2. * self.a8 * r.a3 * r.a4 - self.a9 * r.a2.powi(2) + self.a9 * r.a3.powi(2) - self.a9 * r.a4.powi(2) + 2. * self.a10 * r.a2 * r.a3,
            a10: 2. * self.a8 * r.a2 * r.a4 + 2. * self.a9 * r.a2 * r.a3 + self.a10 * r.a2.powi(2) - self.a10 * r.a3.powi(2) - self.a10 * r.a4.powi(2),
        }
    }
}

impl Reflect<Trivector> for ScalarAndBivector {
    fn reflect(self, r: Trivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a0 * r.a14.powi(2),
            a5: r.a14 * (self.a5 * r.a14 - 2. * self.a8 * r.a12 + 2. * self.a9 * r.a11),
            a6: r.a14 * (self.a6 * r.a14 + 2. * self.a8 * r.a13 - 2. * self.a10 * r.a11),
            a7: r.a14 * (self.a7 * r.a14 - 2. * self.a9 * r.a13 + 2. * self.a10 * r.a12),
            a8: -self.a8 * r.a14.powi(2),
            a9: -self.a9 * r.a14.powi(2),
            a10: -self.a10 * r.a14.powi(2),
        }
    }
}

impl Reflect<Pseudoscalar> for ScalarAndBivector {
    fn reflect(self, _r: Pseudoscalar) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Transform<Float> for ScalarAndBivector {
    fn transform(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r.powi(2),
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
        }
    }
}

impl Transform<Vector> for ScalarAndBivector {
    fn transform(self, r: Vector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a5: -self.a5 * r.a2.powi(2) + self.a5 * r.a3.powi(2) + self.a5 * r.a4.powi(2) - 2. * self.a6 * r.a2 * r.a3 - 2. * self.a7 * r.a2 * r.a4 + 2. * self.a8 * r.a1 * r.a3 - 2. * self.a9 * r.a1 * r.a4,
            a6: -2. * self.a5 * r.a2 * r.a3 + self.a6 * r.a2.powi(2) - self.a6 * r.a3.powi(2) + self.a6 * r.a4.powi(2) - 2. * self.a7 * r.a3 * r.a4 - 2. * self.a8 * r.a1 * r.a2 + 2. * self.a10 * r.a1 * r.a4,
            a7: -2. * self.a5 * r.a2 * r.a4 - 2. * self.a6 * r.a3 * r.a4 + self.a7 * r.a2.powi(2) + self.a7 * r.a3.powi(2) - self.a7 * r.a4.powi(2) + 2. * self.a9 * r.a1 * r.a2 - 2. * self.a10 * r.a1 * r.a3,
            a8: -self.a8 * r.a2.powi(2) - self.a8 * r.a3.powi(2) + self.a8 * r.a4.powi(2) + 2. * self.a9 * r.a3 * r.a4 + 2. * self.a10 * r.a2 * r.a4,
            a9: 2. * self.a8 * r.a3 * r.a4 - self.a9 * r.a2.powi(2) + self.a9 * r.a3.powi(2) - self.a9 * r.a4.powi(2) + 2. * self.a10 * r.a2 * r.a3,
            a10: 2. * self.a8 * r.a2 * r.a4 + 2. * self.a9 * r.a2 * r.a3 + self.a10 * r.a2.powi(2) - self.a10 * r.a3.powi(2) - self.a10 * r.a4.powi(2),
        }
    }
}

impl Transform<Trivector> for ScalarAndBivector {
    fn transform(self, r: Trivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r.a14.powi(2),
            a5: r.a14 * (-self.a5 * r.a14 + 2. * self.a8 * r.a12 - 2. * self.a9 * r.a11),
            a6: r.a14 * (-self.a6 * r.a14 - 2. * self.a8 * r.a13 + 2. * self.a10 * r.a11),
            a7: r.a14 * (-self.a7 * r.a14 + 2. * self.a9 * r.a13 - 2. * self.a10 * r.a12),
            a8: self.a8 * r.a14.powi(2),
            a9: self.a9 * r.a14.powi(2),
            a10: self.a10 * r.a14.powi(2),
        }
    }
}

impl Transform<Pseudoscalar> for ScalarAndBivector {
    fn transform(self, _r: Pseudoscalar) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

// ===========================================================================
// FullMultivector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct FullMultivector {
    a0: Float,
    a1: Float,
    a2: Float,
    a3: Float,
    a4: Float,
    a5: Float,
    a6: Float,
    a7: Float,
    a8: Float,
    a9: Float,
    a10: Float,
    a11: Float,
    a12: Float,
    a13: Float,
    a14: Float,
    a15: Float,
}

impl Reverse for FullMultivector {
    fn reverse(self) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
            a11: -self.a11,
            a12: -self.a12,
            a13: -self.a13,
            a14: -self.a14,
            a15: self.a15,
        }
    }
}

impl Dual for FullMultivector {
    type Output = FullMultivector;

    fn dual(self) -> FullMultivector {
        FullMultivector {
            a0: self.a15,
            a1: self.a14,
            a2: self.a13,
            a3: self.a12,
            a4: self.a11,
            a5: self.a10,
            a6: self.a9,
            a7: self.a8,
            a8: self.a7,
            a9: self.a6,
            a10: self.a5,
            a11: self.a4,
            a12: self.a3,
            a13: self.a2,
            a14: self.a1,
            a15: self.a0,
        }
    }
}

impl Conjugate for FullMultivector {
    fn conjugate(self) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: -self.a1,
            a2: -self.a2,
            a3: -self.a3,
            a4: -self.a4,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Normalize for FullMultivector {
    fn norm(self) -> Float {
        (self.a0.powi(2) + self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2) + self.a14.powi(2)).sqrt()
    }
}

impl NormalizeInfinite for FullMultivector {
    fn inorm(self) -> Float {
        (self.a1.powi(2) + self.a5.powi(2) + self.a6.powi(2) + self.a7.powi(2) + self.a11.powi(2) + self.a12.powi(2) + self.a13.powi(2) + self.a15.powi(2)).sqrt()
    }
}

impl FullMultivector {
    pub fn new(a0: Float, a1: Float, a2: Float, a3: Float, a4: Float, a5: Float, a6: Float, a7: Float, a8: Float, a9: Float, a10: Float, a11: Float, a12: Float, a13: Float, a14: Float, a15: Float) -> FullMultivector {
        FullMultivector {a0, a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11, a12, a13, a14, a15}
    }

    pub fn zero() -> FullMultivector {
        Default::default()
    }

    pub fn as_tuple(&self) -> (Float, Float, Float, Float, Float, Float, Float, Float, Float, Float, Float, Float, Float, Float, Float, Float) {
        (self.a0, self.a1, self.a2, self.a3, self.a4, self.a5, self.a6, self.a7, self.a8, self.a9, self.a10, self.a11, self.a12, self.a13, self.a14, self.a15)
    }

    pub fn scalar(self) -> Float {
        self.a0
    }

    pub fn vector(self) -> Vector {
        Vector {
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
        }
    }

    pub fn bivector(self) -> Bivector {
        Bivector {
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }

    pub fn trivector(self) -> Trivector {
        Trivector {
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
        }
    }
}

impl Neg for FullMultivector {
    type Output = FullMultivector;

    fn neg(self) -> FullMultivector {
        FullMultivector {
            a0: -self.a0,
            a1: -self.a1,
            a2: -self.a2,
            a3: -self.a3,
            a4: -self.a4,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
            a11: -self.a11,
            a12: -self.a12,
            a13: -self.a13,
            a14: -self.a14,
            a15: -self.a15,
        }
    }
}

impl Add<Float> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 + r,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Add<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1 + r.a1,
            a2: self.a2 + r.a2,
            a3: self.a3 + r.a3,
            a4: self.a4 + r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Add<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Add<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11 + r.a11,
            a12: self.a12 + r.a12,
            a13: self.a13 + r.a13,
            a14: self.a14 + r.a14,
            a15: self.a15,
        }
    }
}

impl Add<Pseudoscalar> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15 + r.a15,
        }
    }
}

impl Add<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 + r.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Add<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 + r.a0,
            a1: self.a1 + r.a1,
            a2: self.a2 + r.a2,
            a3: self.a3 + r.a3,
            a4: self.a4 + r.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: self.a11 + r.a11,
            a12: self.a12 + r.a12,
            a13: self.a13 + r.a13,
            a14: self.a14 + r.a14,
            a15: self.a15 + r.a15,
        }
    }
}

impl Sub<Float> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 - r,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Sub<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1 - r.a1,
            a2: self.a2 - r.a2,
            a3: self.a3 - r.a3,
            a4: self.a4 - r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Sub<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Sub<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11 - r.a11,
            a12: self.a12 - r.a12,
            a13: self.a13 - r.a13,
            a14: self.a14 - r.a14,
            a15: self.a15,
        }
    }
}

impl Sub<Pseudoscalar> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15 - r.a15,
        }
    }
}

impl Sub<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 - r.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Sub<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 - r.a0,
            a1: self.a1 - r.a1,
            a2: self.a2 - r.a2,
            a3: self.a3 - r.a3,
            a4: self.a4 - r.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: self.a11 - r.a11,
            a12: self.a12 - r.a12,
            a13: self.a13 - r.a13,
            a14: self.a14 - r.a14,
            a15: self.a15 - r.a15,
        }
    }
}

impl Mul<Float> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r,
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
            a15: self.a15 * r,
        }
    }
}

impl Mul<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4,
            a3: self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a1 * r.a2 - self.a2 * r.a1 - self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a1 * r.a3 - self.a3 * r.a1 + self.a11 * r.a2 - self.a13 * r.a4,
            a7: self.a1 * r.a4 - self.a4 * r.a1 - self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a2 * r.a3 - self.a3 * r.a2 + self.a14 * r.a4,
            a9: -self.a2 * r.a4 + self.a4 * r.a2 + self.a14 * r.a3,
            a10: self.a3 * r.a4 - self.a4 * r.a3 + self.a14 * r.a2,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1 - self.a15 * r.a4,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1 - self.a15 * r.a3,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1 - self.a15 * r.a2,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl Mul<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: -self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10,
            a3: self.a2 * r.a8 - self.a4 * r.a10 - self.a14 * r.a9,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 - self.a14 * r.a8,
            a5: self.a0 * r.a5 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a5 * r.a8 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7 - self.a15 * r.a9,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a9 * r.a5 - self.a10 * r.a6 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5 - self.a11 * r.a10 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6 + self.a11 * r.a9 - self.a12 * r.a8 + self.a14 * r.a5,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14 * r.a14,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 - self.a15 * r.a14,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: -self.a3 * r.a11 + self.a4 * r.a12 + self.a13 * r.a14 - self.a14 * r.a13,
            a6: self.a2 * r.a11 - self.a4 * r.a13 + self.a12 * r.a14 - self.a14 * r.a12,
            a7: -self.a2 * r.a12 + self.a3 * r.a13 + self.a11 * r.a14 - self.a14 * r.a11,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
            a11: self.a0 * r.a11 - self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: self.a0 * r.a12 - self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a13: self.a0 * r.a13 - self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a14: self.a0 * r.a14,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl Mul<Pseudoscalar> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a14 * r.a15,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a10 * r.a15,
            a6: -self.a9 * r.a15,
            a7: -self.a8 * r.a15,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a4 * r.a15,
            a12: self.a3 * r.a15,
            a13: self.a2 * r.a15,
            a14: 0.,
            a15: self.a0 * r.a15,
        }
    }
}

impl Mul<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a14 * r.a9,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a14 * r.a8,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7 - self.a15 * r.a9,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 + self.a9 * r.a5 - self.a10 * r.a6 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a11 * r.a0 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5 - self.a11 * r.a10 + self.a12 * r.a0 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6 + self.a11 * r.a9 - self.a12 * r.a8 + self.a13 * r.a0 + self.a14 * r.a5,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8 + self.a14 * r.a0,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 + self.a15 * r.a0,
        }
    }
}

impl Mul<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 + self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10 - self.a14 * r.a14,
            a1: self.a0 * r.a1 + self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15 - self.a15 * r.a14,
            a2: self.a0 * r.a2 + self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14 - self.a14 * r.a10,
            a3: self.a0 * r.a3 + self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4 - self.a14 * r.a9,
            a4: self.a0 * r.a4 - self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3 - self.a14 * r.a8,
            a5: self.a0 * r.a5 + self.a1 * r.a2 - self.a2 * r.a1 - self.a3 * r.a11 + self.a4 * r.a12 + self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a10 * r.a15 - self.a11 * r.a3 + self.a12 * r.a4 + self.a13 * r.a14 - self.a14 * r.a13 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a1 * r.a3 + self.a2 * r.a11 - self.a3 * r.a1 - self.a4 * r.a13 + self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 - self.a9 * r.a15 + self.a10 * r.a7 + self.a11 * r.a2 + self.a12 * r.a14 - self.a13 * r.a4 - self.a14 * r.a12 - self.a15 * r.a9,
            a7: self.a0 * r.a7 + self.a1 * r.a4 - self.a2 * r.a12 + self.a3 * r.a13 - self.a4 * r.a1 - self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 - self.a8 * r.a15 + self.a9 * r.a5 - self.a10 * r.a6 + self.a11 * r.a14 - self.a12 * r.a2 + self.a13 * r.a3 - self.a14 * r.a11 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a2 * r.a3 - self.a3 * r.a2 + self.a4 * r.a14 + self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9 + self.a14 * r.a4,
            a9: self.a0 * r.a9 - self.a2 * r.a4 + self.a3 * r.a14 + self.a4 * r.a2 - self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8 + self.a14 * r.a3,
            a10: self.a0 * r.a10 + self.a2 * r.a14 + self.a3 * r.a4 - self.a4 * r.a3 + self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0 + self.a14 * r.a2,
            a11: self.a0 * r.a11 - self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a4 * r.a15 - self.a5 * r.a3 + self.a6 * r.a2 - self.a7 * r.a14 - self.a8 * r.a1 + self.a9 * r.a13 - self.a10 * r.a12 + self.a11 * r.a0 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7 - self.a15 * r.a4,
            a12: self.a0 * r.a12 - self.a1 * r.a9 - self.a2 * r.a7 + self.a3 * r.a15 + self.a4 * r.a5 + self.a5 * r.a4 - self.a6 * r.a14 - self.a7 * r.a2 - self.a8 * r.a13 - self.a9 * r.a1 + self.a10 * r.a11 - self.a11 * r.a10 + self.a12 * r.a0 + self.a13 * r.a8 + self.a14 * r.a6 - self.a15 * r.a3,
            a13: self.a0 * r.a13 - self.a1 * r.a10 + self.a2 * r.a15 + self.a3 * r.a7 - self.a4 * r.a6 - self.a5 * r.a14 - self.a6 * r.a4 + self.a7 * r.a3 + self.a8 * r.a12 - self.a9 * r.a11 - self.a10 * r.a1 + self.a11 * r.a9 - self.a12 * r.a8 + self.a13 * r.a0 + self.a14 * r.a5 - self.a15 * r.a2,
            a14: self.a0 * r.a14 + self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8 + self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2 + self.a14 * r.a0,
            a15: self.a0 * r.a15 + self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 - self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1 + self.a15 * r.a0,
        }
    }
}

impl BitXor<Float> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r,
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
            a15: self.a15 * r,
        }
    }
}

impl BitXor<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a0 * r.a1,
            a2: self.a0 * r.a2,
            a3: self.a0 * r.a3,
            a4: self.a0 * r.a4,
            a5: self.a1 * r.a2 - self.a2 * r.a1,
            a6: self.a1 * r.a3 - self.a3 * r.a1,
            a7: self.a1 * r.a4 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2,
            a9: -self.a2 * r.a4 + self.a4 * r.a2,
            a10: self.a3 * r.a4 - self.a4 * r.a3,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl BitXor<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5,
            a6: self.a0 * r.a6,
            a7: self.a0 * r.a7,
            a8: self.a0 * r.a8,
            a9: self.a0 * r.a9,
            a10: self.a0 * r.a10,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl BitXor<Pseudoscalar> for FullMultivector {
    type Output = Pseudoscalar;

    fn bitxor(self, r: Pseudoscalar) -> Pseudoscalar {
        Pseudoscalar {
            a15: self.a0 * r.a15,
        }
    }
}

impl BitXor<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0,
            a1: self.a1 * r.a0,
            a2: self.a2 * r.a0,
            a3: self.a3 * r.a0,
            a4: self.a4 * r.a0,
            a5: self.a0 * r.a5 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a11 * r.a0,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5 + self.a12 * r.a0,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6 + self.a13 * r.a0,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8 + self.a14 * r.a0,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 + self.a15 * r.a0,
        }
    }
}

impl BitXor<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0,
            a1: self.a0 * r.a1 + self.a1 * r.a0,
            a2: self.a0 * r.a2 + self.a2 * r.a0,
            a3: self.a0 * r.a3 + self.a3 * r.a0,
            a4: self.a0 * r.a4 + self.a4 * r.a0,
            a5: self.a0 * r.a5 + self.a1 * r.a2 - self.a2 * r.a1 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a1 * r.a3 - self.a3 * r.a1 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a1 * r.a4 - self.a4 * r.a1 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a2 * r.a3 - self.a3 * r.a2 + self.a8 * r.a0,
            a9: self.a0 * r.a9 - self.a2 * r.a4 + self.a4 * r.a2 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a3 * r.a4 - self.a4 * r.a3 + self.a10 * r.a0,
            a11: self.a0 * r.a11 - self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 - self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1 + self.a11 * r.a0,
            a12: self.a0 * r.a12 - self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5 + self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1 + self.a12 * r.a0,
            a13: self.a0 * r.a13 - self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6 - self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1 + self.a13 * r.a0,
            a14: self.a0 * r.a14 + self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8 + self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2 + self.a14 * r.a0,
            a15: self.a0 * r.a15 + self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 - self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1 + self.a15 * r.a0,
        }
    }
}

impl BitAnd<Float> for FullMultivector {
    type Output = Float;

    fn bitand(self, r: Float) -> Float {
        self.a15 * r
    }
}

impl BitAnd<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a11 * r.a4 + self.a12 * r.a3 + self.a13 * r.a2 + self.a14 * r.a1,
            a1: self.a15 * r.a1,
            a2: self.a15 * r.a2,
            a3: self.a15 * r.a3,
            a4: self.a15 * r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitAnd<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
            a5: self.a15 * r.a5,
            a6: self.a15 * r.a6,
            a7: self.a15 * r.a7,
            a8: self.a15 * r.a8,
            a9: self.a15 * r.a9,
            a10: self.a15 * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitAnd<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a1 * r.a14 - self.a2 * r.a13 - self.a3 * r.a12 - self.a4 * r.a11,
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a5: -self.a11 * r.a12 + self.a12 * r.a11,
            a6: self.a11 * r.a13 - self.a13 * r.a11,
            a7: -self.a12 * r.a13 + self.a13 * r.a12,
            a8: -self.a11 * r.a14 + self.a14 * r.a11,
            a9: -self.a12 * r.a14 + self.a14 * r.a12,
            a10: -self.a13 * r.a14 + self.a14 * r.a13,
            a11: self.a15 * r.a11,
            a12: self.a15 * r.a12,
            a13: self.a15 * r.a13,
            a14: self.a15 * r.a14,
            a15: 0.,
        }
    }
}

impl BitAnd<Pseudoscalar> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a15,
            a1: self.a1 * r.a15,
            a2: self.a2 * r.a15,
            a3: self.a3 * r.a15,
            a4: self.a4 * r.a15,
            a5: self.a5 * r.a15,
            a6: self.a6 * r.a15,
            a7: self.a7 * r.a15,
            a8: self.a8 * r.a15,
            a9: self.a9 * r.a15,
            a10: self.a10 * r.a15,
            a11: self.a11 * r.a15,
            a12: self.a12 * r.a15,
            a13: self.a13 * r.a15,
            a14: self.a14 * r.a15,
            a15: self.a15 * r.a15,
        }
    }
}

impl BitAnd<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 + self.a15 * r.a0,
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
            a5: self.a15 * r.a5,
            a6: self.a15 * r.a6,
            a7: self.a15 * r.a7,
            a8: self.a15 * r.a8,
            a9: self.a15 * r.a9,
            a10: self.a15 * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitAnd<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a15 - self.a1 * r.a14 - self.a2 * r.a13 - self.a3 * r.a12 - self.a4 * r.a11 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 + self.a11 * r.a4 + self.a12 * r.a3 + self.a13 * r.a2 + self.a14 * r.a1 + self.a15 * r.a0,
            a1: self.a1 * r.a15 + self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11 + self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5 + self.a15 * r.a1,
            a2: self.a2 * r.a15 - self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11 - self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5 + self.a15 * r.a2,
            a3: self.a3 * r.a15 - self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11 + self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6 + self.a15 * r.a3,
            a4: self.a4 * r.a15 - self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12 - self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7 + self.a15 * r.a4,
            a5: self.a5 * r.a15 - self.a11 * r.a12 + self.a12 * r.a11 + self.a15 * r.a5,
            a6: self.a6 * r.a15 + self.a11 * r.a13 - self.a13 * r.a11 + self.a15 * r.a6,
            a7: self.a7 * r.a15 - self.a12 * r.a13 + self.a13 * r.a12 + self.a15 * r.a7,
            a8: self.a8 * r.a15 - self.a11 * r.a14 + self.a14 * r.a11 + self.a15 * r.a8,
            a9: self.a9 * r.a15 - self.a12 * r.a14 + self.a14 * r.a12 + self.a15 * r.a9,
            a10: self.a10 * r.a15 - self.a13 * r.a14 + self.a14 * r.a13 + self.a15 * r.a10,
            a11: self.a11 * r.a15 + self.a15 * r.a11,
            a12: self.a12 * r.a15 + self.a15 * r.a12,
            a13: self.a13 * r.a15 + self.a15 * r.a13,
            a14: self.a14 * r.a15 + self.a15 * r.a14,
            a15: self.a15 * r.a15,
        }
    }
}

impl BitOr<Float> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r,
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
            a15: self.a15 * r,
        }
    }
}

impl BitOr<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4,
            a3: self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: -self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a11 * r.a2 - self.a13 * r.a4,
            a7: -self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
            a11: -self.a15 * r.a4,
            a12: -self.a15 * r.a3,
            a13: -self.a15 * r.a2,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: -self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10,
            a3: self.a2 * r.a8 - self.a4 * r.a10 - self.a14 * r.a9,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 - self.a14 * r.a8,
            a5: self.a0 * r.a5 - self.a15 * r.a10,
            a6: self.a0 * r.a6 - self.a15 * r.a9,
            a7: self.a0 * r.a7 - self.a15 * r.a8,
            a8: self.a0 * r.a8,
            a9: self.a0 * r.a9,
            a10: self.a0 * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14 * r.a14,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 - self.a15 * r.a14,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: -self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a2 * r.a11 - self.a4 * r.a13,
            a7: -self.a2 * r.a12 + self.a3 * r.a13,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
            a15: 0.,
        }
    }
}

impl BitOr<Pseudoscalar> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a14 * r.a15,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a10 * r.a15,
            a6: -self.a9 * r.a15,
            a7: -self.a8 * r.a15,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a4 * r.a15,
            a12: self.a3 * r.a15,
            a13: self.a2 * r.a15,
            a14: 0.,
            a15: self.a0 * r.a15,
        }
    }
}

impl BitOr<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a14 * r.a9,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a14 * r.a8,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a6 * r.a0 - self.a15 * r.a9,
            a7: self.a0 * r.a7 + self.a7 * r.a0 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
            a15: self.a15 * r.a0,
        }
    }
}

impl BitOr<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 + self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10 - self.a14 * r.a14,
            a1: self.a0 * r.a1 + self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15 - self.a15 * r.a14,
            a2: self.a0 * r.a2 + self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14 - self.a14 * r.a10,
            a3: self.a0 * r.a3 + self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4 - self.a14 * r.a9,
            a4: self.a0 * r.a4 - self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3 - self.a14 * r.a8,
            a5: self.a0 * r.a5 - self.a3 * r.a11 + self.a4 * r.a12 + self.a5 * r.a0 - self.a10 * r.a15 - self.a11 * r.a3 + self.a12 * r.a4 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a2 * r.a11 - self.a4 * r.a13 + self.a6 * r.a0 - self.a9 * r.a15 + self.a11 * r.a2 - self.a13 * r.a4 - self.a15 * r.a9,
            a7: self.a0 * r.a7 - self.a2 * r.a12 + self.a3 * r.a13 + self.a7 * r.a0 - self.a8 * r.a15 - self.a12 * r.a2 + self.a13 * r.a3 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a4 * r.a14 + self.a8 * r.a0 + self.a14 * r.a4,
            a9: self.a0 * r.a9 + self.a3 * r.a14 + self.a9 * r.a0 + self.a14 * r.a3,
            a10: self.a0 * r.a10 + self.a2 * r.a14 + self.a10 * r.a0 + self.a14 * r.a2,
            a11: self.a0 * r.a11 + self.a4 * r.a15 + self.a11 * r.a0 - self.a15 * r.a4,
            a12: self.a0 * r.a12 + self.a3 * r.a15 + self.a12 * r.a0 - self.a15 * r.a3,
            a13: self.a0 * r.a13 + self.a2 * r.a15 + self.a13 * r.a0 - self.a15 * r.a2,
            a14: self.a0 * r.a14 + self.a14 * r.a0,
            a15: self.a0 * r.a15 + self.a15 * r.a0,
        }
    }
}

impl Project<Float> for FullMultivector {
    fn project(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.powi(2),
            a1: self.a1 * r.powi(2),
            a2: self.a2 * r.powi(2),
            a3: self.a3 * r.powi(2),
            a4: self.a4 * r.powi(2),
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
            a11: self.a11 * r.powi(2),
            a12: self.a12 * r.powi(2),
            a13: self.a13 * r.powi(2),
            a14: self.a14 * r.powi(2),
            a15: self.a15 * r.powi(2),
        }
    }
}

impl Project<Vector> for FullMultivector {
    fn project(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a1: r.a1 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
            a2: r.a2 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
            a3: r.a3 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
            a4: r.a4 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
            a5: self.a5 * r.a2.powi(2) + self.a6 * r.a2 * r.a3 + self.a7 * r.a2 * r.a4 - self.a8 * r.a1 * r.a3 + self.a9 * r.a1 * r.a4,
            a6: self.a5 * r.a2 * r.a3 + self.a6 * r.a3.powi(2) + self.a7 * r.a3 * r.a4 + self.a8 * r.a1 * r.a2 - self.a10 * r.a1 * r.a4,
            a7: self.a5 * r.a2 * r.a4 + self.a6 * r.a3 * r.a4 + self.a7 * r.a4.powi(2) - self.a9 * r.a1 * r.a2 + self.a10 * r.a1 * r.a3,
            a8: self.a8 * r.a2.powi(2) + self.a8 * r.a3.powi(2) - self.a9 * r.a3 * r.a4 - self.a10 * r.a2 * r.a4,
            a9: -self.a8 * r.a3 * r.a4 + self.a9 * r.a2.powi(2) + self.a9 * r.a4.powi(2) - self.a10 * r.a2 * r.a3,
            a10: -self.a8 * r.a2 * r.a4 - self.a9 * r.a2 * r.a3 + self.a10 * r.a3.powi(2) + self.a10 * r.a4.powi(2),
            a11: -self.a14 * r.a1 * r.a4 + r.a2 * (self.a11 * r.a2 - self.a13 * r.a4) + r.a3 * (self.a11 * r.a3 - self.a12 * r.a4),
            a12: -self.a14 * r.a1 * r.a3 + r.a2 * (self.a12 * r.a2 - self.a13 * r.a3) - r.a4 * (self.a11 * r.a3 - self.a12 * r.a4),
            a13: -self.a14 * r.a1 * r.a2 - r.a3 * (self.a12 * r.a2 - self.a13 * r.a3) - r.a4 * (self.a11 * r.a2 - self.a13 * r.a4),
            a14: self.a14 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a15: self.a15 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
        }
    }
}

impl Project<Bivector> for FullMultivector {
    fn project(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * (-r.a8.powi(2) - r.a9.powi(2) - r.a10.powi(2)),
            a1: r.a5 * (self.a3 * r.a8 - self.a4 * r.a9 + self.a14 * r.a10) + r.a6 * (-self.a2 * r.a8 + self.a4 * r.a10 + self.a14 * r.a9) + r.a7 * (self.a2 * r.a9 - self.a3 * r.a10 + self.a14 * r.a8),
            a2: -self.a2 * r.a8.powi(2) - self.a2 * r.a9.powi(2) + self.a3 * r.a9 * r.a10 + self.a4 * r.a8 * r.a10,
            a3: self.a2 * r.a9 * r.a10 - self.a3 * r.a8.powi(2) - self.a3 * r.a10.powi(2) + self.a4 * r.a8 * r.a9,
            a4: self.a2 * r.a8 * r.a10 + self.a3 * r.a8 * r.a9 - self.a4 * r.a9.powi(2) - self.a4 * r.a10.powi(2),
            a5: r.a5 * (-self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10),
            a6: r.a6 * (-self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10),
            a7: r.a7 * (-self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10),
            a8: -r.a8 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a9: -r.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a10: -r.a10 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a11: self.a4 * r.a5 * r.a10 + self.a4 * r.a6 * r.a9 + self.a4 * r.a7 * r.a8 - self.a11 * r.a8.powi(2) - self.a12 * r.a8 * r.a9 - self.a13 * r.a8 * r.a10 + self.a14 * r.a5 * r.a9 - self.a14 * r.a6 * r.a10,
            a12: self.a3 * r.a5 * r.a10 + self.a3 * r.a6 * r.a9 + self.a3 * r.a7 * r.a8 - self.a11 * r.a8 * r.a9 - self.a12 * r.a9.powi(2) - self.a13 * r.a9 * r.a10 - self.a14 * r.a5 * r.a8 + self.a14 * r.a7 * r.a10,
            a13: self.a2 * r.a5 * r.a10 + self.a2 * r.a6 * r.a9 + self.a2 * r.a7 * r.a8 - self.a11 * r.a8 * r.a10 - self.a12 * r.a9 * r.a10 - self.a13 * r.a10.powi(2) + self.a14 * r.a6 * r.a8 - self.a14 * r.a7 * r.a9,
            a14: self.a14 * (-r.a8.powi(2) - r.a9.powi(2) - r.a10.powi(2)),
            a15: 2. * self.a0 * r.a5 * r.a10 + 2. * self.a0 * r.a6 * r.a9 + 2. * self.a0 * r.a7 * r.a8 - self.a15 * r.a8.powi(2) - self.a15 * r.a9.powi(2) - self.a15 * r.a10.powi(2),
        }
    }
}

impl Project<Trivector> for FullMultivector {
    fn project(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a0 * r.a14.powi(2),
            a1: r.a14 * (self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11),
            a2: -self.a2 * r.a14.powi(2),
            a3: -self.a3 * r.a14.powi(2),
            a4: -self.a4 * r.a14.powi(2),
            a5: r.a14 * (-self.a8 * r.a12 + self.a9 * r.a11),
            a6: r.a14 * (self.a8 * r.a13 - self.a10 * r.a11),
            a7: r.a14 * (-self.a9 * r.a13 + self.a10 * r.a12),
            a8: -self.a8 * r.a14.powi(2),
            a9: -self.a9 * r.a14.powi(2),
            a10: -self.a10 * r.a14.powi(2),
            a11: -self.a14 * r.a11 * r.a14,
            a12: -self.a14 * r.a12 * r.a14,
            a13: -self.a14 * r.a13 * r.a14,
            a14: -self.a14 * r.a14.powi(2),
            a15: -self.a15 * r.a14.powi(2),
        }
    }
}

impl Project<Pseudoscalar> for FullMultivector {
    fn project(self, _r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Project<ScalarAndBivector> for FullMultivector {
    fn project(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0.powi(2) - self.a0 * r.a8.powi(2) - self.a0 * r.a9.powi(2) - self.a0 * r.a10.powi(2) - 2. * self.a8 * r.a0 * r.a8 - 2. * self.a9 * r.a0 * r.a9 - 2. * self.a10 * r.a0 * r.a10,
            a1: self.a11 * r.a0 * r.a8 + self.a12 * r.a0 * r.a9 + self.a13 * r.a0 * r.a10 + r.a0 * (self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10) - r.a5 * (self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10) - r.a6 * (self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a14 * r.a9) + r.a7 * (self.a2 * r.a9 - self.a3 * r.a10 - self.a4 * r.a0 + self.a14 * r.a8),
            a2: self.a2 * r.a0.powi(2) - self.a2 * r.a8.powi(2) - self.a2 * r.a9.powi(2) - 2. * self.a3 * r.a0 * r.a8 + self.a3 * r.a9 * r.a10 + 2. * self.a4 * r.a0 * r.a9 + self.a4 * r.a8 * r.a10 - 2. * self.a14 * r.a0 * r.a10,
            a3: 2. * self.a2 * r.a0 * r.a8 + self.a2 * r.a9 * r.a10 + self.a3 * r.a0.powi(2) - self.a3 * r.a8.powi(2) - self.a3 * r.a10.powi(2) - 2. * self.a4 * r.a0 * r.a10 + self.a4 * r.a8 * r.a9 - 2. * self.a14 * r.a0 * r.a9,
            a4: -2. * self.a2 * r.a0 * r.a9 + self.a2 * r.a8 * r.a10 + 2. * self.a3 * r.a0 * r.a10 + self.a3 * r.a8 * r.a9 + self.a4 * r.a0.powi(2) - self.a4 * r.a9.powi(2) - self.a4 * r.a10.powi(2) - 2. * self.a14 * r.a0 * r.a8,
            a5: 2. * self.a0 * r.a0 * r.a5 + self.a5 * r.a0.powi(2) - self.a6 * r.a0 * r.a8 + self.a7 * r.a0 * r.a9 + self.a8 * r.a0 * r.a6 - self.a8 * r.a5 * r.a8 - self.a9 * r.a0 * r.a7 - self.a9 * r.a5 * r.a9 - self.a10 * r.a5 * r.a10 - 2. * self.a15 * r.a0 * r.a10,
            a6: 2. * self.a0 * r.a0 * r.a6 + self.a5 * r.a0 * r.a8 + self.a6 * r.a0.powi(2) - self.a7 * r.a0 * r.a10 - self.a8 * r.a0 * r.a5 - self.a8 * r.a6 * r.a8 - self.a9 * r.a6 * r.a9 + self.a10 * r.a0 * r.a7 - self.a10 * r.a6 * r.a10 - 2. * self.a15 * r.a0 * r.a9,
            a7: 2. * self.a0 * r.a0 * r.a7 - self.a5 * r.a0 * r.a9 + self.a6 * r.a0 * r.a10 + self.a7 * r.a0.powi(2) - self.a8 * r.a7 * r.a8 + self.a9 * r.a0 * r.a5 - self.a9 * r.a7 * r.a9 - self.a10 * r.a0 * r.a6 - self.a10 * r.a7 * r.a10 - 2. * self.a15 * r.a0 * r.a8,
            a8: 2. * self.a0 * r.a0 * r.a8 + self.a8 * r.a0.powi(2) - self.a8 * r.a8.powi(2) + self.a9 * r.a0 * r.a10 - self.a9 * r.a8 * r.a9 - self.a10 * r.a0 * r.a9 - self.a10 * r.a8 * r.a10,
            a9: 2. * self.a0 * r.a0 * r.a9 - self.a8 * r.a0 * r.a10 - self.a8 * r.a8 * r.a9 + self.a9 * r.a0.powi(2) - self.a9 * r.a9.powi(2) + self.a10 * r.a0 * r.a8 - self.a10 * r.a9 * r.a10,
            a10: 2. * self.a0 * r.a0 * r.a10 + self.a8 * r.a0 * r.a9 - self.a8 * r.a8 * r.a10 - self.a9 * r.a0 * r.a8 - self.a9 * r.a9 * r.a10 + self.a10 * r.a0.powi(2) - self.a10 * r.a10.powi(2),
            a11: self.a11 * r.a0.powi(2) + self.a12 * r.a0 * r.a10 - self.a13 * r.a0 * r.a9 + self.a14 * r.a0 * r.a7 - r.a5 * (self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a14 * r.a9) + r.a6 * (self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10) - r.a8 * (self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10),
            a12: -self.a11 * r.a0 * r.a10 + self.a12 * r.a0.powi(2) + self.a13 * r.a0 * r.a8 + self.a14 * r.a0 * r.a6 - r.a5 * (self.a2 * r.a9 - self.a3 * r.a10 - self.a4 * r.a0 + self.a14 * r.a8) - r.a7 * (self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10) - r.a9 * (self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10),
            a13: self.a11 * r.a0 * r.a9 - self.a12 * r.a0 * r.a8 + self.a13 * r.a0.powi(2) + self.a14 * r.a0 * r.a5 + r.a6 * (self.a2 * r.a9 - self.a3 * r.a10 - self.a4 * r.a0 + self.a14 * r.a8) + r.a7 * (self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a14 * r.a9) - r.a10 * (self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10),
            a14: self.a2 * r.a0 * r.a10 + self.a3 * r.a0 * r.a9 + self.a4 * r.a0 * r.a8 + self.a14 * r.a0.powi(2) - self.a14 * r.a8.powi(2) - self.a14 * r.a9.powi(2) - self.a14 * r.a10.powi(2),
            a15: self.a15 * r.a0.powi(2) + r.a5 * (self.a0 * r.a10 + self.a10 * r.a0) + r.a6 * (self.a0 * r.a9 + self.a9 * r.a0) + r.a7 * (self.a0 * r.a8 + self.a8 * r.a0) + r.a8 * (self.a0 * r.a7 + self.a7 * r.a0 - self.a15 * r.a8) + r.a9 * (self.a0 * r.a6 + self.a6 * r.a0 - self.a15 * r.a9) + r.a10 * (self.a0 * r.a5 + self.a5 * r.a0 - self.a15 * r.a10),
        }
    }
}

impl Project<FullMultivector> for FullMultivector {
    fn project(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0 * (self.a0 * r.a0 + self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10 - self.a14 * r.a14) + r.a2 * (self.a0 * r.a2 + self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14 - self.a14 * r.a10) + r.a3 * (self.a0 * r.a3 + self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4 - self.a14 * r.a9) + r.a4 * (self.a0 * r.a4 - self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3 - self.a14 * r.a8) - r.a8 * (self.a0 * r.a8 + self.a4 * r.a14 + self.a8 * r.a0 + self.a14 * r.a4) - r.a9 * (self.a0 * r.a9 + self.a3 * r.a14 + self.a9 * r.a0 + self.a14 * r.a3) - r.a10 * (self.a0 * r.a10 + self.a2 * r.a14 + self.a10 * r.a0 + self.a14 * r.a2) - r.a14 * (self.a0 * r.a14 + self.a14 * r.a0),
            a1: r.a0 * (self.a0 * r.a1 + self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15 - self.a15 * r.a14) + r.a1 * (self.a0 * r.a0 + self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10 - self.a14 * r.a14) + r.a2 * (self.a0 * r.a5 - self.a3 * r.a11 + self.a4 * r.a12 + self.a5 * r.a0 - self.a10 * r.a15 - self.a11 * r.a3 + self.a12 * r.a4 - self.a15 * r.a10) + r.a3 * (self.a0 * r.a6 + self.a2 * r.a11 - self.a4 * r.a13 + self.a6 * r.a0 - self.a9 * r.a15 + self.a11 * r.a2 - self.a13 * r.a4 - self.a15 * r.a9) + r.a4 * (self.a0 * r.a7 - self.a2 * r.a12 + self.a3 * r.a13 + self.a7 * r.a0 - self.a8 * r.a15 - self.a12 * r.a2 + self.a13 * r.a3 - self.a15 * r.a8) - r.a5 * (self.a0 * r.a2 + self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14 - self.a14 * r.a10) - r.a6 * (self.a0 * r.a3 + self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4 - self.a14 * r.a9) - r.a7 * (self.a0 * r.a4 - self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3 - self.a14 * r.a8) + r.a8 * (self.a0 * r.a11 + self.a4 * r.a15 + self.a11 * r.a0 - self.a15 * r.a4) + r.a9 * (self.a0 * r.a12 + self.a3 * r.a15 + self.a12 * r.a0 - self.a15 * r.a3) + r.a10 * (self.a0 * r.a13 + self.a2 * r.a15 + self.a13 * r.a0 - self.a15 * r.a2) + r.a11 * (self.a0 * r.a8 + self.a4 * r.a14 + self.a8 * r.a0 + self.a14 * r.a4) + r.a12 * (self.a0 * r.a9 + self.a3 * r.a14 + self.a9 * r.a0 + self.a14 * r.a3) + r.a13 * (self.a0 * r.a10 + self.a2 * r.a14 + self.a10 * r.a0 + self.a14 * r.a2) - r.a14 * (self.a0 * r.a15 + self.a15 * r.a0) + r.a15 * (self.a0 * r.a14 + self.a14 * r.a0),
            a2: 2. * self.a0 * r.a0 * r.a2 - 2. * self.a0 * r.a10 * r.a14 + self.a2 * r.a0.powi(2) + self.a2 * r.a2.powi(2) - self.a2 * r.a8.powi(2) - self.a2 * r.a9.powi(2) - self.a2 * r.a14.powi(2) - 2. * self.a3 * r.a0 * r.a8 + self.a3 * r.a2 * r.a3 - self.a3 * r.a4 * r.a14 + self.a3 * r.a9 * r.a10 + 2. * self.a4 * r.a0 * r.a9 + self.a4 * r.a2 * r.a4 + self.a4 * r.a3 * r.a14 + self.a4 * r.a8 * r.a10 + 2. * self.a8 * r.a0 * r.a3 - self.a8 * r.a9 * r.a14 - 2. * self.a9 * r.a0 * r.a4 + self.a9 * r.a8 * r.a14 - 2. * self.a10 * r.a0 * r.a14 - self.a10 * r.a2 * r.a10 - self.a10 * r.a3 * r.a9 - self.a10 * r.a4 * r.a8 - 2. * self.a14 * r.a0 * r.a10 - 2. * self.a14 * r.a2 * r.a14,
            a3: 2. * self.a0 * r.a0 * r.a3 - 2. * self.a0 * r.a9 * r.a14 + 2. * self.a2 * r.a0 * r.a8 + self.a2 * r.a2 * r.a3 + self.a2 * r.a4 * r.a14 + self.a2 * r.a9 * r.a10 + self.a3 * r.a0.powi(2) + self.a3 * r.a3.powi(2) - self.a3 * r.a8.powi(2) - self.a3 * r.a10.powi(2) - self.a3 * r.a14.powi(2) - 2. * self.a4 * r.a0 * r.a10 - self.a4 * r.a2 * r.a14 + self.a4 * r.a3 * r.a4 + self.a4 * r.a8 * r.a9 - 2. * self.a8 * r.a0 * r.a2 + self.a8 * r.a10 * r.a14 - 2. * self.a9 * r.a0 * r.a14 - self.a9 * r.a2 * r.a10 - self.a9 * r.a3 * r.a9 - self.a9 * r.a4 * r.a8 + 2. * self.a10 * r.a0 * r.a4 - self.a10 * r.a8 * r.a14 - 2. * self.a14 * r.a0 * r.a9 - 2. * self.a14 * r.a3 * r.a14,
            a4: 2. * self.a0 * r.a0 * r.a4 - 2. * self.a0 * r.a8 * r.a14 - 2. * self.a2 * r.a0 * r.a9 + self.a2 * r.a2 * r.a4 - self.a2 * r.a3 * r.a14 + self.a2 * r.a8 * r.a10 + 2. * self.a3 * r.a0 * r.a10 + self.a3 * r.a2 * r.a14 + self.a3 * r.a3 * r.a4 + self.a3 * r.a8 * r.a9 + self.a4 * r.a0.powi(2) + self.a4 * r.a4.powi(2) - self.a4 * r.a9.powi(2) - self.a4 * r.a10.powi(2) - self.a4 * r.a14.powi(2) - 2. * self.a8 * r.a0 * r.a14 - self.a8 * r.a2 * r.a10 - self.a8 * r.a3 * r.a9 - self.a8 * r.a4 * r.a8 + 2. * self.a9 * r.a0 * r.a2 - self.a9 * r.a10 * r.a14 - 2. * self.a10 * r.a0 * r.a3 + self.a10 * r.a9 * r.a14 - 2. * self.a14 * r.a0 * r.a8 - 2. * self.a14 * r.a4 * r.a14,
            a5: 2. * self.a0 * r.a0 * r.a5 - 2. * self.a0 * r.a3 * r.a11 + 2. * self.a0 * r.a4 * r.a12 - 2. * self.a0 * r.a10 * r.a15 + self.a1 * r.a0 * r.a2 - self.a2 * r.a0 * r.a1 - 2. * self.a2 * r.a8 * r.a11 - 2. * self.a2 * r.a9 * r.a12 - 2. * self.a3 * r.a0 * r.a11 + self.a3 * r.a1 * r.a8 - self.a3 * r.a2 * r.a6 + self.a3 * r.a3 * r.a5 + self.a3 * r.a4 * r.a15 - self.a3 * r.a7 * r.a14 + self.a3 * r.a9 * r.a13 + self.a3 * r.a10 * r.a12 + 2. * self.a4 * r.a0 * r.a12 - self.a4 * r.a1 * r.a9 - self.a4 * r.a2 * r.a7 - self.a4 * r.a3 * r.a15 + self.a4 * r.a4 * r.a5 + self.a4 * r.a6 * r.a14 + self.a4 * r.a8 * r.a13 + self.a4 * r.a10 * r.a11 + self.a5 * r.a0.powi(2) + self.a5 * r.a2.powi(2) - self.a6 * r.a0 * r.a8 + self.a6 * r.a2 * r.a3 + self.a7 * r.a0 * r.a9 + self.a7 * r.a2 * r.a4 + self.a8 * r.a0 * r.a6 - self.a8 * r.a1 * r.a3 + 2. * self.a8 * r.a2 * r.a11 - self.a8 * r.a5 * r.a8 - self.a8 * r.a9 * r.a15 - self.a8 * r.a12 * r.a14 - self.a9 * r.a0 * r.a7 + self.a9 * r.a1 * r.a4 + 2. * self.a9 * r.a2 * r.a12 - self.a9 * r.a5 * r.a9 + self.a9 * r.a8 * r.a15 + self.a9 * r.a11 * r.a14 - 2. * self.a10 * r.a0 * r.a15 + self.a10 * r.a1 * r.a14 + self.a10 * r.a2 * r.a13 - self.a10 * r.a3 * r.a12 - self.a10 * r.a4 * r.a11 - self.a10 * r.a5 * r.a10 - 2. * self.a11 * r.a0 * r.a3 + 2. * self.a12 * r.a0 * r.a4 + self.a13 * r.a0 * r.a14 + self.a13 * r.a2 * r.a10 + self.a13 * r.a3 * r.a9 + self.a13 * r.a4 * r.a8 - self.a14 * r.a0 * r.a13 + self.a14 * r.a1 * r.a10 - self.a14 * r.a3 * r.a7 + self.a14 * r.a4 * r.a6 - self.a14 * r.a5 * r.a14 - self.a14 * r.a8 * r.a12 + self.a14 * r.a9 * r.a11 - 2. * self.a15 * r.a0 * r.a10 - 2. * self.a15 * r.a2 * r.a14,
            a6: 2. * self.a0 * r.a0 * r.a6 + 2. * self.a0 * r.a2 * r.a11 - 2. * self.a0 * r.a4 * r.a13 - 2. * self.a0 * r.a9 * r.a15 + self.a1 * r.a0 * r.a3 + 2. * self.a2 * r.a0 * r.a11 - self.a2 * r.a1 * r.a8 + self.a2 * r.a2 * r.a6 - self.a2 * r.a3 * r.a5 - self.a2 * r.a4 * r.a15 + self.a2 * r.a7 * r.a14 + self.a2 * r.a9 * r.a13 + self.a2 * r.a10 * r.a12 - self.a3 * r.a0 * r.a1 - 2. * self.a3 * r.a8 * r.a11 - 2. * self.a3 * r.a10 * r.a13 - 2. * self.a4 * r.a0 * r.a13 + self.a4 * r.a1 * r.a10 + self.a4 * r.a2 * r.a15 - self.a4 * r.a3 * r.a7 + self.a4 * r.a4 * r.a6 - self.a4 * r.a5 * r.a14 + self.a4 * r.a8 * r.a12 + self.a4 * r.a9 * r.a11 + self.a5 * r.a0 * r.a8 + self.a5 * r.a2 * r.a3 + self.a6 * r.a0.powi(2) + self.a6 * r.a3.powi(2) - self.a7 * r.a0 * r.a10 + self.a7 * r.a3 * r.a4 - self.a8 * r.a0 * r.a5 + self.a8 * r.a1 * r.a2 + 2. * self.a8 * r.a3 * r.a11 - self.a8 * r.a6 * r.a8 + self.a8 * r.a10 * r.a15 + self.a8 * r.a13 * r.a14 - 2. * self.a9 * r.a0 * r.a15 + self.a9 * r.a1 * r.a14 - self.a9 * r.a2 * r.a13 + self.a9 * r.a3 * r.a12 - self.a9 * r.a4 * r.a11 - self.a9 * r.a6 * r.a9 + self.a10 * r.a0 * r.a7 - self.a10 * r.a1 * r.a4 + 2. * self.a10 * r.a3 * r.a13 - self.a10 * r.a6 * r.a10 - self.a10 * r.a8 * r.a15 - self.a10 * r.a11 * r.a14 + 2. * self.a11 * r.a0 * r.a2 + self.a12 * r.a0 * r.a14 + self.a12 * r.a2 * r.a10 + self.a12 * r.a3 * r.a9 + self.a12 * r.a4 * r.a8 - 2. * self.a13 * r.a0 * r.a4 - self.a14 * r.a0 * r.a12 + self.a14 * r.a1 * r.a9 + self.a14 * r.a2 * r.a7 - self.a14 * r.a4 * r.a5 - self.a14 * r.a6 * r.a14 + self.a14 * r.a8 * r.a13 - self.a14 * r.a10 * r.a11 - 2. * self.a15 * r.a0 * r.a9 - 2. * self.a15 * r.a3 * r.a14,
            a7: 2. * self.a0 * r.a0 * r.a7 - 2. * self.a0 * r.a2 * r.a12 + 2. * self.a0 * r.a3 * r.a13 - 2. * self.a0 * r.a8 * r.a15 + self.a1 * r.a0 * r.a4 - 2. * self.a2 * r.a0 * r.a12 + self.a2 * r.a1 * r.a9 + self.a2 * r.a2 * r.a7 + self.a2 * r.a3 * r.a15 - self.a2 * r.a4 * r.a5 - self.a2 * r.a6 * r.a14 + self.a2 * r.a8 * r.a13 + self.a2 * r.a10 * r.a11 + 2. * self.a3 * r.a0 * r.a13 - self.a3 * r.a1 * r.a10 - self.a3 * r.a2 * r.a15 + self.a3 * r.a3 * r.a7 - self.a3 * r.a4 * r.a6 + self.a3 * r.a5 * r.a14 + self.a3 * r.a8 * r.a12 + self.a3 * r.a9 * r.a11 - self.a4 * r.a0 * r.a1 - 2. * self.a4 * r.a9 * r.a12 - 2. * self.a4 * r.a10 * r.a13 - self.a5 * r.a0 * r.a9 + self.a5 * r.a2 * r.a4 + self.a6 * r.a0 * r.a10 + self.a6 * r.a3 * r.a4 + self.a7 * r.a0.powi(2) + self.a7 * r.a4.powi(2) - 2. * self.a8 * r.a0 * r.a15 + self.a8 * r.a1 * r.a14 - self.a8 * r.a2 * r.a13 - self.a8 * r.a3 * r.a12 + self.a8 * r.a4 * r.a11 - self.a8 * r.a7 * r.a8 + self.a9 * r.a0 * r.a5 - self.a9 * r.a1 * r.a2 + 2. * self.a9 * r.a4 * r.a12 - self.a9 * r.a7 * r.a9 - self.a9 * r.a10 * r.a15 - self.a9 * r.a13 * r.a14 - self.a10 * r.a0 * r.a6 + self.a10 * r.a1 * r.a3 + 2. * self.a10 * r.a4 * r.a13 - self.a10 * r.a7 * r.a10 + self.a10 * r.a9 * r.a15 + self.a10 * r.a12 * r.a14 + self.a11 * r.a0 * r.a14 + self.a11 * r.a2 * r.a10 + self.a11 * r.a3 * r.a9 + self.a11 * r.a4 * r.a8 - 2. * self.a12 * r.a0 * r.a2 + 2. * self.a13 * r.a0 * r.a3 - self.a14 * r.a0 * r.a11 + self.a14 * r.a1 * r.a8 - self.a14 * r.a2 * r.a6 + self.a14 * r.a3 * r.a5 - self.a14 * r.a7 * r.a14 - self.a14 * r.a9 * r.a13 + self.a14 * r.a10 * r.a12 - 2. * self.a15 * r.a0 * r.a8 - 2. * self.a15 * r.a4 * r.a14,
            a8: 2. * self.a0 * r.a0 * r.a8 + 2. * self.a0 * r.a4 * r.a14 + self.a2 * r.a0 * r.a3 - 2. * self.a2 * r.a9 * r.a14 - self.a3 * r.a0 * r.a2 + 2. * self.a3 * r.a10 * r.a14 + 2. * self.a4 * r.a0 * r.a14 + self.a4 * r.a2 * r.a10 + self.a4 * r.a3 * r.a9 + self.a4 * r.a4 * r.a8 + self.a8 * r.a0.powi(2) + self.a8 * r.a2.powi(2) + self.a8 * r.a3.powi(2) - self.a8 * r.a8.powi(2) - self.a8 * r.a14.powi(2) + self.a9 * r.a0 * r.a10 + 2. * self.a9 * r.a2 * r.a14 - self.a9 * r.a3 * r.a4 - self.a9 * r.a8 * r.a9 - self.a10 * r.a0 * r.a9 - self.a10 * r.a2 * r.a4 - 2. * self.a10 * r.a3 * r.a14 - self.a10 * r.a8 * r.a10 + 2. * self.a14 * r.a0 * r.a4 - 2. * self.a14 * r.a8 * r.a14,
            a9: 2. * self.a0 * r.a0 * r.a9 + 2. * self.a0 * r.a3 * r.a14 - self.a2 * r.a0 * r.a4 + 2. * self.a2 * r.a8 * r.a14 + 2. * self.a3 * r.a0 * r.a14 + self.a3 * r.a2 * r.a10 + self.a3 * r.a3 * r.a9 + self.a3 * r.a4 * r.a8 + self.a4 * r.a0 * r.a2 - 2. * self.a4 * r.a10 * r.a14 - self.a8 * r.a0 * r.a10 - 2. * self.a8 * r.a2 * r.a14 - self.a8 * r.a3 * r.a4 - self.a8 * r.a8 * r.a9 + self.a9 * r.a0.powi(2) + self.a9 * r.a2.powi(2) + self.a9 * r.a4.powi(2) - self.a9 * r.a9.powi(2) - self.a9 * r.a14.powi(2) + self.a10 * r.a0 * r.a8 - self.a10 * r.a2 * r.a3 + 2. * self.a10 * r.a4 * r.a14 - self.a10 * r.a9 * r.a10 + 2. * self.a14 * r.a0 * r.a3 - 2. * self.a14 * r.a9 * r.a14,
            a10: 2. * self.a0 * r.a0 * r.a10 + 2. * self.a0 * r.a2 * r.a14 + 2. * self.a2 * r.a0 * r.a14 + self.a2 * r.a2 * r.a10 + self.a2 * r.a3 * r.a9 + self.a2 * r.a4 * r.a8 + self.a3 * r.a0 * r.a4 - 2. * self.a3 * r.a8 * r.a14 - self.a4 * r.a0 * r.a3 + 2. * self.a4 * r.a9 * r.a14 + self.a8 * r.a0 * r.a9 - self.a8 * r.a2 * r.a4 + 2. * self.a8 * r.a3 * r.a14 - self.a8 * r.a8 * r.a10 - self.a9 * r.a0 * r.a8 - self.a9 * r.a2 * r.a3 - 2. * self.a9 * r.a4 * r.a14 - self.a9 * r.a9 * r.a10 + self.a10 * r.a0.powi(2) + self.a10 * r.a3.powi(2) + self.a10 * r.a4.powi(2) - self.a10 * r.a10.powi(2) - self.a10 * r.a14.powi(2) + 2. * self.a14 * r.a0 * r.a2 - 2. * self.a14 * r.a10 * r.a14,
            a11: 2. * self.a0 * r.a0 * r.a11 - 2. * self.a0 * r.a1 * r.a8 + 2. * self.a0 * r.a2 * r.a6 - 2. * self.a0 * r.a3 * r.a5 - self.a1 * r.a0 * r.a8 + self.a2 * r.a0 * r.a6 + 2. * self.a2 * r.a2 * r.a11 - 2. * self.a2 * r.a9 * r.a15 - self.a3 * r.a0 * r.a5 + 2. * self.a3 * r.a3 * r.a11 + 2. * self.a3 * r.a10 * r.a15 + 2. * self.a4 * r.a0 * r.a15 - self.a4 * r.a1 * r.a14 - self.a4 * r.a2 * r.a13 - self.a4 * r.a3 * r.a12 + self.a4 * r.a4 * r.a11 + self.a4 * r.a5 * r.a10 + self.a4 * r.a6 * r.a9 + self.a4 * r.a7 * r.a8 - self.a5 * r.a0 * r.a3 - self.a5 * r.a2 * r.a8 + self.a6 * r.a0 * r.a2 - self.a6 * r.a3 * r.a8 - self.a7 * r.a0 * r.a14 - self.a7 * r.a4 * r.a8 - self.a8 * r.a0 * r.a1 + self.a8 * r.a2 * r.a5 + self.a8 * r.a3 * r.a6 - 2. * self.a8 * r.a8 * r.a11 + self.a9 * r.a0 * r.a13 - self.a9 * r.a4 * r.a6 + self.a9 * r.a5 * r.a14 - self.a9 * r.a8 * r.a12 - self.a9 * r.a9 * r.a11 - self.a10 * r.a0 * r.a12 - self.a10 * r.a4 * r.a5 - self.a10 * r.a6 * r.a14 - self.a10 * r.a8 * r.a13 - self.a10 * r.a10 * r.a11 + self.a11 * r.a0.powi(2) + self.a11 * r.a2.powi(2) + self.a11 * r.a3.powi(2) - self.a11 * r.a8.powi(2) + self.a12 * r.a0 * r.a10 + self.a12 * r.a2 * r.a14 - self.a12 * r.a3 * r.a4 - self.a12 * r.a8 * r.a9 - self.a13 * r.a0 * r.a9 - self.a13 * r.a2 * r.a4 - self.a13 * r.a3 * r.a14 - self.a13 * r.a8 * r.a10 + self.a14 * r.a0 * r.a7 - self.a14 * r.a1 * r.a4 - self.a14 * r.a2 * r.a12 + self.a14 * r.a3 * r.a13 + self.a14 * r.a5 * r.a9 - self.a14 * r.a6 * r.a10 - 2. * self.a14 * r.a8 * r.a15 - self.a14 * r.a11 * r.a14 - 2. * self.a15 * r.a0 * r.a4 + 2. * self.a15 * r.a8 * r.a14,
            a12: 2. * self.a0 * r.a0 * r.a12 - 2. * self.a0 * r.a1 * r.a9 - 2. * self.a0 * r.a2 * r.a7 + 2. * self.a0 * r.a4 * r.a5 - self.a1 * r.a0 * r.a9 - self.a2 * r.a0 * r.a7 + 2. * self.a2 * r.a2 * r.a12 + 2. * self.a2 * r.a8 * r.a15 + 2. * self.a3 * r.a0 * r.a15 - self.a3 * r.a1 * r.a14 - self.a3 * r.a2 * r.a13 + self.a3 * r.a3 * r.a12 - self.a3 * r.a4 * r.a11 + self.a3 * r.a5 * r.a10 + self.a3 * r.a6 * r.a9 + self.a3 * r.a7 * r.a8 + self.a4 * r.a0 * r.a5 + 2. * self.a4 * r.a4 * r.a12 - 2. * self.a4 * r.a10 * r.a15 + self.a5 * r.a0 * r.a4 - self.a5 * r.a2 * r.a9 - self.a6 * r.a0 * r.a14 - self.a6 * r.a3 * r.a9 - self.a7 * r.a0 * r.a2 - self.a7 * r.a4 * r.a9 - self.a8 * r.a0 * r.a13 - self.a8 * r.a3 * r.a7 - self.a8 * r.a5 * r.a14 - self.a8 * r.a8 * r.a12 - self.a8 * r.a9 * r.a11 - self.a9 * r.a0 * r.a1 + self.a9 * r.a2 * r.a5 + self.a9 * r.a4 * r.a7 - 2. * self.a9 * r.a9 * r.a12 + self.a10 * r.a0 * r.a11 - self.a10 * r.a3 * r.a5 + self.a10 * r.a7 * r.a14 - self.a10 * r.a9 * r.a13 - self.a10 * r.a10 * r.a12 - self.a11 * r.a0 * r.a10 - self.a11 * r.a2 * r.a14 - self.a11 * r.a3 * r.a4 - self.a11 * r.a8 * r.a9 + self.a12 * r.a0.powi(2) + self.a12 * r.a2.powi(2) + self.a12 * r.a4.powi(2) - self.a12 * r.a9.powi(2) + self.a13 * r.a0 * r.a8 - self.a13 * r.a2 * r.a3 + self.a13 * r.a4 * r.a14 - self.a13 * r.a9 * r.a10 + self.a14 * r.a0 * r.a6 - self.a14 * r.a1 * r.a3 + self.a14 * r.a2 * r.a11 - self.a14 * r.a4 * r.a13 - self.a14 * r.a5 * r.a8 + self.a14 * r.a7 * r.a10 - 2. * self.a14 * r.a9 * r.a15 - self.a14 * r.a12 * r.a14 - 2. * self.a15 * r.a0 * r.a3 + 2. * self.a15 * r.a9 * r.a14,
            a13: 2. * self.a0 * r.a0 * r.a13 - 2. * self.a0 * r.a1 * r.a10 + 2. * self.a0 * r.a3 * r.a7 - 2. * self.a0 * r.a4 * r.a6 - self.a1 * r.a0 * r.a10 + 2. * self.a2 * r.a0 * r.a15 - self.a2 * r.a1 * r.a14 + self.a2 * r.a2 * r.a13 - self.a2 * r.a3 * r.a12 - self.a2 * r.a4 * r.a11 + self.a2 * r.a5 * r.a10 + self.a2 * r.a6 * r.a9 + self.a2 * r.a7 * r.a8 + self.a3 * r.a0 * r.a7 + 2. * self.a3 * r.a3 * r.a13 - 2. * self.a3 * r.a8 * r.a15 - self.a4 * r.a0 * r.a6 + 2. * self.a4 * r.a4 * r.a13 + 2. * self.a4 * r.a9 * r.a15 - self.a5 * r.a0 * r.a14 - self.a5 * r.a2 * r.a10 - self.a6 * r.a0 * r.a4 - self.a6 * r.a3 * r.a10 + self.a7 * r.a0 * r.a3 - self.a7 * r.a4 * r.a10 + self.a8 * r.a0 * r.a12 - self.a8 * r.a2 * r.a7 + self.a8 * r.a6 * r.a14 - self.a8 * r.a8 * r.a13 - self.a8 * r.a10 * r.a11 - self.a9 * r.a0 * r.a11 - self.a9 * r.a2 * r.a6 - self.a9 * r.a7 * r.a14 - self.a9 * r.a9 * r.a13 - self.a9 * r.a10 * r.a12 - self.a10 * r.a0 * r.a1 + self.a10 * r.a3 * r.a6 + self.a10 * r.a4 * r.a7 - 2. * self.a10 * r.a10 * r.a13 + self.a11 * r.a0 * r.a9 - self.a11 * r.a2 * r.a4 + self.a11 * r.a3 * r.a14 - self.a11 * r.a8 * r.a10 - self.a12 * r.a0 * r.a8 - self.a12 * r.a2 * r.a3 - self.a12 * r.a4 * r.a14 - self.a12 * r.a9 * r.a10 + self.a13 * r.a0.powi(2) + self.a13 * r.a3.powi(2) + self.a13 * r.a4.powi(2) - self.a13 * r.a10.powi(2) + self.a14 * r.a0 * r.a5 - self.a14 * r.a1 * r.a2 - self.a14 * r.a3 * r.a11 + self.a14 * r.a4 * r.a12 + self.a14 * r.a6 * r.a8 - self.a14 * r.a7 * r.a9 - 2. * self.a14 * r.a10 * r.a15 - self.a14 * r.a13 * r.a14 - 2. * self.a15 * r.a0 * r.a2 + 2. * self.a15 * r.a10 * r.a14,
            a14: r.a0 * (self.a0 * r.a14 + self.a14 * r.a0) + r.a2 * (self.a0 * r.a10 + self.a2 * r.a14 + self.a10 * r.a0 + self.a14 * r.a2) + r.a3 * (self.a0 * r.a9 + self.a3 * r.a14 + self.a9 * r.a0 + self.a14 * r.a3) + r.a4 * (self.a0 * r.a8 + self.a4 * r.a14 + self.a8 * r.a0 + self.a14 * r.a4) + r.a8 * (self.a0 * r.a4 - self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3 - self.a14 * r.a8) + r.a9 * (self.a0 * r.a3 + self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4 - self.a14 * r.a9) + r.a10 * (self.a0 * r.a2 + self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14 - self.a14 * r.a10) + r.a14 * (self.a0 * r.a0 + self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10 - self.a14 * r.a14),
            a15: 2. * self.a0 * r.a0 * r.a15 + 2. * self.a0 * r.a5 * r.a10 + 2. * self.a0 * r.a6 * r.a9 + 2. * self.a0 * r.a7 * r.a8 + self.a1 * r.a0 * r.a14 + self.a2 * r.a0 * r.a13 + self.a3 * r.a0 * r.a12 + self.a4 * r.a0 * r.a11 + self.a5 * r.a0 * r.a10 + self.a5 * r.a2 * r.a14 + self.a6 * r.a0 * r.a9 + self.a6 * r.a3 * r.a14 + self.a7 * r.a0 * r.a8 + self.a7 * r.a4 * r.a14 + self.a8 * r.a0 * r.a7 - self.a8 * r.a2 * r.a12 + self.a8 * r.a3 * r.a13 - 2. * self.a8 * r.a8 * r.a15 + self.a9 * r.a0 * r.a6 + self.a9 * r.a2 * r.a11 - self.a9 * r.a4 * r.a13 - 2. * self.a9 * r.a9 * r.a15 + self.a10 * r.a0 * r.a5 - self.a10 * r.a3 * r.a11 + self.a10 * r.a4 * r.a12 - 2. * self.a10 * r.a10 * r.a15 - self.a11 * r.a0 * r.a4 + self.a11 * r.a2 * r.a9 - self.a11 * r.a3 * r.a10 + self.a11 * r.a8 * r.a14 - self.a12 * r.a0 * r.a3 - self.a12 * r.a2 * r.a8 + self.a12 * r.a4 * r.a10 + self.a12 * r.a9 * r.a14 - self.a13 * r.a0 * r.a2 + self.a13 * r.a3 * r.a8 - self.a13 * r.a4 * r.a9 + self.a13 * r.a10 * r.a14 - self.a14 * r.a0 * r.a1 + self.a14 * r.a2 * r.a5 + self.a14 * r.a3 * r.a6 + self.a14 * r.a4 * r.a7 - self.a14 * r.a8 * r.a11 - self.a14 * r.a9 * r.a12 - self.a14 * r.a10 * r.a13 + self.a15 * r.a0.powi(2) + self.a15 * r.a2.powi(2) + self.a15 * r.a3.powi(2) + self.a15 * r.a4.powi(2) - self.a15 * r.a8.powi(2) - self.a15 * r.a9.powi(2) - self.a15 * r.a10.powi(2) - self.a15 * r.a14.powi(2),
        }
    }
}

impl Reflect<Float> for FullMultivector {
    fn reflect(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.powi(2),
            a1: self.a1 * r.powi(2),
            a2: self.a2 * r.powi(2),
            a3: self.a3 * r.powi(2),
            a4: self.a4 * r.powi(2),
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
            a11: self.a11 * r.powi(2),
            a12: self.a12 * r.powi(2),
            a13: self.a13 * r.powi(2),
            a14: self.a14 * r.powi(2),
            a15: self.a15 * r.powi(2),
        }
    }
}

impl Reflect<Vector> for FullMultivector {
    fn reflect(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a1: -self.a1 * r.a2.powi(2) - self.a1 * r.a3.powi(2) - self.a1 * r.a4.powi(2) + 2. * self.a2 * r.a1 * r.a2 + 2. * self.a3 * r.a1 * r.a3 + 2. * self.a4 * r.a1 * r.a4,
            a2: self.a2 * r.a2.powi(2) - self.a2 * r.a3.powi(2) - self.a2 * r.a4.powi(2) + 2. * self.a3 * r.a2 * r.a3 + 2. * self.a4 * r.a2 * r.a4,
            a3: 2. * self.a2 * r.a2 * r.a3 - self.a3 * r.a2.powi(2) + self.a3 * r.a3.powi(2) - self.a3 * r.a4.powi(2) + 2. * self.a4 * r.a3 * r.a4,
            a4: 2. * self.a2 * r.a2 * r.a4 + 2. * self.a3 * r.a3 * r.a4 - self.a4 * r.a2.powi(2) - self.a4 * r.a3.powi(2) + self.a4 * r.a4.powi(2),
            a5: -self.a5 * r.a2.powi(2) + self.a5 * r.a3.powi(2) + self.a5 * r.a4.powi(2) - 2. * self.a6 * r.a2 * r.a3 - 2. * self.a7 * r.a2 * r.a4 + 2. * self.a8 * r.a1 * r.a3 - 2. * self.a9 * r.a1 * r.a4,
            a6: -2. * self.a5 * r.a2 * r.a3 + self.a6 * r.a2.powi(2) - self.a6 * r.a3.powi(2) + self.a6 * r.a4.powi(2) - 2. * self.a7 * r.a3 * r.a4 - 2. * self.a8 * r.a1 * r.a2 + 2. * self.a10 * r.a1 * r.a4,
            a7: -2. * self.a5 * r.a2 * r.a4 - 2. * self.a6 * r.a3 * r.a4 + self.a7 * r.a2.powi(2) + self.a7 * r.a3.powi(2) - self.a7 * r.a4.powi(2) + 2. * self.a9 * r.a1 * r.a2 - 2. * self.a10 * r.a1 * r.a3,
            a8: -self.a8 * r.a2.powi(2) - self.a8 * r.a3.powi(2) + self.a8 * r.a4.powi(2) + 2. * self.a9 * r.a3 * r.a4 + 2. * self.a10 * r.a2 * r.a4,
            a9: 2. * self.a8 * r.a3 * r.a4 - self.a9 * r.a2.powi(2) + self.a9 * r.a3.powi(2) - self.a9 * r.a4.powi(2) + 2. * self.a10 * r.a2 * r.a3,
            a10: 2. * self.a8 * r.a2 * r.a4 + 2. * self.a9 * r.a2 * r.a3 + self.a10 * r.a2.powi(2) - self.a10 * r.a3.powi(2) - self.a10 * r.a4.powi(2),
            a11: self.a11 * r.a2.powi(2) + self.a11 * r.a3.powi(2) - self.a11 * r.a4.powi(2) - 2. * self.a12 * r.a3 * r.a4 - 2. * self.a13 * r.a2 * r.a4 - 2. * self.a14 * r.a1 * r.a4,
            a12: -2. * self.a11 * r.a3 * r.a4 + self.a12 * r.a2.powi(2) - self.a12 * r.a3.powi(2) + self.a12 * r.a4.powi(2) - 2. * self.a13 * r.a2 * r.a3 - 2. * self.a14 * r.a1 * r.a3,
            a13: -2. * self.a11 * r.a2 * r.a4 - 2. * self.a12 * r.a2 * r.a3 - self.a13 * r.a2.powi(2) + self.a13 * r.a3.powi(2) + self.a13 * r.a4.powi(2) - 2. * self.a14 * r.a1 * r.a2,
            a14: self.a14 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a15: self.a15 * (-r.a2.powi(2) - r.a3.powi(2) - r.a4.powi(2)),
        }
    }
}

impl Reflect<Bivector> for FullMultivector {
    fn reflect(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * (-r.a8.powi(2) - r.a9.powi(2) - r.a10.powi(2)),
            a1: -self.a1 * r.a8.powi(2) - self.a1 * r.a9.powi(2) - self.a1 * r.a10.powi(2) + 2. * self.a2 * r.a6 * r.a8 - 2. * self.a2 * r.a7 * r.a9 - 2. * self.a3 * r.a5 * r.a8 + 2. * self.a3 * r.a7 * r.a10 + 2. * self.a4 * r.a5 * r.a9 - 2. * self.a4 * r.a6 * r.a10,
            a2: self.a2 * r.a8.powi(2) + self.a2 * r.a9.powi(2) - self.a2 * r.a10.powi(2) - 2. * self.a3 * r.a9 * r.a10 - 2. * self.a4 * r.a8 * r.a10,
            a3: -2. * self.a2 * r.a9 * r.a10 + self.a3 * r.a8.powi(2) - self.a3 * r.a9.powi(2) + self.a3 * r.a10.powi(2) - 2. * self.a4 * r.a8 * r.a9,
            a4: -2. * self.a2 * r.a8 * r.a10 - 2. * self.a3 * r.a8 * r.a9 - self.a4 * r.a8.powi(2) + self.a4 * r.a9.powi(2) + self.a4 * r.a10.powi(2),
            a5: self.a5 * r.a8.powi(2) + self.a5 * r.a9.powi(2) - self.a5 * r.a10.powi(2) - 2. * self.a6 * r.a9 * r.a10 - 2. * self.a7 * r.a8 * r.a10 - 2. * self.a8 * r.a5 * r.a8 - 2. * self.a8 * r.a7 * r.a10 - 2. * self.a9 * r.a5 * r.a9 - 2. * self.a9 * r.a6 * r.a10 - 2. * self.a10 * r.a5 * r.a10 + 2. * self.a10 * r.a6 * r.a9 + 2. * self.a10 * r.a7 * r.a8,
            a6: -2. * self.a5 * r.a9 * r.a10 + self.a6 * r.a8.powi(2) - self.a6 * r.a9.powi(2) + self.a6 * r.a10.powi(2) - 2. * self.a7 * r.a8 * r.a9 - 2. * self.a8 * r.a6 * r.a8 - 2. * self.a8 * r.a7 * r.a9 + 2. * self.a9 * r.a5 * r.a10 - 2. * self.a9 * r.a6 * r.a9 + 2. * self.a9 * r.a7 * r.a8 - 2. * self.a10 * r.a5 * r.a9 - 2. * self.a10 * r.a6 * r.a10,
            a7: -2. * self.a5 * r.a8 * r.a10 - 2. * self.a6 * r.a8 * r.a9 - self.a7 * r.a8.powi(2) + self.a7 * r.a9.powi(2) + self.a7 * r.a10.powi(2) + 2. * self.a8 * r.a5 * r.a10 + 2. * self.a8 * r.a6 * r.a9 - 2. * self.a8 * r.a7 * r.a8 - 2. * self.a9 * r.a6 * r.a8 - 2. * self.a9 * r.a7 * r.a9 - 2. * self.a10 * r.a5 * r.a8 - 2. * self.a10 * r.a7 * r.a10,
            a8: -self.a8 * r.a8.powi(2) + self.a8 * r.a9.powi(2) + self.a8 * r.a10.powi(2) - 2. * self.a9 * r.a8 * r.a9 - 2. * self.a10 * r.a8 * r.a10,
            a9: -2. * self.a8 * r.a8 * r.a9 + self.a9 * r.a8.powi(2) - self.a9 * r.a9.powi(2) + self.a9 * r.a10.powi(2) - 2. * self.a10 * r.a9 * r.a10,
            a10: -2. * self.a8 * r.a8 * r.a10 - 2. * self.a9 * r.a9 * r.a10 + self.a10 * r.a8.powi(2) + self.a10 * r.a9.powi(2) - self.a10 * r.a10.powi(2),
            a11: -self.a11 * r.a8.powi(2) + self.a11 * r.a9.powi(2) + self.a11 * r.a10.powi(2) - 2. * self.a12 * r.a8 * r.a9 - 2. * self.a13 * r.a8 * r.a10 + 2. * self.a14 * r.a5 * r.a9 - 2. * self.a14 * r.a6 * r.a10,
            a12: -2. * self.a11 * r.a8 * r.a9 + self.a12 * r.a8.powi(2) - self.a12 * r.a9.powi(2) + self.a12 * r.a10.powi(2) - 2. * self.a13 * r.a9 * r.a10 - 2. * self.a14 * r.a5 * r.a8 + 2. * self.a14 * r.a7 * r.a10,
            a13: -2. * self.a11 * r.a8 * r.a10 - 2. * self.a12 * r.a9 * r.a10 + self.a13 * r.a8.powi(2) + self.a13 * r.a9.powi(2) - self.a13 * r.a10.powi(2) + 2. * self.a14 * r.a6 * r.a8 - 2. * self.a14 * r.a7 * r.a9,
            a14: self.a14 * (-r.a8.powi(2) - r.a9.powi(2) - r.a10.powi(2)),
            a15: 2. * self.a0 * r.a5 * r.a10 + 2. * self.a0 * r.a6 * r.a9 + 2. * self.a0 * r.a7 * r.a8 - self.a15 * r.a8.powi(2) - self.a15 * r.a9.powi(2) - self.a15 * r.a10.powi(2),
        }
    }
}

impl Reflect<Trivector> for FullMultivector {
    fn reflect(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a0 * r.a14.powi(2),
            a1: r.a14 * (self.a1 * r.a14 + 2. * self.a2 * r.a13 + 2. * self.a3 * r.a12 + 2. * self.a4 * r.a11),
            a2: -self.a2 * r.a14.powi(2),
            a3: -self.a3 * r.a14.powi(2),
            a4: -self.a4 * r.a14.powi(2),
            a5: r.a14 * (self.a5 * r.a14 - 2. * self.a8 * r.a12 + 2. * self.a9 * r.a11),
            a6: r.a14 * (self.a6 * r.a14 + 2. * self.a8 * r.a13 - 2. * self.a10 * r.a11),
            a7: r.a14 * (self.a7 * r.a14 - 2. * self.a9 * r.a13 + 2. * self.a10 * r.a12),
            a8: -self.a8 * r.a14.powi(2),
            a9: -self.a9 * r.a14.powi(2),
            a10: -self.a10 * r.a14.powi(2),
            a11: r.a14 * (self.a11 * r.a14 - 2. * self.a14 * r.a11),
            a12: r.a14 * (self.a12 * r.a14 - 2. * self.a14 * r.a12),
            a13: r.a14 * (self.a13 * r.a14 - 2. * self.a14 * r.a13),
            a14: -self.a14 * r.a14.powi(2),
            a15: self.a15 * r.a14.powi(2),
        }
    }
}

impl Reflect<Pseudoscalar> for FullMultivector {
    fn reflect(self, _r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Reflect<ScalarAndBivector> for FullMultivector {
    fn reflect(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0.powi(2) - self.a0 * r.a8.powi(2) - self.a0 * r.a9.powi(2) - self.a0 * r.a10.powi(2) - 2. * self.a8 * r.a0 * r.a8 - 2. * self.a9 * r.a0 * r.a9 - 2. * self.a10 * r.a0 * r.a10,
            a1: self.a1 * r.a0.powi(2) - self.a1 * r.a8.powi(2) - self.a1 * r.a9.powi(2) - self.a1 * r.a10.powi(2) + 2. * self.a2 * r.a6 * r.a8 - 2. * self.a2 * r.a7 * r.a9 - 2. * self.a3 * r.a5 * r.a8 + 2. * self.a3 * r.a7 * r.a10 + 2. * self.a4 * r.a5 * r.a9 - 2. * self.a4 * r.a6 * r.a10 + 2. * self.a11 * r.a0 * r.a8 + 2. * self.a12 * r.a0 * r.a9 + 2. * self.a13 * r.a0 * r.a10,
            a2: self.a2 * r.a0.powi(2) + self.a2 * r.a8.powi(2) + self.a2 * r.a9.powi(2) - self.a2 * r.a10.powi(2) - 2. * self.a3 * r.a9 * r.a10 - 2. * self.a4 * r.a8 * r.a10 - 2. * self.a14 * r.a0 * r.a10,
            a3: -2. * self.a2 * r.a9 * r.a10 + self.a3 * r.a0.powi(2) + self.a3 * r.a8.powi(2) - self.a3 * r.a9.powi(2) + self.a3 * r.a10.powi(2) - 2. * self.a4 * r.a8 * r.a9 - 2. * self.a14 * r.a0 * r.a9,
            a4: -2. * self.a2 * r.a8 * r.a10 - 2. * self.a3 * r.a8 * r.a9 + self.a4 * r.a0.powi(2) - self.a4 * r.a8.powi(2) + self.a4 * r.a9.powi(2) + self.a4 * r.a10.powi(2) - 2. * self.a14 * r.a0 * r.a8,
            a5: 2. * self.a0 * r.a0 * r.a5 + self.a5 * r.a0.powi(2) + self.a5 * r.a8.powi(2) + self.a5 * r.a9.powi(2) - self.a5 * r.a10.powi(2) - 2. * self.a6 * r.a9 * r.a10 - 2. * self.a7 * r.a8 * r.a10 - 2. * self.a8 * r.a5 * r.a8 - 2. * self.a8 * r.a7 * r.a10 - 2. * self.a9 * r.a5 * r.a9 - 2. * self.a9 * r.a6 * r.a10 - 2. * self.a10 * r.a5 * r.a10 + 2. * self.a10 * r.a6 * r.a9 + 2. * self.a10 * r.a7 * r.a8 - 2. * self.a15 * r.a0 * r.a10,
            a6: 2. * self.a0 * r.a0 * r.a6 - 2. * self.a5 * r.a9 * r.a10 + self.a6 * r.a0.powi(2) + self.a6 * r.a8.powi(2) - self.a6 * r.a9.powi(2) + self.a6 * r.a10.powi(2) - 2. * self.a7 * r.a8 * r.a9 - 2. * self.a8 * r.a6 * r.a8 - 2. * self.a8 * r.a7 * r.a9 + 2. * self.a9 * r.a5 * r.a10 - 2. * self.a9 * r.a6 * r.a9 + 2. * self.a9 * r.a7 * r.a8 - 2. * self.a10 * r.a5 * r.a9 - 2. * self.a10 * r.a6 * r.a10 - 2. * self.a15 * r.a0 * r.a9,
            a7: 2. * self.a0 * r.a0 * r.a7 - 2. * self.a5 * r.a8 * r.a10 - 2. * self.a6 * r.a8 * r.a9 + self.a7 * r.a0.powi(2) - self.a7 * r.a8.powi(2) + self.a7 * r.a9.powi(2) + self.a7 * r.a10.powi(2) + 2. * self.a8 * r.a5 * r.a10 + 2. * self.a8 * r.a6 * r.a9 - 2. * self.a8 * r.a7 * r.a8 - 2. * self.a9 * r.a6 * r.a8 - 2. * self.a9 * r.a7 * r.a9 - 2. * self.a10 * r.a5 * r.a8 - 2. * self.a10 * r.a7 * r.a10 - 2. * self.a15 * r.a0 * r.a8,
            a8: 2. * self.a0 * r.a0 * r.a8 + self.a8 * r.a0.powi(2) - self.a8 * r.a8.powi(2) + self.a8 * r.a9.powi(2) + self.a8 * r.a10.powi(2) - 2. * self.a9 * r.a8 * r.a9 - 2. * self.a10 * r.a8 * r.a10,
            a9: 2. * self.a0 * r.a0 * r.a9 - 2. * self.a8 * r.a8 * r.a9 + self.a9 * r.a0.powi(2) + self.a9 * r.a8.powi(2) - self.a9 * r.a9.powi(2) + self.a9 * r.a10.powi(2) - 2. * self.a10 * r.a9 * r.a10,
            a10: 2. * self.a0 * r.a0 * r.a10 - 2. * self.a8 * r.a8 * r.a10 - 2. * self.a9 * r.a9 * r.a10 + self.a10 * r.a0.powi(2) + self.a10 * r.a8.powi(2) + self.a10 * r.a9.powi(2) - self.a10 * r.a10.powi(2),
            a11: -2. * self.a1 * r.a0 * r.a8 + 2. * self.a2 * r.a0 * r.a6 - 2. * self.a3 * r.a0 * r.a5 + self.a11 * r.a0.powi(2) - self.a11 * r.a8.powi(2) + self.a11 * r.a9.powi(2) + self.a11 * r.a10.powi(2) - 2. * self.a12 * r.a8 * r.a9 - 2. * self.a13 * r.a8 * r.a10 + 2. * self.a14 * r.a5 * r.a9 - 2. * self.a14 * r.a6 * r.a10,
            a12: -2. * self.a1 * r.a0 * r.a9 - 2. * self.a2 * r.a0 * r.a7 + 2. * self.a4 * r.a0 * r.a5 - 2. * self.a11 * r.a8 * r.a9 + self.a12 * r.a0.powi(2) + self.a12 * r.a8.powi(2) - self.a12 * r.a9.powi(2) + self.a12 * r.a10.powi(2) - 2. * self.a13 * r.a9 * r.a10 - 2. * self.a14 * r.a5 * r.a8 + 2. * self.a14 * r.a7 * r.a10,
            a13: -2. * self.a1 * r.a0 * r.a10 + 2. * self.a3 * r.a0 * r.a7 - 2. * self.a4 * r.a0 * r.a6 - 2. * self.a11 * r.a8 * r.a10 - 2. * self.a12 * r.a9 * r.a10 + self.a13 * r.a0.powi(2) + self.a13 * r.a8.powi(2) + self.a13 * r.a9.powi(2) - self.a13 * r.a10.powi(2) + 2. * self.a14 * r.a6 * r.a8 - 2. * self.a14 * r.a7 * r.a9,
            a14: 2. * self.a2 * r.a0 * r.a10 + 2. * self.a3 * r.a0 * r.a9 + 2. * self.a4 * r.a0 * r.a8 + self.a14 * r.a0.powi(2) - self.a14 * r.a8.powi(2) - self.a14 * r.a9.powi(2) - self.a14 * r.a10.powi(2),
            a15: 2. * self.a0 * r.a5 * r.a10 + 2. * self.a0 * r.a6 * r.a9 + 2. * self.a0 * r.a7 * r.a8 + 2. * self.a5 * r.a0 * r.a10 + 2. * self.a6 * r.a0 * r.a9 + 2. * self.a7 * r.a0 * r.a8 + 2. * self.a8 * r.a0 * r.a7 + 2. * self.a9 * r.a0 * r.a6 + 2. * self.a10 * r.a0 * r.a5 + self.a15 * r.a0.powi(2) - self.a15 * r.a8.powi(2) - self.a15 * r.a9.powi(2) - self.a15 * r.a10.powi(2),
        }
    }
}

impl Reflect<FullMultivector> for FullMultivector {
    fn reflect(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0.powi(2) + self.a0 * r.a2.powi(2) + self.a0 * r.a3.powi(2) + self.a0 * r.a4.powi(2) - self.a0 * r.a8.powi(2) - self.a0 * r.a9.powi(2) - self.a0 * r.a10.powi(2) - self.a0 * r.a14.powi(2) + 2. * self.a2 * r.a0 * r.a2 - 2. * self.a2 * r.a10 * r.a14 + 2. * self.a3 * r.a0 * r.a3 - 2. * self.a3 * r.a9 * r.a14 + 2. * self.a4 * r.a0 * r.a4 - 2. * self.a4 * r.a8 * r.a14 - 2. * self.a8 * r.a0 * r.a8 - 2. * self.a8 * r.a4 * r.a14 - 2. * self.a9 * r.a0 * r.a9 - 2. * self.a9 * r.a3 * r.a14 - 2. * self.a10 * r.a0 * r.a10 - 2. * self.a10 * r.a2 * r.a14 - 2. * self.a14 * r.a0 * r.a14 - 2. * self.a14 * r.a2 * r.a10 - 2. * self.a14 * r.a3 * r.a9 - 2. * self.a14 * r.a4 * r.a8,
            a1: 2. * self.a0 * r.a0 * r.a1 + 2. * self.a0 * r.a8 * r.a11 + 2. * self.a0 * r.a9 * r.a12 + 2. * self.a0 * r.a10 * r.a13 + self.a1 * r.a0.powi(2) - self.a1 * r.a2.powi(2) - self.a1 * r.a3.powi(2) - self.a1 * r.a4.powi(2) - self.a1 * r.a8.powi(2) - self.a1 * r.a9.powi(2) - self.a1 * r.a10.powi(2) + self.a1 * r.a14.powi(2) + 2. * self.a2 * r.a1 * r.a2 + 2. * self.a2 * r.a6 * r.a8 - 2. * self.a2 * r.a7 * r.a9 + 2. * self.a2 * r.a13 * r.a14 + 2. * self.a3 * r.a1 * r.a3 - 2. * self.a3 * r.a5 * r.a8 + 2. * self.a3 * r.a7 * r.a10 + 2. * self.a3 * r.a12 * r.a14 + 2. * self.a4 * r.a1 * r.a4 + 2. * self.a4 * r.a5 * r.a9 - 2. * self.a4 * r.a6 * r.a10 + 2. * self.a4 * r.a11 * r.a14 - 2. * self.a5 * r.a3 * r.a8 + 2. * self.a5 * r.a4 * r.a9 + 2. * self.a6 * r.a2 * r.a8 - 2. * self.a6 * r.a4 * r.a10 - 2. * self.a7 * r.a2 * r.a9 + 2. * self.a7 * r.a3 * r.a10 + 2. * self.a8 * r.a0 * r.a11 - 2. * self.a8 * r.a1 * r.a8 - 2. * self.a8 * r.a2 * r.a6 + 2. * self.a8 * r.a3 * r.a5 + 2. * self.a9 * r.a0 * r.a12 - 2. * self.a9 * r.a1 * r.a9 + 2. * self.a9 * r.a2 * r.a7 - 2. * self.a9 * r.a4 * r.a5 + 2. * self.a10 * r.a0 * r.a13 - 2. * self.a10 * r.a1 * r.a10 - 2. * self.a10 * r.a3 * r.a7 + 2. * self.a10 * r.a4 * r.a6 + 2. * self.a11 * r.a0 * r.a8 - 2. * self.a11 * r.a4 * r.a14 + 2. * self.a12 * r.a0 * r.a9 - 2. * self.a12 * r.a3 * r.a14 + 2. * self.a13 * r.a0 * r.a10 - 2. * self.a13 * r.a2 * r.a14 - 2. * self.a14 * r.a1 * r.a14 + 2. * self.a14 * r.a2 * r.a13 + 2. * self.a14 * r.a3 * r.a12 + 2. * self.a14 * r.a4 * r.a11,
            a2: 2. * self.a0 * r.a0 * r.a2 - 2. * self.a0 * r.a10 * r.a14 + self.a2 * r.a0.powi(2) + self.a2 * r.a2.powi(2) - self.a2 * r.a3.powi(2) - self.a2 * r.a4.powi(2) + self.a2 * r.a8.powi(2) + self.a2 * r.a9.powi(2) - self.a2 * r.a10.powi(2) - self.a2 * r.a14.powi(2) + 2. * self.a3 * r.a2 * r.a3 - 2. * self.a3 * r.a9 * r.a10 + 2. * self.a4 * r.a2 * r.a4 - 2. * self.a4 * r.a8 * r.a10 - 2. * self.a8 * r.a2 * r.a8 - 2. * self.a8 * r.a4 * r.a10 - 2. * self.a9 * r.a2 * r.a9 - 2. * self.a9 * r.a3 * r.a10 - 2. * self.a10 * r.a0 * r.a14 - 2. * self.a10 * r.a2 * r.a10 + 2. * self.a10 * r.a3 * r.a9 + 2. * self.a10 * r.a4 * r.a8 - 2. * self.a14 * r.a0 * r.a10 - 2. * self.a14 * r.a2 * r.a14,
            a3: 2. * self.a0 * r.a0 * r.a3 - 2. * self.a0 * r.a9 * r.a14 + 2. * self.a2 * r.a2 * r.a3 - 2. * self.a2 * r.a9 * r.a10 + self.a3 * r.a0.powi(2) - self.a3 * r.a2.powi(2) + self.a3 * r.a3.powi(2) - self.a3 * r.a4.powi(2) + self.a3 * r.a8.powi(2) - self.a3 * r.a9.powi(2) + self.a3 * r.a10.powi(2) - self.a3 * r.a14.powi(2) + 2. * self.a4 * r.a3 * r.a4 - 2. * self.a4 * r.a8 * r.a9 - 2. * self.a8 * r.a3 * r.a8 - 2. * self.a8 * r.a4 * r.a9 - 2. * self.a9 * r.a0 * r.a14 + 2. * self.a9 * r.a2 * r.a10 - 2. * self.a9 * r.a3 * r.a9 + 2. * self.a9 * r.a4 * r.a8 - 2. * self.a10 * r.a2 * r.a9 - 2. * self.a10 * r.a3 * r.a10 - 2. * self.a14 * r.a0 * r.a9 - 2. * self.a14 * r.a3 * r.a14,
            a4: 2. * self.a0 * r.a0 * r.a4 - 2. * self.a0 * r.a8 * r.a14 + 2. * self.a2 * r.a2 * r.a4 - 2. * self.a2 * r.a8 * r.a10 + 2. * self.a3 * r.a3 * r.a4 - 2. * self.a3 * r.a8 * r.a9 + self.a4 * r.a0.powi(2) - self.a4 * r.a2.powi(2) - self.a4 * r.a3.powi(2) + self.a4 * r.a4.powi(2) - self.a4 * r.a8.powi(2) + self.a4 * r.a9.powi(2) + self.a4 * r.a10.powi(2) - self.a4 * r.a14.powi(2) - 2. * self.a8 * r.a0 * r.a14 + 2. * self.a8 * r.a2 * r.a10 + 2. * self.a8 * r.a3 * r.a9 - 2. * self.a8 * r.a4 * r.a8 - 2. * self.a9 * r.a3 * r.a8 - 2. * self.a9 * r.a4 * r.a9 - 2. * self.a10 * r.a2 * r.a8 - 2. * self.a10 * r.a4 * r.a10 - 2. * self.a14 * r.a0 * r.a8 - 2. * self.a14 * r.a4 * r.a14,
            a5: 2. * self.a0 * r.a0 * r.a5 - 2. * self.a0 * r.a3 * r.a11 + 2. * self.a0 * r.a4 * r.a12 - 2. * self.a0 * r.a10 * r.a15 + 2. * self.a1 * r.a3 * r.a8 - 2. * self.a1 * r.a4 * r.a9 + 2. * self.a2 * r.a2 * r.a5 - 2. * self.a2 * r.a3 * r.a6 - 2. * self.a2 * r.a4 * r.a7 - 2. * self.a2 * r.a14 * r.a15 - 2. * self.a3 * r.a0 * r.a11 - 2. * self.a3 * r.a1 * r.a8 + 2. * self.a3 * r.a2 * r.a6 + 2. * self.a3 * r.a3 * r.a5 + 2. * self.a4 * r.a0 * r.a12 + 2. * self.a4 * r.a1 * r.a9 + 2. * self.a4 * r.a2 * r.a7 + 2. * self.a4 * r.a4 * r.a5 + self.a5 * r.a0.powi(2) - self.a5 * r.a2.powi(2) + self.a5 * r.a3.powi(2) + self.a5 * r.a4.powi(2) + self.a5 * r.a8.powi(2) + self.a5 * r.a9.powi(2) - self.a5 * r.a10.powi(2) + self.a5 * r.a14.powi(2) - 2. * self.a6 * r.a2 * r.a3 - 2. * self.a6 * r.a9 * r.a10 - 2. * self.a7 * r.a2 * r.a4 - 2. * self.a7 * r.a8 * r.a10 + 2. * self.a8 * r.a1 * r.a3 - 2. * self.a8 * r.a5 * r.a8 - 2. * self.a8 * r.a7 * r.a10 - 2. * self.a8 * r.a12 * r.a14 - 2. * self.a9 * r.a1 * r.a4 - 2. * self.a9 * r.a5 * r.a9 - 2. * self.a9 * r.a6 * r.a10 + 2. * self.a9 * r.a11 * r.a14 - 2. * self.a10 * r.a0 * r.a15 - 2. * self.a10 * r.a5 * r.a10 + 2. * self.a10 * r.a6 * r.a9 + 2. * self.a10 * r.a7 * r.a8 - 2. * self.a11 * r.a0 * r.a3 - 2. * self.a11 * r.a9 * r.a14 + 2. * self.a12 * r.a0 * r.a4 + 2. * self.a12 * r.a8 * r.a14 - 2. * self.a14 * r.a2 * r.a15 - 2. * self.a14 * r.a5 * r.a14 - 2. * self.a14 * r.a8 * r.a12 + 2. * self.a14 * r.a9 * r.a11 - 2. * self.a15 * r.a0 * r.a10 + 2. * self.a15 * r.a2 * r.a14,
            a6: 2. * self.a0 * r.a0 * r.a6 + 2. * self.a0 * r.a2 * r.a11 - 2. * self.a0 * r.a4 * r.a13 - 2. * self.a0 * r.a9 * r.a15 - 2. * self.a1 * r.a2 * r.a8 + 2. * self.a1 * r.a4 * r.a10 + 2. * self.a2 * r.a0 * r.a11 + 2. * self.a2 * r.a1 * r.a8 + 2. * self.a2 * r.a2 * r.a6 + 2. * self.a2 * r.a3 * r.a5 - 2. * self.a3 * r.a2 * r.a5 + 2. * self.a3 * r.a3 * r.a6 - 2. * self.a3 * r.a4 * r.a7 - 2. * self.a3 * r.a14 * r.a15 - 2. * self.a4 * r.a0 * r.a13 - 2. * self.a4 * r.a1 * r.a10 + 2. * self.a4 * r.a3 * r.a7 + 2. * self.a4 * r.a4 * r.a6 - 2. * self.a5 * r.a2 * r.a3 - 2. * self.a5 * r.a9 * r.a10 + self.a6 * r.a0.powi(2) + self.a6 * r.a2.powi(2) - self.a6 * r.a3.powi(2) + self.a6 * r.a4.powi(2) + self.a6 * r.a8.powi(2) - self.a6 * r.a9.powi(2) + self.a6 * r.a10.powi(2) + self.a6 * r.a14.powi(2) - 2. * self.a7 * r.a3 * r.a4 - 2. * self.a7 * r.a8 * r.a9 - 2. * self.a8 * r.a1 * r.a2 - 2. * self.a8 * r.a6 * r.a8 - 2. * self.a8 * r.a7 * r.a9 + 2. * self.a8 * r.a13 * r.a14 - 2. * self.a9 * r.a0 * r.a15 + 2. * self.a9 * r.a5 * r.a10 - 2. * self.a9 * r.a6 * r.a9 + 2. * self.a9 * r.a7 * r.a8 + 2. * self.a10 * r.a1 * r.a4 - 2. * self.a10 * r.a5 * r.a9 - 2. * self.a10 * r.a6 * r.a10 - 2. * self.a10 * r.a11 * r.a14 + 2. * self.a11 * r.a0 * r.a2 + 2. * self.a11 * r.a10 * r.a14 - 2. * self.a13 * r.a0 * r.a4 - 2. * self.a13 * r.a8 * r.a14 - 2. * self.a14 * r.a3 * r.a15 - 2. * self.a14 * r.a6 * r.a14 + 2. * self.a14 * r.a8 * r.a13 - 2. * self.a14 * r.a10 * r.a11 - 2. * self.a15 * r.a0 * r.a9 + 2. * self.a15 * r.a3 * r.a14,
            a7: 2. * self.a0 * r.a0 * r.a7 - 2. * self.a0 * r.a2 * r.a12 + 2. * self.a0 * r.a3 * r.a13 - 2. * self.a0 * r.a8 * r.a15 + 2. * self.a1 * r.a2 * r.a9 - 2. * self.a1 * r.a3 * r.a10 - 2. * self.a2 * r.a0 * r.a12 - 2. * self.a2 * r.a1 * r.a9 + 2. * self.a2 * r.a2 * r.a7 + 2. * self.a2 * r.a4 * r.a5 + 2. * self.a3 * r.a0 * r.a13 + 2. * self.a3 * r.a1 * r.a10 + 2. * self.a3 * r.a3 * r.a7 + 2. * self.a3 * r.a4 * r.a6 - 2. * self.a4 * r.a2 * r.a5 - 2. * self.a4 * r.a3 * r.a6 + 2. * self.a4 * r.a4 * r.a7 - 2. * self.a4 * r.a14 * r.a15 - 2. * self.a5 * r.a2 * r.a4 - 2. * self.a5 * r.a8 * r.a10 - 2. * self.a6 * r.a3 * r.a4 - 2. * self.a6 * r.a8 * r.a9 + self.a7 * r.a0.powi(2) + self.a7 * r.a2.powi(2) + self.a7 * r.a3.powi(2) - self.a7 * r.a4.powi(2) - self.a7 * r.a8.powi(2) + self.a7 * r.a9.powi(2) + self.a7 * r.a10.powi(2) + self.a7 * r.a14.powi(2) - 2. * self.a8 * r.a0 * r.a15 + 2. * self.a8 * r.a5 * r.a10 + 2. * self.a8 * r.a6 * r.a9 - 2. * self.a8 * r.a7 * r.a8 + 2. * self.a9 * r.a1 * r.a2 - 2. * self.a9 * r.a6 * r.a8 - 2. * self.a9 * r.a7 * r.a9 - 2. * self.a9 * r.a13 * r.a14 - 2. * self.a10 * r.a1 * r.a3 - 2. * self.a10 * r.a5 * r.a8 - 2. * self.a10 * r.a7 * r.a10 + 2. * self.a10 * r.a12 * r.a14 - 2. * self.a12 * r.a0 * r.a2 - 2. * self.a12 * r.a10 * r.a14 + 2. * self.a13 * r.a0 * r.a3 + 2. * self.a13 * r.a9 * r.a14 - 2. * self.a14 * r.a4 * r.a15 - 2. * self.a14 * r.a7 * r.a14 - 2. * self.a14 * r.a9 * r.a13 + 2. * self.a14 * r.a10 * r.a12 - 2. * self.a15 * r.a0 * r.a8 + 2. * self.a15 * r.a4 * r.a14,
            a8: 2. * self.a0 * r.a0 * r.a8 + 2. * self.a0 * r.a4 * r.a14 + 2. * self.a2 * r.a2 * r.a8 + 2. * self.a2 * r.a4 * r.a10 + 2. * self.a3 * r.a3 * r.a8 + 2. * self.a3 * r.a4 * r.a9 + 2. * self.a4 * r.a0 * r.a14 - 2. * self.a4 * r.a2 * r.a10 - 2. * self.a4 * r.a3 * r.a9 + 2. * self.a4 * r.a4 * r.a8 + self.a8 * r.a0.powi(2) - self.a8 * r.a2.powi(2) - self.a8 * r.a3.powi(2) + self.a8 * r.a4.powi(2) - self.a8 * r.a8.powi(2) + self.a8 * r.a9.powi(2) + self.a8 * r.a10.powi(2) - self.a8 * r.a14.powi(2) + 2. * self.a9 * r.a3 * r.a4 - 2. * self.a9 * r.a8 * r.a9 + 2. * self.a10 * r.a2 * r.a4 - 2. * self.a10 * r.a8 * r.a10 + 2. * self.a14 * r.a0 * r.a4 - 2. * self.a14 * r.a8 * r.a14,
            a9: 2. * self.a0 * r.a0 * r.a9 + 2. * self.a0 * r.a3 * r.a14 + 2. * self.a2 * r.a2 * r.a9 + 2. * self.a2 * r.a3 * r.a10 + 2. * self.a3 * r.a0 * r.a14 - 2. * self.a3 * r.a2 * r.a10 + 2. * self.a3 * r.a3 * r.a9 - 2. * self.a3 * r.a4 * r.a8 + 2. * self.a4 * r.a3 * r.a8 + 2. * self.a4 * r.a4 * r.a9 + 2. * self.a8 * r.a3 * r.a4 - 2. * self.a8 * r.a8 * r.a9 + self.a9 * r.a0.powi(2) - self.a9 * r.a2.powi(2) + self.a9 * r.a3.powi(2) - self.a9 * r.a4.powi(2) + self.a9 * r.a8.powi(2) - self.a9 * r.a9.powi(2) + self.a9 * r.a10.powi(2) - self.a9 * r.a14.powi(2) + 2. * self.a10 * r.a2 * r.a3 - 2. * self.a10 * r.a9 * r.a10 + 2. * self.a14 * r.a0 * r.a3 - 2. * self.a14 * r.a9 * r.a14,
            a10: 2. * self.a0 * r.a0 * r.a10 + 2. * self.a0 * r.a2 * r.a14 + 2. * self.a2 * r.a0 * r.a14 + 2. * self.a2 * r.a2 * r.a10 - 2. * self.a2 * r.a3 * r.a9 - 2. * self.a2 * r.a4 * r.a8 + 2. * self.a3 * r.a2 * r.a9 + 2. * self.a3 * r.a3 * r.a10 + 2. * self.a4 * r.a2 * r.a8 + 2. * self.a4 * r.a4 * r.a10 + 2. * self.a8 * r.a2 * r.a4 - 2. * self.a8 * r.a8 * r.a10 + 2. * self.a9 * r.a2 * r.a3 - 2. * self.a9 * r.a9 * r.a10 + self.a10 * r.a0.powi(2) + self.a10 * r.a2.powi(2) - self.a10 * r.a3.powi(2) - self.a10 * r.a4.powi(2) + self.a10 * r.a8.powi(2) + self.a10 * r.a9.powi(2) - self.a10 * r.a10.powi(2) - self.a10 * r.a14.powi(2) + 2. * self.a14 * r.a0 * r.a2 - 2. * self.a14 * r.a10 * r.a14,
            a11: 2. * self.a0 * r.a0 * r.a11 - 2. * self.a0 * r.a1 * r.a8 + 2. * self.a0 * r.a2 * r.a6 - 2. * self.a0 * r.a3 * r.a5 - 2. * self.a1 * r.a0 * r.a8 + 2. * self.a1 * r.a4 * r.a14 + 2. * self.a2 * r.a0 * r.a6 + 2. * self.a2 * r.a2 * r.a11 + 2. * self.a2 * r.a4 * r.a13 + 2. * self.a2 * r.a9 * r.a15 - 2. * self.a3 * r.a0 * r.a5 + 2. * self.a3 * r.a3 * r.a11 + 2. * self.a3 * r.a4 * r.a12 - 2. * self.a3 * r.a10 * r.a15 - 2. * self.a4 * r.a1 * r.a14 - 2. * self.a4 * r.a2 * r.a13 - 2. * self.a4 * r.a3 * r.a12 + 2. * self.a4 * r.a4 * r.a11 - 2. * self.a5 * r.a0 * r.a3 - 2. * self.a5 * r.a9 * r.a14 + 2. * self.a6 * r.a0 * r.a2 + 2. * self.a6 * r.a10 * r.a14 - 2. * self.a8 * r.a0 * r.a1 - 2. * self.a8 * r.a8 * r.a11 + 2. * self.a8 * r.a9 * r.a12 + 2. * self.a8 * r.a10 * r.a13 - 2. * self.a9 * r.a2 * r.a15 + 2. * self.a9 * r.a5 * r.a14 - 2. * self.a9 * r.a8 * r.a12 - 2. * self.a9 * r.a9 * r.a11 + 2. * self.a10 * r.a3 * r.a15 - 2. * self.a10 * r.a6 * r.a14 - 2. * self.a10 * r.a8 * r.a13 - 2. * self.a10 * r.a10 * r.a11 + self.a11 * r.a0.powi(2) + self.a11 * r.a2.powi(2) + self.a11 * r.a3.powi(2) - self.a11 * r.a4.powi(2) - self.a11 * r.a8.powi(2) + self.a11 * r.a9.powi(2) + self.a11 * r.a10.powi(2) + self.a11 * r.a14.powi(2) - 2. * self.a12 * r.a3 * r.a4 - 2. * self.a12 * r.a8 * r.a9 - 2. * self.a13 * r.a2 * r.a4 - 2. * self.a13 * r.a8 * r.a10 - 2. * self.a14 * r.a1 * r.a4 + 2. * self.a14 * r.a5 * r.a9 - 2. * self.a14 * r.a6 * r.a10 - 2. * self.a14 * r.a11 * r.a14 - 2. * self.a15 * r.a2 * r.a9 + 2. * self.a15 * r.a3 * r.a10,
            a12: 2. * self.a0 * r.a0 * r.a12 - 2. * self.a0 * r.a1 * r.a9 - 2. * self.a0 * r.a2 * r.a7 + 2. * self.a0 * r.a4 * r.a5 - 2. * self.a1 * r.a0 * r.a9 + 2. * self.a1 * r.a3 * r.a14 - 2. * self.a2 * r.a0 * r.a7 + 2. * self.a2 * r.a2 * r.a12 + 2. * self.a2 * r.a3 * r.a13 - 2. * self.a2 * r.a8 * r.a15 - 2. * self.a3 * r.a1 * r.a14 - 2. * self.a3 * r.a2 * r.a13 + 2. * self.a3 * r.a3 * r.a12 - 2. * self.a3 * r.a4 * r.a11 + 2. * self.a4 * r.a0 * r.a5 + 2. * self.a4 * r.a3 * r.a11 + 2. * self.a4 * r.a4 * r.a12 + 2. * self.a4 * r.a10 * r.a15 + 2. * self.a5 * r.a0 * r.a4 + 2. * self.a5 * r.a8 * r.a14 - 2. * self.a7 * r.a0 * r.a2 - 2. * self.a7 * r.a10 * r.a14 + 2. * self.a8 * r.a2 * r.a15 - 2. * self.a8 * r.a5 * r.a14 - 2. * self.a8 * r.a8 * r.a12 - 2. * self.a8 * r.a9 * r.a11 - 2. * self.a9 * r.a0 * r.a1 + 2. * self.a9 * r.a8 * r.a11 - 2. * self.a9 * r.a9 * r.a12 + 2. * self.a9 * r.a10 * r.a13 - 2. * self.a10 * r.a4 * r.a15 + 2. * self.a10 * r.a7 * r.a14 - 2. * self.a10 * r.a9 * r.a13 - 2. * self.a10 * r.a10 * r.a12 - 2. * self.a11 * r.a3 * r.a4 - 2. * self.a11 * r.a8 * r.a9 + self.a12 * r.a0.powi(2) + self.a12 * r.a2.powi(2) - self.a12 * r.a3.powi(2) + self.a12 * r.a4.powi(2) + self.a12 * r.a8.powi(2) - self.a12 * r.a9.powi(2) + self.a12 * r.a10.powi(2) + self.a12 * r.a14.powi(2) - 2. * self.a13 * r.a2 * r.a3 - 2. * self.a13 * r.a9 * r.a10 - 2. * self.a14 * r.a1 * r.a3 - 2. * self.a14 * r.a5 * r.a8 + 2. * self.a14 * r.a7 * r.a10 - 2. * self.a14 * r.a12 * r.a14 + 2. * self.a15 * r.a2 * r.a8 - 2. * self.a15 * r.a4 * r.a10,
            a13: 2. * self.a0 * r.a0 * r.a13 - 2. * self.a0 * r.a1 * r.a10 + 2. * self.a0 * r.a3 * r.a7 - 2. * self.a0 * r.a4 * r.a6 - 2. * self.a1 * r.a0 * r.a10 + 2. * self.a1 * r.a2 * r.a14 - 2. * self.a2 * r.a1 * r.a14 + 2. * self.a2 * r.a2 * r.a13 - 2. * self.a2 * r.a3 * r.a12 - 2. * self.a2 * r.a4 * r.a11 + 2. * self.a3 * r.a0 * r.a7 + 2. * self.a3 * r.a2 * r.a12 + 2. * self.a3 * r.a3 * r.a13 + 2. * self.a3 * r.a8 * r.a15 - 2. * self.a4 * r.a0 * r.a6 + 2. * self.a4 * r.a2 * r.a11 + 2. * self.a4 * r.a4 * r.a13 - 2. * self.a4 * r.a9 * r.a15 - 2. * self.a6 * r.a0 * r.a4 - 2. * self.a6 * r.a8 * r.a14 + 2. * self.a7 * r.a0 * r.a3 + 2. * self.a7 * r.a9 * r.a14 - 2. * self.a8 * r.a3 * r.a15 + 2. * self.a8 * r.a6 * r.a14 - 2. * self.a8 * r.a8 * r.a13 - 2. * self.a8 * r.a10 * r.a11 + 2. * self.a9 * r.a4 * r.a15 - 2. * self.a9 * r.a7 * r.a14 - 2. * self.a9 * r.a9 * r.a13 - 2. * self.a9 * r.a10 * r.a12 - 2. * self.a10 * r.a0 * r.a1 + 2. * self.a10 * r.a8 * r.a11 + 2. * self.a10 * r.a9 * r.a12 - 2. * self.a10 * r.a10 * r.a13 - 2. * self.a11 * r.a2 * r.a4 - 2. * self.a11 * r.a8 * r.a10 - 2. * self.a12 * r.a2 * r.a3 - 2. * self.a12 * r.a9 * r.a10 + self.a13 * r.a0.powi(2) - self.a13 * r.a2.powi(2) + self.a13 * r.a3.powi(2) + self.a13 * r.a4.powi(2) + self.a13 * r.a8.powi(2) + self.a13 * r.a9.powi(2) - self.a13 * r.a10.powi(2) + self.a13 * r.a14.powi(2) - 2. * self.a14 * r.a1 * r.a2 + 2. * self.a14 * r.a6 * r.a8 - 2. * self.a14 * r.a7 * r.a9 - 2. * self.a14 * r.a13 * r.a14 - 2. * self.a15 * r.a3 * r.a8 + 2. * self.a15 * r.a4 * r.a9,
            a14: 2. * self.a0 * r.a0 * r.a14 + 2. * self.a0 * r.a2 * r.a10 + 2. * self.a0 * r.a3 * r.a9 + 2. * self.a0 * r.a4 * r.a8 + 2. * self.a2 * r.a0 * r.a10 + 2. * self.a2 * r.a2 * r.a14 + 2. * self.a3 * r.a0 * r.a9 + 2. * self.a3 * r.a3 * r.a14 + 2. * self.a4 * r.a0 * r.a8 + 2. * self.a4 * r.a4 * r.a14 + 2. * self.a8 * r.a0 * r.a4 - 2. * self.a8 * r.a8 * r.a14 + 2. * self.a9 * r.a0 * r.a3 - 2. * self.a9 * r.a9 * r.a14 + 2. * self.a10 * r.a0 * r.a2 - 2. * self.a10 * r.a10 * r.a14 + self.a14 * r.a0.powi(2) + self.a14 * r.a2.powi(2) + self.a14 * r.a3.powi(2) + self.a14 * r.a4.powi(2) - self.a14 * r.a8.powi(2) - self.a14 * r.a9.powi(2) - self.a14 * r.a10.powi(2) - self.a14 * r.a14.powi(2),
            a15: 2. * self.a0 * r.a0 * r.a15 + 2. * self.a0 * r.a5 * r.a10 + 2. * self.a0 * r.a6 * r.a9 + 2. * self.a0 * r.a7 * r.a8 + 2. * self.a2 * r.a2 * r.a15 + 2. * self.a2 * r.a5 * r.a14 - 2. * self.a2 * r.a8 * r.a12 + 2. * self.a2 * r.a9 * r.a11 + 2. * self.a3 * r.a3 * r.a15 + 2. * self.a3 * r.a6 * r.a14 + 2. * self.a3 * r.a8 * r.a13 - 2. * self.a3 * r.a10 * r.a11 + 2. * self.a4 * r.a4 * r.a15 + 2. * self.a4 * r.a7 * r.a14 - 2. * self.a4 * r.a9 * r.a13 + 2. * self.a4 * r.a10 * r.a12 + 2. * self.a5 * r.a0 * r.a10 - 2. * self.a5 * r.a2 * r.a14 + 2. * self.a6 * r.a0 * r.a9 - 2. * self.a6 * r.a3 * r.a14 + 2. * self.a7 * r.a0 * r.a8 - 2. * self.a7 * r.a4 * r.a14 + 2. * self.a8 * r.a0 * r.a7 + 2. * self.a8 * r.a2 * r.a12 - 2. * self.a8 * r.a3 * r.a13 - 2. * self.a8 * r.a8 * r.a15 + 2. * self.a9 * r.a0 * r.a6 - 2. * self.a9 * r.a2 * r.a11 + 2. * self.a9 * r.a4 * r.a13 - 2. * self.a9 * r.a9 * r.a15 + 2. * self.a10 * r.a0 * r.a5 + 2. * self.a10 * r.a3 * r.a11 - 2. * self.a10 * r.a4 * r.a12 - 2. * self.a10 * r.a10 * r.a15 + 2. * self.a11 * r.a2 * r.a9 - 2. * self.a11 * r.a3 * r.a10 - 2. * self.a12 * r.a2 * r.a8 + 2. * self.a12 * r.a4 * r.a10 + 2. * self.a13 * r.a3 * r.a8 - 2. * self.a13 * r.a4 * r.a9 + 2. * self.a14 * r.a2 * r.a5 + 2. * self.a14 * r.a3 * r.a6 + 2. * self.a14 * r.a4 * r.a7 - 2. * self.a14 * r.a14 * r.a15 + self.a15 * r.a0.powi(2) - self.a15 * r.a2.powi(2) - self.a15 * r.a3.powi(2) - self.a15 * r.a4.powi(2) - self.a15 * r.a8.powi(2) - self.a15 * r.a9.powi(2) - self.a15 * r.a10.powi(2) + self.a15 * r.a14.powi(2),
        }
    }
}

impl Transform<Float> for FullMultivector {
    fn transform(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.powi(2),
            a1: self.a1 * r.powi(2),
            a2: self.a2 * r.powi(2),
            a3: self.a3 * r.powi(2),
            a4: self.a4 * r.powi(2),
            a5: self.a5 * r.powi(2),
            a6: self.a6 * r.powi(2),
            a7: self.a7 * r.powi(2),
            a8: self.a8 * r.powi(2),
            a9: self.a9 * r.powi(2),
            a10: self.a10 * r.powi(2),
            a11: self.a11 * r.powi(2),
            a12: self.a12 * r.powi(2),
            a13: self.a13 * r.powi(2),
            a14: self.a14 * r.powi(2),
            a15: self.a15 * r.powi(2),
        }
    }
}

impl Transform<Vector> for FullMultivector {
    fn transform(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a1: -self.a1 * r.a2.powi(2) - self.a1 * r.a3.powi(2) - self.a1 * r.a4.powi(2) + 2. * self.a2 * r.a1 * r.a2 + 2. * self.a3 * r.a1 * r.a3 + 2. * self.a4 * r.a1 * r.a4,
            a2: self.a2 * r.a2.powi(2) - self.a2 * r.a3.powi(2) - self.a2 * r.a4.powi(2) + 2. * self.a3 * r.a2 * r.a3 + 2. * self.a4 * r.a2 * r.a4,
            a3: 2. * self.a2 * r.a2 * r.a3 - self.a3 * r.a2.powi(2) + self.a3 * r.a3.powi(2) - self.a3 * r.a4.powi(2) + 2. * self.a4 * r.a3 * r.a4,
            a4: 2. * self.a2 * r.a2 * r.a4 + 2. * self.a3 * r.a3 * r.a4 - self.a4 * r.a2.powi(2) - self.a4 * r.a3.powi(2) + self.a4 * r.a4.powi(2),
            a5: -self.a5 * r.a2.powi(2) + self.a5 * r.a3.powi(2) + self.a5 * r.a4.powi(2) - 2. * self.a6 * r.a2 * r.a3 - 2. * self.a7 * r.a2 * r.a4 + 2. * self.a8 * r.a1 * r.a3 - 2. * self.a9 * r.a1 * r.a4,
            a6: -2. * self.a5 * r.a2 * r.a3 + self.a6 * r.a2.powi(2) - self.a6 * r.a3.powi(2) + self.a6 * r.a4.powi(2) - 2. * self.a7 * r.a3 * r.a4 - 2. * self.a8 * r.a1 * r.a2 + 2. * self.a10 * r.a1 * r.a4,
            a7: -2. * self.a5 * r.a2 * r.a4 - 2. * self.a6 * r.a3 * r.a4 + self.a7 * r.a2.powi(2) + self.a7 * r.a3.powi(2) - self.a7 * r.a4.powi(2) + 2. * self.a9 * r.a1 * r.a2 - 2. * self.a10 * r.a1 * r.a3,
            a8: -self.a8 * r.a2.powi(2) - self.a8 * r.a3.powi(2) + self.a8 * r.a4.powi(2) + 2. * self.a9 * r.a3 * r.a4 + 2. * self.a10 * r.a2 * r.a4,
            a9: 2. * self.a8 * r.a3 * r.a4 - self.a9 * r.a2.powi(2) + self.a9 * r.a3.powi(2) - self.a9 * r.a4.powi(2) + 2. * self.a10 * r.a2 * r.a3,
            a10: 2. * self.a8 * r.a2 * r.a4 + 2. * self.a9 * r.a2 * r.a3 + self.a10 * r.a2.powi(2) - self.a10 * r.a3.powi(2) - self.a10 * r.a4.powi(2),
            a11: self.a11 * r.a2.powi(2) + self.a11 * r.a3.powi(2) - self.a11 * r.a4.powi(2) - 2. * self.a12 * r.a3 * r.a4 - 2. * self.a13 * r.a2 * r.a4 - 2. * self.a14 * r.a1 * r.a4,
            a12: -2. * self.a11 * r.a3 * r.a4 + self.a12 * r.a2.powi(2) - self.a12 * r.a3.powi(2) + self.a12 * r.a4.powi(2) - 2. * self.a13 * r.a2 * r.a3 - 2. * self.a14 * r.a1 * r.a3,
            a13: -2. * self.a11 * r.a2 * r.a4 - 2. * self.a12 * r.a2 * r.a3 - self.a13 * r.a2.powi(2) + self.a13 * r.a3.powi(2) + self.a13 * r.a4.powi(2) - 2. * self.a14 * r.a1 * r.a2,
            a14: self.a14 * (r.a2.powi(2) + r.a3.powi(2) + r.a4.powi(2)),
            a15: self.a15 * (-r.a2.powi(2) - r.a3.powi(2) - r.a4.powi(2)),
        }
    }
}

impl Transform<Bivector> for FullMultivector {
    fn transform(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * (r.a8.powi(2) + r.a9.powi(2) + r.a10.powi(2)),
            a1: self.a1 * r.a8.powi(2) + self.a1 * r.a9.powi(2) + self.a1 * r.a10.powi(2) - 2. * self.a2 * r.a6 * r.a8 + 2. * self.a2 * r.a7 * r.a9 + 2. * self.a3 * r.a5 * r.a8 - 2. * self.a3 * r.a7 * r.a10 - 2. * self.a4 * r.a5 * r.a9 + 2. * self.a4 * r.a6 * r.a10,
            a2: -self.a2 * r.a8.powi(2) - self.a2 * r.a9.powi(2) + self.a2 * r.a10.powi(2) + 2. * self.a3 * r.a9 * r.a10 + 2. * self.a4 * r.a8 * r.a10,
            a3: 2. * self.a2 * r.a9 * r.a10 - self.a3 * r.a8.powi(2) + self.a3 * r.a9.powi(2) - self.a3 * r.a10.powi(2) + 2. * self.a4 * r.a8 * r.a9,
            a4: 2. * self.a2 * r.a8 * r.a10 + 2. * self.a3 * r.a8 * r.a9 + self.a4 * r.a8.powi(2) - self.a4 * r.a9.powi(2) - self.a4 * r.a10.powi(2),
            a5: -self.a5 * r.a8.powi(2) - self.a5 * r.a9.powi(2) + self.a5 * r.a10.powi(2) + 2. * self.a6 * r.a9 * r.a10 + 2. * self.a7 * r.a8 * r.a10 + 2. * self.a8 * r.a5 * r.a8 + 2. * self.a8 * r.a7 * r.a10 + 2. * self.a9 * r.a5 * r.a9 + 2. * self.a9 * r.a6 * r.a10 + 2. * self.a10 * r.a5 * r.a10 - 2. * self.a10 * r.a6 * r.a9 - 2. * self.a10 * r.a7 * r.a8,
            a6: 2. * self.a5 * r.a9 * r.a10 - self.a6 * r.a8.powi(2) + self.a6 * r.a9.powi(2) - self.a6 * r.a10.powi(2) + 2. * self.a7 * r.a8 * r.a9 + 2. * self.a8 * r.a6 * r.a8 + 2. * self.a8 * r.a7 * r.a9 - 2. * self.a9 * r.a5 * r.a10 + 2. * self.a9 * r.a6 * r.a9 - 2. * self.a9 * r.a7 * r.a8 + 2. * self.a10 * r.a5 * r.a9 + 2. * self.a10 * r.a6 * r.a10,
            a7: 2. * self.a5 * r.a8 * r.a10 + 2. * self.a6 * r.a8 * r.a9 + self.a7 * r.a8.powi(2) - self.a7 * r.a9.powi(2) - self.a7 * r.a10.powi(2) - 2. * self.a8 * r.a5 * r.a10 - 2. * self.a8 * r.a6 * r.a9 + 2. * self.a8 * r.a7 * r.a8 + 2. * self.a9 * r.a6 * r.a8 + 2. * self.a9 * r.a7 * r.a9 + 2. * self.a10 * r.a5 * r.a8 + 2. * self.a10 * r.a7 * r.a10,
            a8: self.a8 * r.a8.powi(2) - self.a8 * r.a9.powi(2) - self.a8 * r.a10.powi(2) + 2. * self.a9 * r.a8 * r.a9 + 2. * self.a10 * r.a8 * r.a10,
            a9: 2. * self.a8 * r.a8 * r.a9 - self.a9 * r.a8.powi(2) + self.a9 * r.a9.powi(2) - self.a9 * r.a10.powi(2) + 2. * self.a10 * r.a9 * r.a10,
            a10: 2. * self.a8 * r.a8 * r.a10 + 2. * self.a9 * r.a9 * r.a10 - self.a10 * r.a8.powi(2) - self.a10 * r.a9.powi(2) + self.a10 * r.a10.powi(2),
            a11: self.a11 * r.a8.powi(2) - self.a11 * r.a9.powi(2) - self.a11 * r.a10.powi(2) + 2. * self.a12 * r.a8 * r.a9 + 2. * self.a13 * r.a8 * r.a10 - 2. * self.a14 * r.a5 * r.a9 + 2. * self.a14 * r.a6 * r.a10,
            a12: 2. * self.a11 * r.a8 * r.a9 - self.a12 * r.a8.powi(2) + self.a12 * r.a9.powi(2) - self.a12 * r.a10.powi(2) + 2. * self.a13 * r.a9 * r.a10 + 2. * self.a14 * r.a5 * r.a8 - 2. * self.a14 * r.a7 * r.a10,
            a13: 2. * self.a11 * r.a8 * r.a10 + 2. * self.a12 * r.a9 * r.a10 - self.a13 * r.a8.powi(2) - self.a13 * r.a9.powi(2) + self.a13 * r.a10.powi(2) - 2. * self.a14 * r.a6 * r.a8 + 2. * self.a14 * r.a7 * r.a9,
            a14: self.a14 * (r.a8.powi(2) + r.a9.powi(2) + r.a10.powi(2)),
            a15: -2. * self.a0 * r.a5 * r.a10 - 2. * self.a0 * r.a6 * r.a9 - 2. * self.a0 * r.a7 * r.a8 + self.a15 * r.a8.powi(2) + self.a15 * r.a9.powi(2) + self.a15 * r.a10.powi(2),
        }
    }
}

impl Transform<Trivector> for FullMultivector {
    fn transform(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a14.powi(2),
            a1: r.a14 * (-self.a1 * r.a14 - 2. * self.a2 * r.a13 - 2. * self.a3 * r.a12 - 2. * self.a4 * r.a11),
            a2: self.a2 * r.a14.powi(2),
            a3: self.a3 * r.a14.powi(2),
            a4: self.a4 * r.a14.powi(2),
            a5: r.a14 * (-self.a5 * r.a14 + 2. * self.a8 * r.a12 - 2. * self.a9 * r.a11),
            a6: r.a14 * (-self.a6 * r.a14 - 2. * self.a8 * r.a13 + 2. * self.a10 * r.a11),
            a7: r.a14 * (-self.a7 * r.a14 + 2. * self.a9 * r.a13 - 2. * self.a10 * r.a12),
            a8: self.a8 * r.a14.powi(2),
            a9: self.a9 * r.a14.powi(2),
            a10: self.a10 * r.a14.powi(2),
            a11: r.a14 * (-self.a11 * r.a14 + 2. * self.a14 * r.a11),
            a12: r.a14 * (-self.a12 * r.a14 + 2. * self.a14 * r.a12),
            a13: r.a14 * (-self.a13 * r.a14 + 2. * self.a14 * r.a13),
            a14: self.a14 * r.a14.powi(2),
            a15: -self.a15 * r.a14.powi(2),
        }
    }
}

impl Transform<Pseudoscalar> for FullMultivector {
    fn transform(self, _r: Pseudoscalar) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Transform<ScalarAndBivector> for FullMultivector {
    fn transform(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * (r.a0.powi(2) + r.a8.powi(2) + r.a9.powi(2) + r.a10.powi(2)),
            a1: self.a1 * r.a0.powi(2) + self.a1 * r.a8.powi(2) + self.a1 * r.a9.powi(2) + self.a1 * r.a10.powi(2) + 2. * self.a2 * r.a0 * r.a5 - 2. * self.a2 * r.a6 * r.a8 + 2. * self.a2 * r.a7 * r.a9 + 2. * self.a3 * r.a0 * r.a6 + 2. * self.a3 * r.a5 * r.a8 - 2. * self.a3 * r.a7 * r.a10 + 2. * self.a4 * r.a0 * r.a7 - 2. * self.a4 * r.a5 * r.a9 + 2. * self.a4 * r.a6 * r.a10,
            a2: self.a2 * r.a0.powi(2) - self.a2 * r.a8.powi(2) - self.a2 * r.a9.powi(2) + self.a2 * r.a10.powi(2) + 2. * self.a3 * r.a0 * r.a8 + 2. * self.a3 * r.a9 * r.a10 - 2. * self.a4 * r.a0 * r.a9 + 2. * self.a4 * r.a8 * r.a10,
            a3: -2. * self.a2 * r.a0 * r.a8 + 2. * self.a2 * r.a9 * r.a10 + self.a3 * r.a0.powi(2) - self.a3 * r.a8.powi(2) + self.a3 * r.a9.powi(2) - self.a3 * r.a10.powi(2) + 2. * self.a4 * r.a0 * r.a10 + 2. * self.a4 * r.a8 * r.a9,
            a4: 2. * self.a2 * r.a0 * r.a9 + 2. * self.a2 * r.a8 * r.a10 - 2. * self.a3 * r.a0 * r.a10 + 2. * self.a3 * r.a8 * r.a9 + self.a4 * r.a0.powi(2) + self.a4 * r.a8.powi(2) - self.a4 * r.a9.powi(2) - self.a4 * r.a10.powi(2),
            a5: self.a5 * r.a0.powi(2) - self.a5 * r.a8.powi(2) - self.a5 * r.a9.powi(2) + self.a5 * r.a10.powi(2) + 2. * self.a6 * r.a0 * r.a8 + 2. * self.a6 * r.a9 * r.a10 - 2. * self.a7 * r.a0 * r.a9 + 2. * self.a7 * r.a8 * r.a10 - 2. * self.a8 * r.a0 * r.a6 + 2. * self.a8 * r.a5 * r.a8 + 2. * self.a8 * r.a7 * r.a10 + 2. * self.a9 * r.a0 * r.a7 + 2. * self.a9 * r.a5 * r.a9 + 2. * self.a9 * r.a6 * r.a10 + 2. * self.a10 * r.a5 * r.a10 - 2. * self.a10 * r.a6 * r.a9 - 2. * self.a10 * r.a7 * r.a8,
            a6: -2. * self.a5 * r.a0 * r.a8 + 2. * self.a5 * r.a9 * r.a10 + self.a6 * r.a0.powi(2) - self.a6 * r.a8.powi(2) + self.a6 * r.a9.powi(2) - self.a6 * r.a10.powi(2) + 2. * self.a7 * r.a0 * r.a10 + 2. * self.a7 * r.a8 * r.a9 + 2. * self.a8 * r.a0 * r.a5 + 2. * self.a8 * r.a6 * r.a8 + 2. * self.a8 * r.a7 * r.a9 - 2. * self.a9 * r.a5 * r.a10 + 2. * self.a9 * r.a6 * r.a9 - 2. * self.a9 * r.a7 * r.a8 - 2. * self.a10 * r.a0 * r.a7 + 2. * self.a10 * r.a5 * r.a9 + 2. * self.a10 * r.a6 * r.a10,
            a7: 2. * self.a5 * r.a0 * r.a9 + 2. * self.a5 * r.a8 * r.a10 - 2. * self.a6 * r.a0 * r.a10 + 2. * self.a6 * r.a8 * r.a9 + self.a7 * r.a0.powi(2) + self.a7 * r.a8.powi(2) - self.a7 * r.a9.powi(2) - self.a7 * r.a10.powi(2) - 2. * self.a8 * r.a5 * r.a10 - 2. * self.a8 * r.a6 * r.a9 + 2. * self.a8 * r.a7 * r.a8 - 2. * self.a9 * r.a0 * r.a5 + 2. * self.a9 * r.a6 * r.a8 + 2. * self.a9 * r.a7 * r.a9 + 2. * self.a10 * r.a0 * r.a6 + 2. * self.a10 * r.a5 * r.a8 + 2. * self.a10 * r.a7 * r.a10,
            a8: self.a8 * r.a0.powi(2) + self.a8 * r.a8.powi(2) - self.a8 * r.a9.powi(2) - self.a8 * r.a10.powi(2) - 2. * self.a9 * r.a0 * r.a10 + 2. * self.a9 * r.a8 * r.a9 + 2. * self.a10 * r.a0 * r.a9 + 2. * self.a10 * r.a8 * r.a10,
            a9: 2. * self.a8 * r.a0 * r.a10 + 2. * self.a8 * r.a8 * r.a9 + self.a9 * r.a0.powi(2) - self.a9 * r.a8.powi(2) + self.a9 * r.a9.powi(2) - self.a9 * r.a10.powi(2) - 2. * self.a10 * r.a0 * r.a8 + 2. * self.a10 * r.a9 * r.a10,
            a10: -2. * self.a8 * r.a0 * r.a9 + 2. * self.a8 * r.a8 * r.a10 + 2. * self.a9 * r.a0 * r.a8 + 2. * self.a9 * r.a9 * r.a10 + self.a10 * r.a0.powi(2) - self.a10 * r.a8.powi(2) - self.a10 * r.a9.powi(2) + self.a10 * r.a10.powi(2),
            a11: self.a11 * r.a0.powi(2) + self.a11 * r.a8.powi(2) - self.a11 * r.a9.powi(2) - self.a11 * r.a10.powi(2) - 2. * self.a12 * r.a0 * r.a10 + 2. * self.a12 * r.a8 * r.a9 + 2. * self.a13 * r.a0 * r.a9 + 2. * self.a13 * r.a8 * r.a10 - 2. * self.a14 * r.a0 * r.a7 - 2. * self.a14 * r.a5 * r.a9 + 2. * self.a14 * r.a6 * r.a10,
            a12: 2. * self.a11 * r.a0 * r.a10 + 2. * self.a11 * r.a8 * r.a9 + self.a12 * r.a0.powi(2) - self.a12 * r.a8.powi(2) + self.a12 * r.a9.powi(2) - self.a12 * r.a10.powi(2) - 2. * self.a13 * r.a0 * r.a8 + 2. * self.a13 * r.a9 * r.a10 - 2. * self.a14 * r.a0 * r.a6 + 2. * self.a14 * r.a5 * r.a8 - 2. * self.a14 * r.a7 * r.a10,
            a13: -2. * self.a11 * r.a0 * r.a9 + 2. * self.a11 * r.a8 * r.a10 + 2. * self.a12 * r.a0 * r.a8 + 2. * self.a12 * r.a9 * r.a10 + self.a13 * r.a0.powi(2) - self.a13 * r.a8.powi(2) - self.a13 * r.a9.powi(2) + self.a13 * r.a10.powi(2) - 2. * self.a14 * r.a0 * r.a5 - 2. * self.a14 * r.a6 * r.a8 + 2. * self.a14 * r.a7 * r.a9,
            a14: self.a14 * (r.a0.powi(2) + r.a8.powi(2) + r.a9.powi(2) + r.a10.powi(2)),
            a15: -2. * self.a0 * r.a5 * r.a10 - 2. * self.a0 * r.a6 * r.a9 - 2. * self.a0 * r.a7 * r.a8 + self.a15 * r.a0.powi(2) + self.a15 * r.a8.powi(2) + self.a15 * r.a9.powi(2) + self.a15 * r.a10.powi(2),
        }
    }
}

impl Transform<FullMultivector> for FullMultivector {
    fn transform(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0.powi(2) + self.a0 * r.a2.powi(2) + self.a0 * r.a3.powi(2) + self.a0 * r.a4.powi(2) + self.a0 * r.a8.powi(2) + self.a0 * r.a9.powi(2) + self.a0 * r.a10.powi(2) + self.a0 * r.a14.powi(2) + 2. * self.a2 * r.a0 * r.a2 - 2. * self.a2 * r.a3 * r.a8 + 2. * self.a2 * r.a4 * r.a9 + 2. * self.a2 * r.a10 * r.a14 + 2. * self.a3 * r.a0 * r.a3 + 2. * self.a3 * r.a2 * r.a8 - 2. * self.a3 * r.a4 * r.a10 + 2. * self.a3 * r.a9 * r.a14 + 2. * self.a4 * r.a0 * r.a4 - 2. * self.a4 * r.a2 * r.a9 + 2. * self.a4 * r.a3 * r.a10 + 2. * self.a4 * r.a8 * r.a14,
            a1: 2. * self.a0 * r.a0 * r.a1 + 2. * self.a0 * r.a2 * r.a5 + 2. * self.a0 * r.a3 * r.a6 + 2. * self.a0 * r.a4 * r.a7 - 2. * self.a0 * r.a8 * r.a11 - 2. * self.a0 * r.a9 * r.a12 - 2. * self.a0 * r.a10 * r.a13 + 2. * self.a0 * r.a14 * r.a15 + self.a1 * r.a0.powi(2) - self.a1 * r.a2.powi(2) - self.a1 * r.a3.powi(2) - self.a1 * r.a4.powi(2) + self.a1 * r.a8.powi(2) + self.a1 * r.a9.powi(2) + self.a1 * r.a10.powi(2) - self.a1 * r.a14.powi(2) + 2. * self.a2 * r.a0 * r.a5 + 2. * self.a2 * r.a1 * r.a2 + 2. * self.a2 * r.a3 * r.a11 - 2. * self.a2 * r.a4 * r.a12 - 2. * self.a2 * r.a6 * r.a8 + 2. * self.a2 * r.a7 * r.a9 + 2. * self.a2 * r.a10 * r.a15 - 2. * self.a2 * r.a13 * r.a14 + 2. * self.a3 * r.a0 * r.a6 + 2. * self.a3 * r.a1 * r.a3 - 2. * self.a3 * r.a2 * r.a11 + 2. * self.a3 * r.a4 * r.a13 + 2. * self.a3 * r.a5 * r.a8 - 2. * self.a3 * r.a7 * r.a10 + 2. * self.a3 * r.a9 * r.a15 - 2. * self.a3 * r.a12 * r.a14 + 2. * self.a4 * r.a0 * r.a7 + 2. * self.a4 * r.a1 * r.a4 + 2. * self.a4 * r.a2 * r.a12 - 2. * self.a4 * r.a3 * r.a13 - 2. * self.a4 * r.a5 * r.a9 + 2. * self.a4 * r.a6 * r.a10 + 2. * self.a4 * r.a8 * r.a15 - 2. * self.a4 * r.a11 * r.a14 + 2. * self.a15 * r.a0 * r.a14 - 2. * self.a15 * r.a2 * r.a10 - 2. * self.a15 * r.a3 * r.a9 - 2. * self.a15 * r.a4 * r.a8,
            a2: 2. * self.a0 * r.a0 * r.a2 + 2. * self.a0 * r.a3 * r.a8 - 2. * self.a0 * r.a4 * r.a9 + 2. * self.a0 * r.a10 * r.a14 + self.a2 * r.a0.powi(2) + self.a2 * r.a2.powi(2) - self.a2 * r.a3.powi(2) - self.a2 * r.a4.powi(2) - self.a2 * r.a8.powi(2) - self.a2 * r.a9.powi(2) + self.a2 * r.a10.powi(2) + self.a2 * r.a14.powi(2) + 2. * self.a3 * r.a0 * r.a8 + 2. * self.a3 * r.a2 * r.a3 - 2. * self.a3 * r.a4 * r.a14 + 2. * self.a3 * r.a9 * r.a10 - 2. * self.a4 * r.a0 * r.a9 + 2. * self.a4 * r.a2 * r.a4 + 2. * self.a4 * r.a3 * r.a14 + 2. * self.a4 * r.a8 * r.a10,
            a3: 2. * self.a0 * r.a0 * r.a3 - 2. * self.a0 * r.a2 * r.a8 + 2. * self.a0 * r.a4 * r.a10 + 2. * self.a0 * r.a9 * r.a14 - 2. * self.a2 * r.a0 * r.a8 + 2. * self.a2 * r.a2 * r.a3 + 2. * self.a2 * r.a4 * r.a14 + 2. * self.a2 * r.a9 * r.a10 + self.a3 * r.a0.powi(2) - self.a3 * r.a2.powi(2) + self.a3 * r.a3.powi(2) - self.a3 * r.a4.powi(2) - self.a3 * r.a8.powi(2) + self.a3 * r.a9.powi(2) - self.a3 * r.a10.powi(2) + self.a3 * r.a14.powi(2) + 2. * self.a4 * r.a0 * r.a10 - 2. * self.a4 * r.a2 * r.a14 + 2. * self.a4 * r.a3 * r.a4 + 2. * self.a4 * r.a8 * r.a9,
            a4: 2. * self.a0 * r.a0 * r.a4 + 2. * self.a0 * r.a2 * r.a9 - 2. * self.a0 * r.a3 * r.a10 + 2. * self.a0 * r.a8 * r.a14 + 2. * self.a2 * r.a0 * r.a9 + 2. * self.a2 * r.a2 * r.a4 - 2. * self.a2 * r.a3 * r.a14 + 2. * self.a2 * r.a8 * r.a10 - 2. * self.a3 * r.a0 * r.a10 + 2. * self.a3 * r.a2 * r.a14 + 2. * self.a3 * r.a3 * r.a4 + 2. * self.a3 * r.a8 * r.a9 + self.a4 * r.a0.powi(2) - self.a4 * r.a2.powi(2) - self.a4 * r.a3.powi(2) + self.a4 * r.a4.powi(2) + self.a4 * r.a8.powi(2) - self.a4 * r.a9.powi(2) - self.a4 * r.a10.powi(2) + self.a4 * r.a14.powi(2),
            a5: self.a5 * r.a0.powi(2) - self.a5 * r.a2.powi(2) + self.a5 * r.a3.powi(2) + self.a5 * r.a4.powi(2) - self.a5 * r.a8.powi(2) - self.a5 * r.a9.powi(2) + self.a5 * r.a10.powi(2) - self.a5 * r.a14.powi(2) + 2. * self.a6 * r.a0 * r.a8 - 2. * self.a6 * r.a2 * r.a3 + 2. * self.a6 * r.a4 * r.a14 + 2. * self.a6 * r.a9 * r.a10 - 2. * self.a7 * r.a0 * r.a9 - 2. * self.a7 * r.a2 * r.a4 - 2. * self.a7 * r.a3 * r.a14 + 2. * self.a7 * r.a8 * r.a10 - 2. * self.a8 * r.a0 * r.a6 + 2. * self.a8 * r.a1 * r.a3 + 2. * self.a8 * r.a2 * r.a11 + 2. * self.a8 * r.a4 * r.a13 + 2. * self.a8 * r.a5 * r.a8 + 2. * self.a8 * r.a7 * r.a10 + 2. * self.a8 * r.a9 * r.a15 + 2. * self.a8 * r.a12 * r.a14 + 2. * self.a9 * r.a0 * r.a7 - 2. * self.a9 * r.a1 * r.a4 + 2. * self.a9 * r.a2 * r.a12 + 2. * self.a9 * r.a3 * r.a13 + 2. * self.a9 * r.a5 * r.a9 + 2. * self.a9 * r.a6 * r.a10 - 2. * self.a9 * r.a8 * r.a15 - 2. * self.a9 * r.a11 * r.a14 - 2. * self.a10 * r.a0 * r.a15 + 2. * self.a10 * r.a1 * r.a14 + 2. * self.a10 * r.a2 * r.a13 - 2. * self.a10 * r.a3 * r.a12 - 2. * self.a10 * r.a4 * r.a11 + 2. * self.a10 * r.a5 * r.a10 - 2. * self.a10 * r.a6 * r.a9 - 2. * self.a10 * r.a7 * r.a8 - 2. * self.a11 * r.a0 * r.a3 + 2. * self.a11 * r.a2 * r.a8 + 2. * self.a11 * r.a4 * r.a10 + 2. * self.a11 * r.a9 * r.a14 + 2. * self.a12 * r.a0 * r.a4 + 2. * self.a12 * r.a2 * r.a9 + 2. * self.a12 * r.a3 * r.a10 - 2. * self.a12 * r.a8 * r.a14 - 2. * self.a13 * r.a0 * r.a14 + 2. * self.a13 * r.a2 * r.a10 - 2. * self.a13 * r.a3 * r.a9 - 2. * self.a13 * r.a4 * r.a8 + 2. * self.a14 * r.a0 * r.a13 + 2. * self.a14 * r.a1 * r.a10 - 2. * self.a14 * r.a2 * r.a15 + 2. * self.a14 * r.a3 * r.a7 - 2. * self.a14 * r.a4 * r.a6 + 2. * self.a14 * r.a5 * r.a14 + 2. * self.a14 * r.a8 * r.a12 - 2. * self.a14 * r.a9 * r.a11,
            a6: -2. * self.a5 * r.a0 * r.a8 - 2. * self.a5 * r.a2 * r.a3 - 2. * self.a5 * r.a4 * r.a14 + 2. * self.a5 * r.a9 * r.a10 + self.a6 * r.a0.powi(2) + self.a6 * r.a2.powi(2) - self.a6 * r.a3.powi(2) + self.a6 * r.a4.powi(2) - self.a6 * r.a8.powi(2) + self.a6 * r.a9.powi(2) - self.a6 * r.a10.powi(2) - self.a6 * r.a14.powi(2) + 2. * self.a7 * r.a0 * r.a10 + 2. * self.a7 * r.a2 * r.a14 - 2. * self.a7 * r.a3 * r.a4 + 2. * self.a7 * r.a8 * r.a9 + 2. * self.a8 * r.a0 * r.a5 - 2. * self.a8 * r.a1 * r.a2 + 2. * self.a8 * r.a3 * r.a11 + 2. * self.a8 * r.a4 * r.a12 + 2. * self.a8 * r.a6 * r.a8 + 2. * self.a8 * r.a7 * r.a9 - 2. * self.a8 * r.a10 * r.a15 - 2. * self.a8 * r.a13 * r.a14 - 2. * self.a9 * r.a0 * r.a15 + 2. * self.a9 * r.a1 * r.a14 - 2. * self.a9 * r.a2 * r.a13 + 2. * self.a9 * r.a3 * r.a12 - 2. * self.a9 * r.a4 * r.a11 - 2. * self.a9 * r.a5 * r.a10 + 2. * self.a9 * r.a6 * r.a9 - 2. * self.a9 * r.a7 * r.a8 - 2. * self.a10 * r.a0 * r.a7 + 2. * self.a10 * r.a1 * r.a4 + 2. * self.a10 * r.a2 * r.a12 + 2. * self.a10 * r.a3 * r.a13 + 2. * self.a10 * r.a5 * r.a9 + 2. * self.a10 * r.a6 * r.a10 + 2. * self.a10 * r.a8 * r.a15 + 2. * self.a10 * r.a11 * r.a14 + 2. * self.a11 * r.a0 * r.a2 + 2. * self.a11 * r.a3 * r.a8 + 2. * self.a11 * r.a4 * r.a9 - 2. * self.a11 * r.a10 * r.a14 - 2. * self.a12 * r.a0 * r.a14 - 2. * self.a12 * r.a2 * r.a10 + 2. * self.a12 * r.a3 * r.a9 - 2. * self.a12 * r.a4 * r.a8 - 2. * self.a13 * r.a0 * r.a4 + 2. * self.a13 * r.a2 * r.a9 + 2. * self.a13 * r.a3 * r.a10 + 2. * self.a13 * r.a8 * r.a14 + 2. * self.a14 * r.a0 * r.a12 + 2. * self.a14 * r.a1 * r.a9 - 2. * self.a14 * r.a2 * r.a7 - 2. * self.a14 * r.a3 * r.a15 + 2. * self.a14 * r.a4 * r.a5 + 2. * self.a14 * r.a6 * r.a14 - 2. * self.a14 * r.a8 * r.a13 + 2. * self.a14 * r.a10 * r.a11,
            a7: 2. * self.a5 * r.a0 * r.a9 - 2. * self.a5 * r.a2 * r.a4 + 2. * self.a5 * r.a3 * r.a14 + 2. * self.a5 * r.a8 * r.a10 - 2. * self.a6 * r.a0 * r.a10 - 2. * self.a6 * r.a2 * r.a14 - 2. * self.a6 * r.a3 * r.a4 + 2. * self.a6 * r.a8 * r.a9 + self.a7 * r.a0.powi(2) + self.a7 * r.a2.powi(2) + self.a7 * r.a3.powi(2) - self.a7 * r.a4.powi(2) + self.a7 * r.a8.powi(2) - self.a7 * r.a9.powi(2) - self.a7 * r.a10.powi(2) - self.a7 * r.a14.powi(2) - 2. * self.a8 * r.a0 * r.a15 + 2. * self.a8 * r.a1 * r.a14 - 2. * self.a8 * r.a2 * r.a13 - 2. * self.a8 * r.a3 * r.a12 + 2. * self.a8 * r.a4 * r.a11 - 2. * self.a8 * r.a5 * r.a10 - 2. * self.a8 * r.a6 * r.a9 + 2. * self.a8 * r.a7 * r.a8 - 2. * self.a9 * r.a0 * r.a5 + 2. * self.a9 * r.a1 * r.a2 + 2. * self.a9 * r.a3 * r.a11 + 2. * self.a9 * r.a4 * r.a12 + 2. * self.a9 * r.a6 * r.a8 + 2. * self.a9 * r.a7 * r.a9 + 2. * self.a9 * r.a10 * r.a15 + 2. * self.a9 * r.a13 * r.a14 + 2. * self.a10 * r.a0 * r.a6 - 2. * self.a10 * r.a1 * r.a3 + 2. * self.a10 * r.a2 * r.a11 + 2. * self.a10 * r.a4 * r.a13 + 2. * self.a10 * r.a5 * r.a8 + 2. * self.a10 * r.a7 * r.a10 - 2. * self.a10 * r.a9 * r.a15 - 2. * self.a10 * r.a12 * r.a14 - 2. * self.a11 * r.a0 * r.a14 - 2. * self.a11 * r.a2 * r.a10 - 2. * self.a11 * r.a3 * r.a9 + 2. * self.a11 * r.a4 * r.a8 - 2. * self.a12 * r.a0 * r.a2 + 2. * self.a12 * r.a3 * r.a8 + 2. * self.a12 * r.a4 * r.a9 + 2. * self.a12 * r.a10 * r.a14 + 2. * self.a13 * r.a0 * r.a3 + 2. * self.a13 * r.a2 * r.a8 + 2. * self.a13 * r.a4 * r.a10 - 2. * self.a13 * r.a9 * r.a14 + 2. * self.a14 * r.a0 * r.a11 + 2. * self.a14 * r.a1 * r.a8 + 2. * self.a14 * r.a2 * r.a6 - 2. * self.a14 * r.a3 * r.a5 - 2. * self.a14 * r.a4 * r.a15 + 2. * self.a14 * r.a7 * r.a14 + 2. * self.a14 * r.a9 * r.a13 - 2. * self.a14 * r.a10 * r.a12,
            a8: self.a8 * r.a0.powi(2) - self.a8 * r.a2.powi(2) - self.a8 * r.a3.powi(2) + self.a8 * r.a4.powi(2) + self.a8 * r.a8.powi(2) - self.a8 * r.a9.powi(2) - self.a8 * r.a10.powi(2) + self.a8 * r.a14.powi(2) - 2. * self.a9 * r.a0 * r.a10 + 2. * self.a9 * r.a2 * r.a14 + 2. * self.a9 * r.a3 * r.a4 + 2. * self.a9 * r.a8 * r.a9 + 2. * self.a10 * r.a0 * r.a9 + 2. * self.a10 * r.a2 * r.a4 - 2. * self.a10 * r.a3 * r.a14 + 2. * self.a10 * r.a8 * r.a10 + 2. * self.a14 * r.a0 * r.a4 + 2. * self.a14 * r.a2 * r.a9 - 2. * self.a14 * r.a3 * r.a10 + 2. * self.a14 * r.a8 * r.a14,
            a9: 2. * self.a8 * r.a0 * r.a10 - 2. * self.a8 * r.a2 * r.a14 + 2. * self.a8 * r.a3 * r.a4 + 2. * self.a8 * r.a8 * r.a9 + self.a9 * r.a0.powi(2) - self.a9 * r.a2.powi(2) + self.a9 * r.a3.powi(2) - self.a9 * r.a4.powi(2) - self.a9 * r.a8.powi(2) + self.a9 * r.a9.powi(2) - self.a9 * r.a10.powi(2) + self.a9 * r.a14.powi(2) - 2. * self.a10 * r.a0 * r.a8 + 2. * self.a10 * r.a2 * r.a3 + 2. * self.a10 * r.a4 * r.a14 + 2. * self.a10 * r.a9 * r.a10 + 2. * self.a14 * r.a0 * r.a3 - 2. * self.a14 * r.a2 * r.a8 + 2. * self.a14 * r.a4 * r.a10 + 2. * self.a14 * r.a9 * r.a14,
            a10: -2. * self.a8 * r.a0 * r.a9 + 2. * self.a8 * r.a2 * r.a4 + 2. * self.a8 * r.a3 * r.a14 + 2. * self.a8 * r.a8 * r.a10 + 2. * self.a9 * r.a0 * r.a8 + 2. * self.a9 * r.a2 * r.a3 - 2. * self.a9 * r.a4 * r.a14 + 2. * self.a9 * r.a9 * r.a10 + self.a10 * r.a0.powi(2) + self.a10 * r.a2.powi(2) - self.a10 * r.a3.powi(2) - self.a10 * r.a4.powi(2) - self.a10 * r.a8.powi(2) - self.a10 * r.a9.powi(2) + self.a10 * r.a10.powi(2) + self.a10 * r.a14.powi(2) + 2. * self.a14 * r.a0 * r.a2 + 2. * self.a14 * r.a3 * r.a8 - 2. * self.a14 * r.a4 * r.a9 + 2. * self.a14 * r.a10 * r.a14,
            a11: -2. * self.a5 * r.a0 * r.a3 - 2. * self.a5 * r.a2 * r.a8 - 2. * self.a5 * r.a4 * r.a10 + 2. * self.a5 * r.a9 * r.a14 + 2. * self.a6 * r.a0 * r.a2 - 2. * self.a6 * r.a3 * r.a8 - 2. * self.a6 * r.a4 * r.a9 - 2. * self.a6 * r.a10 * r.a14 + 2. * self.a7 * r.a0 * r.a14 + 2. * self.a7 * r.a2 * r.a10 + 2. * self.a7 * r.a3 * r.a9 - 2. * self.a7 * r.a4 * r.a8 - 2. * self.a8 * r.a0 * r.a1 + 2. * self.a8 * r.a2 * r.a5 + 2. * self.a8 * r.a3 * r.a6 - 2. * self.a8 * r.a4 * r.a7 + 2. * self.a8 * r.a8 * r.a11 - 2. * self.a8 * r.a9 * r.a12 - 2. * self.a8 * r.a10 * r.a13 - 2. * self.a8 * r.a14 * r.a15 - 2. * self.a9 * r.a0 * r.a13 + 2. * self.a9 * r.a1 * r.a10 - 2. * self.a9 * r.a2 * r.a15 - 2. * self.a9 * r.a3 * r.a7 - 2. * self.a9 * r.a4 * r.a6 - 2. * self.a9 * r.a5 * r.a14 + 2. * self.a9 * r.a8 * r.a12 + 2. * self.a9 * r.a9 * r.a11 + 2. * self.a10 * r.a0 * r.a12 - 2. * self.a10 * r.a1 * r.a9 - 2. * self.a10 * r.a2 * r.a7 + 2. * self.a10 * r.a3 * r.a15 - 2. * self.a10 * r.a4 * r.a5 + 2. * self.a10 * r.a6 * r.a14 + 2. * self.a10 * r.a8 * r.a13 + 2. * self.a10 * r.a10 * r.a11 + self.a11 * r.a0.powi(2) + self.a11 * r.a2.powi(2) + self.a11 * r.a3.powi(2) - self.a11 * r.a4.powi(2) + self.a11 * r.a8.powi(2) - self.a11 * r.a9.powi(2) - self.a11 * r.a10.powi(2) - self.a11 * r.a14.powi(2) - 2. * self.a12 * r.a0 * r.a10 - 2. * self.a12 * r.a2 * r.a14 - 2. * self.a12 * r.a3 * r.a4 + 2. * self.a12 * r.a8 * r.a9 + 2. * self.a13 * r.a0 * r.a9 - 2. * self.a13 * r.a2 * r.a4 + 2. * self.a13 * r.a3 * r.a14 + 2. * self.a13 * r.a8 * r.a10 - 2. * self.a14 * r.a0 * r.a7 - 2. * self.a14 * r.a1 * r.a4 + 2. * self.a14 * r.a2 * r.a12 - 2. * self.a14 * r.a3 * r.a13 - 2. * self.a14 * r.a5 * r.a9 + 2. * self.a14 * r.a6 * r.a10 - 2. * self.a14 * r.a8 * r.a15 + 2. * self.a14 * r.a11 * r.a14,
            a12: 2. * self.a5 * r.a0 * r.a4 - 2. * self.a5 * r.a2 * r.a9 - 2. * self.a5 * r.a3 * r.a10 - 2. * self.a5 * r.a8 * r.a14 + 2. * self.a6 * r.a0 * r.a14 + 2. * self.a6 * r.a2 * r.a10 - 2. * self.a6 * r.a3 * r.a9 + 2. * self.a6 * r.a4 * r.a8 - 2. * self.a7 * r.a0 * r.a2 - 2. * self.a7 * r.a3 * r.a8 - 2. * self.a7 * r.a4 * r.a9 + 2. * self.a7 * r.a10 * r.a14 + 2. * self.a8 * r.a0 * r.a13 - 2. * self.a8 * r.a1 * r.a10 + 2. * self.a8 * r.a2 * r.a15 - 2. * self.a8 * r.a3 * r.a7 - 2. * self.a8 * r.a4 * r.a6 + 2. * self.a8 * r.a5 * r.a14 + 2. * self.a8 * r.a8 * r.a12 + 2. * self.a8 * r.a9 * r.a11 - 2. * self.a9 * r.a0 * r.a1 + 2. * self.a9 * r.a2 * r.a5 - 2. * self.a9 * r.a3 * r.a6 + 2. * self.a9 * r.a4 * r.a7 - 2. * self.a9 * r.a8 * r.a11 + 2. * self.a9 * r.a9 * r.a12 - 2. * self.a9 * r.a10 * r.a13 - 2. * self.a9 * r.a14 * r.a15 - 2. * self.a10 * r.a0 * r.a11 + 2. * self.a10 * r.a1 * r.a8 - 2. * self.a10 * r.a2 * r.a6 - 2. * self.a10 * r.a3 * r.a5 - 2. * self.a10 * r.a4 * r.a15 - 2. * self.a10 * r.a7 * r.a14 + 2. * self.a10 * r.a9 * r.a13 + 2. * self.a10 * r.a10 * r.a12 + 2. * self.a11 * r.a0 * r.a10 + 2. * self.a11 * r.a2 * r.a14 - 2. * self.a11 * r.a3 * r.a4 + 2. * self.a11 * r.a8 * r.a9 + self.a12 * r.a0.powi(2) + self.a12 * r.a2.powi(2) - self.a12 * r.a3.powi(2) + self.a12 * r.a4.powi(2) - self.a12 * r.a8.powi(2) + self.a12 * r.a9.powi(2) - self.a12 * r.a10.powi(2) - self.a12 * r.a14.powi(2) - 2. * self.a13 * r.a0 * r.a8 - 2. * self.a13 * r.a2 * r.a3 - 2. * self.a13 * r.a4 * r.a14 + 2. * self.a13 * r.a9 * r.a10 - 2. * self.a14 * r.a0 * r.a6 - 2. * self.a14 * r.a1 * r.a3 - 2. * self.a14 * r.a2 * r.a11 + 2. * self.a14 * r.a4 * r.a13 + 2. * self.a14 * r.a5 * r.a8 - 2. * self.a14 * r.a7 * r.a10 - 2. * self.a14 * r.a9 * r.a15 + 2. * self.a14 * r.a12 * r.a14,
            a13: 2. * self.a5 * r.a0 * r.a14 - 2. * self.a5 * r.a2 * r.a10 + 2. * self.a5 * r.a3 * r.a9 + 2. * self.a5 * r.a4 * r.a8 - 2. * self.a6 * r.a0 * r.a4 - 2. * self.a6 * r.a2 * r.a9 - 2. * self.a6 * r.a3 * r.a10 + 2. * self.a6 * r.a8 * r.a14 + 2. * self.a7 * r.a0 * r.a3 - 2. * self.a7 * r.a2 * r.a8 - 2. * self.a7 * r.a4 * r.a10 - 2. * self.a7 * r.a9 * r.a14 - 2. * self.a8 * r.a0 * r.a12 + 2. * self.a8 * r.a1 * r.a9 - 2. * self.a8 * r.a2 * r.a7 - 2. * self.a8 * r.a3 * r.a15 - 2. * self.a8 * r.a4 * r.a5 - 2. * self.a8 * r.a6 * r.a14 + 2. * self.a8 * r.a8 * r.a13 + 2. * self.a8 * r.a10 * r.a11 + 2. * self.a9 * r.a0 * r.a11 - 2. * self.a9 * r.a1 * r.a8 - 2. * self.a9 * r.a2 * r.a6 - 2. * self.a9 * r.a3 * r.a5 + 2. * self.a9 * r.a4 * r.a15 + 2. * self.a9 * r.a7 * r.a14 + 2. * self.a9 * r.a9 * r.a13 + 2. * self.a9 * r.a10 * r.a12 - 2. * self.a10 * r.a0 * r.a1 - 2. * self.a10 * r.a2 * r.a5 + 2. * self.a10 * r.a3 * r.a6 + 2. * self.a10 * r.a4 * r.a7 - 2. * self.a10 * r.a8 * r.a11 - 2. * self.a10 * r.a9 * r.a12 + 2. * self.a10 * r.a10 * r.a13 - 2. * self.a10 * r.a14 * r.a15 - 2. * self.a11 * r.a0 * r.a9 - 2. * self.a11 * r.a2 * r.a4 - 2. * self.a11 * r.a3 * r.a14 + 2. * self.a11 * r.a8 * r.a10 + 2. * self.a12 * r.a0 * r.a8 - 2. * self.a12 * r.a2 * r.a3 + 2. * self.a12 * r.a4 * r.a14 + 2. * self.a12 * r.a9 * r.a10 + self.a13 * r.a0.powi(2) - self.a13 * r.a2.powi(2) + self.a13 * r.a3.powi(2) + self.a13 * r.a4.powi(2) - self.a13 * r.a8.powi(2) - self.a13 * r.a9.powi(2) + self.a13 * r.a10.powi(2) - self.a13 * r.a14.powi(2) - 2. * self.a14 * r.a0 * r.a5 - 2. * self.a14 * r.a1 * r.a2 + 2. * self.a14 * r.a3 * r.a11 - 2. * self.a14 * r.a4 * r.a12 - 2. * self.a14 * r.a6 * r.a8 + 2. * self.a14 * r.a7 * r.a9 - 2. * self.a14 * r.a10 * r.a15 + 2. * self.a14 * r.a13 * r.a14,
            a14: 2. * self.a8 * r.a0 * r.a4 - 2. * self.a8 * r.a2 * r.a9 + 2. * self.a8 * r.a3 * r.a10 + 2. * self.a8 * r.a8 * r.a14 + 2. * self.a9 * r.a0 * r.a3 + 2. * self.a9 * r.a2 * r.a8 - 2. * self.a9 * r.a4 * r.a10 + 2. * self.a9 * r.a9 * r.a14 + 2. * self.a10 * r.a0 * r.a2 - 2. * self.a10 * r.a3 * r.a8 + 2. * self.a10 * r.a4 * r.a9 + 2. * self.a10 * r.a10 * r.a14 + self.a14 * r.a0.powi(2) + self.a14 * r.a2.powi(2) + self.a14 * r.a3.powi(2) + self.a14 * r.a4.powi(2) + self.a14 * r.a8.powi(2) + self.a14 * r.a9.powi(2) + self.a14 * r.a10.powi(2) + self.a14 * r.a14.powi(2),
            a15: 2. * self.a0 * r.a0 * r.a15 - 2. * self.a0 * r.a1 * r.a14 - 2. * self.a0 * r.a2 * r.a13 - 2. * self.a0 * r.a3 * r.a12 - 2. * self.a0 * r.a4 * r.a11 - 2. * self.a0 * r.a5 * r.a10 - 2. * self.a0 * r.a6 * r.a9 - 2. * self.a0 * r.a7 * r.a8 - 2. * self.a1 * r.a0 * r.a14 + 2. * self.a1 * r.a2 * r.a10 + 2. * self.a1 * r.a3 * r.a9 + 2. * self.a1 * r.a4 * r.a8 - 2. * self.a2 * r.a0 * r.a13 - 2. * self.a2 * r.a1 * r.a10 + 2. * self.a2 * r.a2 * r.a15 + 2. * self.a2 * r.a3 * r.a7 - 2. * self.a2 * r.a4 * r.a6 - 2. * self.a2 * r.a5 * r.a14 + 2. * self.a2 * r.a8 * r.a12 - 2. * self.a2 * r.a9 * r.a11 - 2. * self.a3 * r.a0 * r.a12 - 2. * self.a3 * r.a1 * r.a9 - 2. * self.a3 * r.a2 * r.a7 + 2. * self.a3 * r.a3 * r.a15 + 2. * self.a3 * r.a4 * r.a5 - 2. * self.a3 * r.a6 * r.a14 - 2. * self.a3 * r.a8 * r.a13 + 2. * self.a3 * r.a10 * r.a11 - 2. * self.a4 * r.a0 * r.a11 - 2. * self.a4 * r.a1 * r.a8 + 2. * self.a4 * r.a2 * r.a6 - 2. * self.a4 * r.a3 * r.a5 + 2. * self.a4 * r.a4 * r.a15 - 2. * self.a4 * r.a7 * r.a14 + 2. * self.a4 * r.a9 * r.a13 - 2. * self.a4 * r.a10 * r.a12 + self.a15 * r.a0.powi(2) - self.a15 * r.a2.powi(2) - self.a15 * r.a3.powi(2) - self.a15 * r.a4.powi(2) + self.a15 * r.a8.powi(2) + self.a15 * r.a9.powi(2) + self.a15 * r.a10.powi(2) - self.a15 * r.a14.powi(2),
        }
    }
}

impl Bivector {
    pub fn exp(self) -> ScalarAndBivector {
        let theta = self.norm();
        if theta.abs() < FLOAT_DIVISION_EPSILON {
            1. + self
        } else {
            theta.cos() + (theta.sin() / theta) * self
        }
    }
}

pub const I: Pseudoscalar = Pseudoscalar { a15: 1. };


