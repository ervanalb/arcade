// ===========================================================================
// ======= THIS FILE IS AUTOGENERATED. PLEASE EDIT pga_gen.py INSTEAD ========
// ===========================================================================

// This module lays out the 3D projective geometric algebra (PGA)
// that we will be using. The metric is R(3,0,1).


// The following conventions are used for coefficients of the basis:
// a0
// + a1 * e0 + a2 * e1 + a3 * e2 + a4 * e3
// + a5 * e01 + a6 * e02 + a7 * e03 + a8 * e12 + a9 * e31 + a10 * e23
// + a11 * e021 + a12 * e013 + a13 * e032 + a14 * e123
// + a15 * e0123

// Operators:
// *  geometric product
// ^  wedge (meet)
// &  vee (join)
// |  dot
// << reflect ( a << b = a * b * a )
// >> sandwich ( a >> b = a * b * a.reverse() )

// This file heavily inspired by https://bivector.net/tools.html and their generated rust code.
// Hopefully the conventions here are the same as ganja.js and company,
// so there is good interoperability.
// One exception is that using ! to take the dual has been removed (use .dual())

use crate::global::{Float, FLOAT_DIVISION_EPSILON};
use std::fmt;
use std::ops::{Add, Sub, Mul, Neg, BitXor, BitAnd, BitOr, Shl, Shr};

pub trait Multivector: fmt::Debug + Clone + Copy + PartialEq + Default
    + Neg<Output=Self>
    + Mul<Float, Output=Self>
    + Add<Self, Output=Self>
    + Sub<Self, Output=Self> {

    type Dual: Multivector;

    // Unary operations
    fn reverse(self) -> Self;
    fn dual(self) -> Self::Dual;
    fn conjugate(self) -> Self;
    fn norm(self) -> Float;
    fn inorm(self) -> Float;

    // Select elements of given grade:
    fn scalar(self) -> Float;
    fn vector(self) -> Vector;
    fn bivector(self) -> Bivector;
    fn trivector(self) -> Trivector;
    fn full_multivector(self) -> FullMultivector;

    // Construct a multivector representing zero
    fn zero() -> Self {
        Default::default()
    }

    // Return a normalized copy
    fn hat(self) -> Self {
        self * (1.0 / self.norm())
    }
}

// ===========================================================================
// Float
// ===========================================================================

impl Multivector for Float {
    type Dual = FullMultivector;

    fn reverse(self) -> Float {
        self
    }

    fn dual(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self,
        }
    }

    fn conjugate(self) -> Float {
        self
    }

    fn norm(self) -> Float {
        self.abs()
    }

    fn inorm(self) -> Float {
        0.
    }

    fn scalar(self) -> Float {
        self
    }

    fn vector(self) -> Vector {
        Vector {
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }

    fn bivector(self) -> Bivector {
        Bivector {
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }

    fn trivector(self) -> Trivector {
        Trivector {
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
        }
    }

    fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Vector> for Float {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Bivector> for Float {
    type Output = ScalarAndBivector;

    fn add(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
        }
    }
}

impl Add<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn add(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self + r.a0,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
        }
    }
}

impl Add<Trivector> for Float {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: 0.,
        }
    }
}

impl Add<FullMultivector> for Float {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self + r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Vector> for Float {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Bivector> for Float {
    type Output = ScalarAndBivector;

    fn sub(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
        }
    }
}

impl Sub<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn sub(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self - r.a0,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
        }
    }
}

impl Sub<Trivector> for Float {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: 0.,
        }
    }
}

impl Sub<FullMultivector> for Float {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self - r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Vector> for Float {
    type Output = Vector;

    fn mul(self, r: Vector) -> Vector {
        Vector {
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
        }
    }
}

impl Mul<Bivector> for Float {
    type Output = Bivector;

    fn mul(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl Mul<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn mul(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self * r.a0,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl Mul<Trivector> for Float {
    type Output = Trivector;

    fn mul(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
        }
    }
}

impl Mul<FullMultivector> for Float {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self * r.a0,
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
            a15: self * r.a15,
        }
    }
}

impl BitXor<Vector> for Float {
    type Output = Vector;

    fn bitxor(self, r: Vector) -> Vector {
        Vector {
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
        }
    }
}

impl BitXor<Bivector> for Float {
    type Output = Bivector;

    fn bitxor(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl BitXor<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn bitxor(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self * r.a0,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl BitXor<Trivector> for Float {
    type Output = Trivector;

    fn bitxor(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
        }
    }
}

impl BitXor<FullMultivector> for Float {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self * r.a0,
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
            a15: self * r.a15,
        }
    }
}

impl BitAnd<Vector> for Float {
    type Output = Float;

    fn bitand(self, _r: Vector) -> Float {
        0.
    }
}

impl BitAnd<Bivector> for Float {
    type Output = Float;

    fn bitand(self, _r: Bivector) -> Float {
        0.
    }
}

impl BitAnd<ScalarAndBivector> for Float {
    type Output = Float;

    fn bitand(self, _r: ScalarAndBivector) -> Float {
        0.
    }
}

impl BitAnd<Trivector> for Float {
    type Output = Float;

    fn bitand(self, _r: Trivector) -> Float {
        0.
    }
}

impl BitAnd<FullMultivector> for Float {
    type Output = Float;

    fn bitand(self, r: FullMultivector) -> Float {
        self * r.a15
    }
}

impl BitOr<Vector> for Float {
    type Output = Vector;

    fn bitor(self, r: Vector) -> Vector {
        Vector {
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
        }
    }
}

impl BitOr<Bivector> for Float {
    type Output = Bivector;

    fn bitor(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl BitOr<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn bitor(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self * r.a0,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
        }
    }
}

impl BitOr<Trivector> for Float {
    type Output = Trivector;

    fn bitor(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
        }
    }
}

impl BitOr<FullMultivector> for Float {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self * r.a0,
            a1: self * r.a1,
            a2: self * r.a2,
            a3: self * r.a3,
            a4: self * r.a4,
            a5: self * r.a5,
            a6: self * r.a6,
            a7: self * r.a7,
            a8: self * r.a8,
            a9: self * r.a9,
            a10: self * r.a10,
            a11: self * r.a11,
            a12: self * r.a12,
            a13: self * r.a13,
            a14: self * r.a14,
            a15: self * r.a15,
        }
    }
}

impl Shl<Vector> for Float {
    type Output = Vector;

    fn shl(self, r: Vector) -> Vector {
        Vector {
            a1: self.powi(2) * r.a1,
            a2: self.powi(2) * r.a2,
            a3: self.powi(2) * r.a3,
            a4: self.powi(2) * r.a4,
        }
    }
}

impl Shl<Bivector> for Float {
    type Output = Bivector;

    fn shl(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.powi(2) * r.a5,
            a6: self.powi(2) * r.a6,
            a7: self.powi(2) * r.a7,
            a8: self.powi(2) * r.a8,
            a9: self.powi(2) * r.a9,
            a10: self.powi(2) * r.a10,
        }
    }
}

impl Shl<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn shl(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.powi(2) * r.a0,
            a5: self.powi(2) * r.a5,
            a6: self.powi(2) * r.a6,
            a7: self.powi(2) * r.a7,
            a8: self.powi(2) * r.a8,
            a9: self.powi(2) * r.a9,
            a10: self.powi(2) * r.a10,
        }
    }
}

impl Shl<Trivector> for Float {
    type Output = Trivector;

    fn shl(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.powi(2) * r.a11,
            a12: self.powi(2) * r.a12,
            a13: self.powi(2) * r.a13,
            a14: self.powi(2) * r.a14,
        }
    }
}

impl Shl<FullMultivector> for Float {
    type Output = FullMultivector;

    fn shl(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.powi(2) * r.a0,
            a1: self.powi(2) * r.a1,
            a2: self.powi(2) * r.a2,
            a3: self.powi(2) * r.a3,
            a4: self.powi(2) * r.a4,
            a5: self.powi(2) * r.a5,
            a6: self.powi(2) * r.a6,
            a7: self.powi(2) * r.a7,
            a8: self.powi(2) * r.a8,
            a9: self.powi(2) * r.a9,
            a10: self.powi(2) * r.a10,
            a11: self.powi(2) * r.a11,
            a12: self.powi(2) * r.a12,
            a13: self.powi(2) * r.a13,
            a14: self.powi(2) * r.a14,
            a15: self.powi(2) * r.a15,
        }
    }
}

impl Shr<Vector> for Float {
    type Output = Vector;

    fn shr(self, r: Vector) -> Vector {
        Vector {
            a1: self.powi(2) * r.a1,
            a2: self.powi(2) * r.a2,
            a3: self.powi(2) * r.a3,
            a4: self.powi(2) * r.a4,
        }
    }
}

impl Shr<Bivector> for Float {
    type Output = Bivector;

    fn shr(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.powi(2) * r.a5,
            a6: self.powi(2) * r.a6,
            a7: self.powi(2) * r.a7,
            a8: self.powi(2) * r.a8,
            a9: self.powi(2) * r.a9,
            a10: self.powi(2) * r.a10,
        }
    }
}

impl Shr<ScalarAndBivector> for Float {
    type Output = ScalarAndBivector;

    fn shr(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.powi(2) * r.a0,
            a5: self.powi(2) * r.a5,
            a6: self.powi(2) * r.a6,
            a7: self.powi(2) * r.a7,
            a8: self.powi(2) * r.a8,
            a9: self.powi(2) * r.a9,
            a10: self.powi(2) * r.a10,
        }
    }
}

impl Shr<Trivector> for Float {
    type Output = Trivector;

    fn shr(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.powi(2) * r.a11,
            a12: self.powi(2) * r.a12,
            a13: self.powi(2) * r.a13,
            a14: self.powi(2) * r.a14,
        }
    }
}

impl Shr<FullMultivector> for Float {
    type Output = FullMultivector;

    fn shr(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.powi(2) * r.a0,
            a1: self.powi(2) * r.a1,
            a2: self.powi(2) * r.a2,
            a3: self.powi(2) * r.a3,
            a4: self.powi(2) * r.a4,
            a5: self.powi(2) * r.a5,
            a6: self.powi(2) * r.a6,
            a7: self.powi(2) * r.a7,
            a8: self.powi(2) * r.a8,
            a9: self.powi(2) * r.a9,
            a10: self.powi(2) * r.a10,
            a11: self.powi(2) * r.a11,
            a12: self.powi(2) * r.a12,
            a13: self.powi(2) * r.a13,
            a14: self.powi(2) * r.a14,
            a15: self.powi(2) * r.a15,
        }
    }
}

// ===========================================================================
// Vector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct Vector {
    a1: Float,
    a2: Float,
    a3: Float,
    a4: Float,
}

impl Multivector for Vector {
    type Dual = Trivector;

    fn reverse(self) -> Vector {
        Vector {
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
        }
    }

    fn dual(self) -> Trivector {
        Trivector {
            a11: self.a4,
            a12: self.a3,
            a13: self.a2,
            a14: self.a1,
        }
    }

    fn conjugate(self) -> Vector {
        Vector {
            a1: -self.a1,
            a2: -self.a2,
            a3: -self.a3,
            a4: -self.a4,
        }
    }

    fn norm(self) -> Float {
        (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)).sqrt()
    }

    fn inorm(self) -> Float {
        self.a1.abs()
    }

    fn scalar(self) -> Float {
        0.
    }

    fn vector(self) -> Vector {
        Vector {
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
        }
    }

    fn bivector(self) -> Bivector {
        Bivector {
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }

    fn trivector(self) -> Trivector {
        Trivector {
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
        }
    }

    fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Neg for Vector {
    type Output = Vector;

    fn neg(self) -> Vector {
        Vector {
            a1: -self.a1,
            a2: -self.a2,
            a3: -self.a3,
            a4: -self.a4,
        }
    }
}

impl Add<Float> for Vector {
    type Output = FullMultivector;

    fn add(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Vector> for Vector {
    type Output = Vector;

    fn add(self, r: Vector) -> Vector {
        Vector {
            a1: self.a1 + r.a1,
            a2: self.a2 + r.a2,
            a3: self.a3 + r.a3,
            a4: self.a4 + r.a4,
        }
    }
}

impl Add<Bivector> for Vector {
    type Output = FullMultivector;

    fn add(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<ScalarAndBivector> for Vector {
    type Output = FullMultivector;

    fn add(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Trivector> for Vector {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: 0.,
        }
    }
}

impl Add<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: self.a1 + r.a1,
            a2: self.a2 + r.a2,
            a3: self.a3 + r.a3,
            a4: self.a4 + r.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Float> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: -r,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Vector> for Vector {
    type Output = Vector;

    fn sub(self, r: Vector) -> Vector {
        Vector {
            a1: self.a1 - r.a1,
            a2: self.a2 - r.a2,
            a3: self.a3 - r.a3,
            a4: self.a4 - r.a4,
        }
    }
}

impl Sub<Bivector> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<ScalarAndBivector> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Trivector> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: 0.,
        }
    }
}

impl Sub<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: self.a1 - r.a1,
            a2: self.a2 - r.a2,
            a3: self.a3 - r.a3,
            a4: self.a4 - r.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Float> for Vector {
    type Output = Vector;

    fn mul(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
        }
    }
}

impl Mul<Vector> for Vector {
    type Output = ScalarAndBivector;

    fn mul(self, r: Vector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a5: self.a1 * r.a2 - self.a2 * r.a1,
            a6: self.a1 * r.a3 - self.a3 * r.a1,
            a7: self.a1 * r.a4 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2,
            a9: -self.a2 * r.a4 + self.a4 * r.a2,
            a10: self.a3 * r.a4 - self.a4 * r.a3,
        }
    }
}

impl Mul<Bivector> for Vector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: -self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: 0.,
        }
    }
}

impl Mul<ScalarAndBivector> for Vector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: 0.,
        }
    }
}

impl Mul<Trivector> for Vector {
    type Output = FullMultivector;

    fn mul(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a2 * r.a11 - self.a4 * r.a13,
            a7: -self.a2 * r.a12 + self.a3 * r.a13,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl Mul<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0,
            a5: self.a1 * r.a2 - self.a2 * r.a1 - self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a1 * r.a3 + self.a2 * r.a11 - self.a3 * r.a1 - self.a4 * r.a13,
            a7: self.a1 * r.a4 - self.a2 * r.a12 + self.a3 * r.a13 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2 + self.a4 * r.a14,
            a9: -self.a2 * r.a4 + self.a3 * r.a14 + self.a4 * r.a2,
            a10: self.a2 * r.a14 + self.a3 * r.a4 - self.a4 * r.a3,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a4 * r.a15,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a3 * r.a15 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a2 * r.a15 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl BitXor<Float> for Vector {
    type Output = Vector;

    fn bitxor(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
        }
    }
}

impl BitXor<Vector> for Vector {
    type Output = Bivector;

    fn bitxor(self, r: Vector) -> Bivector {
        Bivector {
            a5: self.a1 * r.a2 - self.a2 * r.a1,
            a6: self.a1 * r.a3 - self.a3 * r.a1,
            a7: self.a1 * r.a4 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2,
            a9: -self.a2 * r.a4 + self.a4 * r.a2,
            a10: self.a3 * r.a4 - self.a4 * r.a3,
        }
    }
}

impl BitXor<Bivector> for Vector {
    type Output = Trivector;

    fn bitxor(self, r: Bivector) -> Trivector {
        Trivector {
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
        }
    }
}

impl BitXor<ScalarAndBivector> for Vector {
    type Output = FullMultivector;

    fn bitxor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1 * r.a0,
            a2: self.a2 * r.a0,
            a3: self.a3 * r.a0,
            a4: self.a4 * r.a0,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: 0.,
        }
    }
}

impl BitXor<Trivector> for Vector {
    type Output = FullMultivector;

    fn bitxor(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl BitXor<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a1 * r.a0,
            a2: self.a2 * r.a0,
            a3: self.a3 * r.a0,
            a4: self.a4 * r.a0,
            a5: self.a1 * r.a2 - self.a2 * r.a1,
            a6: self.a1 * r.a3 - self.a3 * r.a1,
            a7: self.a1 * r.a4 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2,
            a9: -self.a2 * r.a4 + self.a4 * r.a2,
            a10: self.a3 * r.a4 - self.a4 * r.a3,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl BitAnd<Float> for Vector {
    type Output = Float;

    fn bitand(self, _r: Float) -> Float {
        0.
    }
}

impl BitAnd<Vector> for Vector {
    type Output = Float;

    fn bitand(self, _r: Vector) -> Float {
        0.
    }
}

impl BitAnd<Bivector> for Vector {
    type Output = Float;

    fn bitand(self, _r: Bivector) -> Float {
        0.
    }
}

impl BitAnd<ScalarAndBivector> for Vector {
    type Output = Float;

    fn bitand(self, _r: ScalarAndBivector) -> Float {
        0.
    }
}

impl BitAnd<Trivector> for Vector {
    type Output = Float;

    fn bitand(self, r: Trivector) -> Float {
        -self.a1 * r.a14 - self.a2 * r.a13 - self.a3 * r.a12 - self.a4 * r.a11
    }
}

impl BitAnd<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a1 * r.a14 - self.a2 * r.a13 - self.a3 * r.a12 - self.a4 * r.a11,
            a1: self.a1 * r.a15,
            a2: self.a2 * r.a15,
            a3: self.a3 * r.a15,
            a4: self.a4 * r.a15,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Float> for Vector {
    type Output = Vector;

    fn bitor(self, r: Float) -> Vector {
        Vector {
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
        }
    }
}

impl BitOr<Vector> for Vector {
    type Output = Float;

    fn bitor(self, r: Vector) -> Float {
        self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4
    }
}

impl BitOr<Bivector> for Vector {
    type Output = Vector;

    fn bitor(self, r: Bivector) -> Vector {
        Vector {
            a1: -self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: -self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10,
        }
    }
}

impl BitOr<ScalarAndBivector> for Vector {
    type Output = Vector;

    fn bitor(self, r: ScalarAndBivector) -> Vector {
        Vector {
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0,
        }
    }
}

impl BitOr<Trivector> for Vector {
    type Output = Bivector;

    fn bitor(self, r: Trivector) -> Bivector {
        Bivector {
            a5: -self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a2 * r.a11 - self.a4 * r.a13,
            a7: -self.a2 * r.a12 + self.a3 * r.a13,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
        }
    }
}

impl BitOr<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0,
            a5: -self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a2 * r.a11 - self.a4 * r.a13,
            a7: -self.a2 * r.a12 + self.a3 * r.a13,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
            a11: self.a4 * r.a15,
            a12: self.a3 * r.a15,
            a13: self.a2 * r.a15,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Shl<Float> for Vector {
    type Output = Float;

    fn shl(self, r: Float) -> Float {
        r * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2))
    }
}

impl Shl<Vector> for Vector {
    type Output = Vector;

    fn shl(self, r: Vector) -> Vector {
        Vector {
            a1: 2. * self.a1 * self.a2 * r.a2 + 2. * self.a1 * self.a3 * r.a3 + 2. * self.a1 * self.a4 * r.a4 - self.a2.powi(2) * r.a1 - self.a3.powi(2) * r.a1 - self.a4.powi(2) * r.a1,
            a2: self.a2 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) + self.a3 * (self.a2 * r.a3 - self.a3 * r.a2) + self.a4 * (self.a2 * r.a4 - self.a4 * r.a2),
            a3: -self.a2 * (self.a2 * r.a3 - self.a3 * r.a2) + self.a3 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) + self.a4 * (self.a3 * r.a4 - self.a4 * r.a3),
            a4: -self.a2 * (self.a2 * r.a4 - self.a4 * r.a2) - self.a3 * (self.a3 * r.a4 - self.a4 * r.a3) + self.a4 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
        }
    }
}

impl Shl<Bivector> for Vector {
    type Output = Bivector;

    fn shl(self, r: Bivector) -> Bivector {
        Bivector {
            a5: 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + self.a3.powi(2) * r.a5 + self.a4.powi(2) * r.a5,
            a6: -2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + self.a4.powi(2) * r.a6,
            a7: 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - self.a4.powi(2) * r.a7,
            a8: -self.a2 * (self.a2 * r.a8 - self.a4 * r.a10) - self.a3 * (self.a3 * r.a8 - self.a4 * r.a9) + self.a4 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8),
            a9: -self.a2 * (self.a2 * r.a9 - self.a3 * r.a10) + self.a3 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + self.a4 * (self.a3 * r.a8 - self.a4 * r.a9),
            a10: self.a2 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + self.a3 * (self.a2 * r.a9 - self.a3 * r.a10) + self.a4 * (self.a2 * r.a8 - self.a4 * r.a10),
        }
    }
}

impl Shl<ScalarAndBivector> for Vector {
    type Output = ScalarAndBivector;

    fn shl(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: r.a0 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
            a5: 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + self.a3.powi(2) * r.a5 + self.a4.powi(2) * r.a5,
            a6: -2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + self.a4.powi(2) * r.a6,
            a7: 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - self.a4.powi(2) * r.a7,
            a8: -self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 + self.a4.powi(2) * r.a8,
            a9: -self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 - self.a4.powi(2) * r.a9,
            a10: self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 - self.a3.powi(2) * r.a10 - self.a4.powi(2) * r.a10,
        }
    }
}

impl Shl<Trivector> for Vector {
    type Output = Trivector;

    fn shl(self, r: Trivector) -> Trivector {
        Trivector {
            a11: -2. * self.a1 * self.a4 * r.a14 + self.a2.powi(2) * r.a11 - 2. * self.a2 * self.a4 * r.a13 + self.a3.powi(2) * r.a11 - 2. * self.a3 * self.a4 * r.a12 - self.a4.powi(2) * r.a11,
            a12: -2. * self.a1 * self.a3 * r.a14 + self.a2.powi(2) * r.a12 - 2. * self.a2 * self.a3 * r.a13 - self.a3.powi(2) * r.a12 - 2. * self.a3 * self.a4 * r.a11 + self.a4.powi(2) * r.a12,
            a13: -2. * self.a1 * self.a2 * r.a14 - self.a2.powi(2) * r.a13 - 2. * self.a2 * self.a3 * r.a12 - 2. * self.a2 * self.a4 * r.a11 + self.a3.powi(2) * r.a13 + self.a4.powi(2) * r.a13,
            a14: r.a14 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
        }
    }
}

impl Shl<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn shl(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
            a1: 2. * self.a1 * self.a2 * r.a2 + 2. * self.a1 * self.a3 * r.a3 + 2. * self.a1 * self.a4 * r.a4 - self.a2.powi(2) * r.a1 - self.a3.powi(2) * r.a1 - self.a4.powi(2) * r.a1,
            a2: self.a2.powi(2) * r.a2 + 2. * self.a2 * self.a3 * r.a3 + 2. * self.a2 * self.a4 * r.a4 - self.a3.powi(2) * r.a2 - self.a4.powi(2) * r.a2,
            a3: -self.a2.powi(2) * r.a3 + 2. * self.a2 * self.a3 * r.a2 + self.a3.powi(2) * r.a3 + 2. * self.a3 * self.a4 * r.a4 - self.a4.powi(2) * r.a3,
            a4: -self.a2.powi(2) * r.a4 + 2. * self.a2 * self.a4 * r.a2 - self.a3.powi(2) * r.a4 + 2. * self.a3 * self.a4 * r.a3 + self.a4.powi(2) * r.a4,
            a5: 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + self.a3.powi(2) * r.a5 + self.a4.powi(2) * r.a5,
            a6: -2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + self.a4.powi(2) * r.a6,
            a7: 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - self.a4.powi(2) * r.a7,
            a8: -self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 + self.a4.powi(2) * r.a8,
            a9: -self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 - self.a4.powi(2) * r.a9,
            a10: self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 - self.a3.powi(2) * r.a10 - self.a4.powi(2) * r.a10,
            a11: -2. * self.a1 * self.a4 * r.a14 + self.a2.powi(2) * r.a11 - 2. * self.a2 * self.a4 * r.a13 + self.a3.powi(2) * r.a11 - 2. * self.a3 * self.a4 * r.a12 - self.a4.powi(2) * r.a11,
            a12: -2. * self.a1 * self.a3 * r.a14 + self.a2.powi(2) * r.a12 - 2. * self.a2 * self.a3 * r.a13 - self.a3.powi(2) * r.a12 - 2. * self.a3 * self.a4 * r.a11 + self.a4.powi(2) * r.a12,
            a13: -2. * self.a1 * self.a2 * r.a14 - self.a2.powi(2) * r.a13 - 2. * self.a2 * self.a3 * r.a12 - 2. * self.a2 * self.a4 * r.a11 + self.a3.powi(2) * r.a13 + self.a4.powi(2) * r.a13,
            a14: r.a14 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
            a15: -r.a15 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
        }
    }
}

impl Shr<Float> for Vector {
    type Output = Float;

    fn shr(self, r: Float) -> Float {
        r * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2))
    }
}

impl Shr<Vector> for Vector {
    type Output = Vector;

    fn shr(self, r: Vector) -> Vector {
        Vector {
            a1: 2. * self.a1 * self.a2 * r.a2 + 2. * self.a1 * self.a3 * r.a3 + 2. * self.a1 * self.a4 * r.a4 - self.a2.powi(2) * r.a1 - self.a3.powi(2) * r.a1 - self.a4.powi(2) * r.a1,
            a2: self.a2 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) + self.a3 * (self.a2 * r.a3 - self.a3 * r.a2) + self.a4 * (self.a2 * r.a4 - self.a4 * r.a2),
            a3: -self.a2 * (self.a2 * r.a3 - self.a3 * r.a2) + self.a3 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) + self.a4 * (self.a3 * r.a4 - self.a4 * r.a3),
            a4: -self.a2 * (self.a2 * r.a4 - self.a4 * r.a2) - self.a3 * (self.a3 * r.a4 - self.a4 * r.a3) + self.a4 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4),
        }
    }
}

impl Shr<Bivector> for Vector {
    type Output = Bivector;

    fn shr(self, r: Bivector) -> Bivector {
        Bivector {
            a5: 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + self.a3.powi(2) * r.a5 + self.a4.powi(2) * r.a5,
            a6: -2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + self.a4.powi(2) * r.a6,
            a7: 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - self.a4.powi(2) * r.a7,
            a8: -self.a2 * (self.a2 * r.a8 - self.a4 * r.a10) - self.a3 * (self.a3 * r.a8 - self.a4 * r.a9) + self.a4 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8),
            a9: -self.a2 * (self.a2 * r.a9 - self.a3 * r.a10) + self.a3 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + self.a4 * (self.a3 * r.a8 - self.a4 * r.a9),
            a10: self.a2 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + self.a3 * (self.a2 * r.a9 - self.a3 * r.a10) + self.a4 * (self.a2 * r.a8 - self.a4 * r.a10),
        }
    }
}

impl Shr<ScalarAndBivector> for Vector {
    type Output = ScalarAndBivector;

    fn shr(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: r.a0 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
            a5: 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + self.a3.powi(2) * r.a5 + self.a4.powi(2) * r.a5,
            a6: -2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + self.a4.powi(2) * r.a6,
            a7: 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - self.a4.powi(2) * r.a7,
            a8: -self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 + self.a4.powi(2) * r.a8,
            a9: -self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 - self.a4.powi(2) * r.a9,
            a10: self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 - self.a3.powi(2) * r.a10 - self.a4.powi(2) * r.a10,
        }
    }
}

impl Shr<Trivector> for Vector {
    type Output = Trivector;

    fn shr(self, r: Trivector) -> Trivector {
        Trivector {
            a11: -2. * self.a1 * self.a4 * r.a14 + self.a2.powi(2) * r.a11 - 2. * self.a2 * self.a4 * r.a13 + self.a3.powi(2) * r.a11 - 2. * self.a3 * self.a4 * r.a12 - self.a4.powi(2) * r.a11,
            a12: -2. * self.a1 * self.a3 * r.a14 + self.a2.powi(2) * r.a12 - 2. * self.a2 * self.a3 * r.a13 - self.a3.powi(2) * r.a12 - 2. * self.a3 * self.a4 * r.a11 + self.a4.powi(2) * r.a12,
            a13: -2. * self.a1 * self.a2 * r.a14 - self.a2.powi(2) * r.a13 - 2. * self.a2 * self.a3 * r.a12 - 2. * self.a2 * self.a4 * r.a11 + self.a3.powi(2) * r.a13 + self.a4.powi(2) * r.a13,
            a14: r.a14 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
        }
    }
}

impl Shr<FullMultivector> for Vector {
    type Output = FullMultivector;

    fn shr(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
            a1: 2. * self.a1 * self.a2 * r.a2 + 2. * self.a1 * self.a3 * r.a3 + 2. * self.a1 * self.a4 * r.a4 - self.a2.powi(2) * r.a1 - self.a3.powi(2) * r.a1 - self.a4.powi(2) * r.a1,
            a2: self.a2.powi(2) * r.a2 + 2. * self.a2 * self.a3 * r.a3 + 2. * self.a2 * self.a4 * r.a4 - self.a3.powi(2) * r.a2 - self.a4.powi(2) * r.a2,
            a3: -self.a2.powi(2) * r.a3 + 2. * self.a2 * self.a3 * r.a2 + self.a3.powi(2) * r.a3 + 2. * self.a3 * self.a4 * r.a4 - self.a4.powi(2) * r.a3,
            a4: -self.a2.powi(2) * r.a4 + 2. * self.a2 * self.a4 * r.a2 - self.a3.powi(2) * r.a4 + 2. * self.a3 * self.a4 * r.a3 + self.a4.powi(2) * r.a4,
            a5: 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + self.a3.powi(2) * r.a5 + self.a4.powi(2) * r.a5,
            a6: -2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + self.a4.powi(2) * r.a6,
            a7: 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - self.a4.powi(2) * r.a7,
            a8: -self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 + self.a4.powi(2) * r.a8,
            a9: -self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 - self.a4.powi(2) * r.a9,
            a10: self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 - self.a3.powi(2) * r.a10 - self.a4.powi(2) * r.a10,
            a11: -2. * self.a1 * self.a4 * r.a14 + self.a2.powi(2) * r.a11 - 2. * self.a2 * self.a4 * r.a13 + self.a3.powi(2) * r.a11 - 2. * self.a3 * self.a4 * r.a12 - self.a4.powi(2) * r.a11,
            a12: -2. * self.a1 * self.a3 * r.a14 + self.a2.powi(2) * r.a12 - 2. * self.a2 * self.a3 * r.a13 - self.a3.powi(2) * r.a12 - 2. * self.a3 * self.a4 * r.a11 + self.a4.powi(2) * r.a12,
            a13: -2. * self.a1 * self.a2 * r.a14 - self.a2.powi(2) * r.a13 - 2. * self.a2 * self.a3 * r.a12 - 2. * self.a2 * self.a4 * r.a11 + self.a3.powi(2) * r.a13 + self.a4.powi(2) * r.a13,
            a14: r.a14 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
            a15: -r.a15 * (self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2)),
        }
    }
}

// ===========================================================================
// Bivector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct Bivector {
    a5: Float,
    a6: Float,
    a7: Float,
    a8: Float,
    a9: Float,
    a10: Float,
}

impl Multivector for Bivector {
    type Dual = Bivector;

    fn reverse(self) -> Bivector {
        Bivector {
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }

    fn dual(self) -> Bivector {
        Bivector {
            a5: self.a10,
            a6: self.a9,
            a7: self.a8,
            a8: self.a7,
            a9: self.a6,
            a10: self.a5,
        }
    }

    fn conjugate(self) -> Bivector {
        Bivector {
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }

    fn norm(self) -> Float {
        (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)).sqrt()
    }

    fn inorm(self) -> Float {
        (self.a5.powi(2) + self.a6.powi(2) + self.a7.powi(2)).sqrt()
    }

    fn scalar(self) -> Float {
        0.
    }

    fn vector(self) -> Vector {
        Vector {
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }

    fn bivector(self) -> Bivector {
        Bivector {
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }

    fn trivector(self) -> Trivector {
        Trivector {
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
        }
    }

    fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Neg for Bivector {
    type Output = Bivector;

    fn neg(self) -> Bivector {
        Bivector {
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }
}

impl Add<Float> for Bivector {
    type Output = ScalarAndBivector;

    fn add(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: r,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }
}

impl Add<Vector> for Bivector {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Bivector> for Bivector {
    type Output = Bivector;

    fn add(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
        }
    }
}

impl Add<ScalarAndBivector> for Bivector {
    type Output = ScalarAndBivector;

    fn add(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: r.a0,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
        }
    }
}

impl Add<Trivector> for Bivector {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: 0.,
        }
    }
}

impl Add<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Float> for Bivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -r,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }
}

impl Sub<Vector> for Bivector {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Bivector> for Bivector {
    type Output = Bivector;

    fn sub(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
        }
    }
}

impl Sub<ScalarAndBivector> for Bivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -r.a0,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
        }
    }
}

impl Sub<Trivector> for Bivector {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: 0.,
        }
    }
}

impl Sub<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Float> for Bivector {
    type Output = Bivector;

    fn mul(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl Mul<Vector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a8 * r.a3 - self.a9 * r.a4,
            a3: -self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a9 * r.a2 - self.a10 * r.a3,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: 0.,
        }
    }
}

impl Mul<Bivector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7,
            a6: self.a5 * r.a8 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7,
            a7: -self.a5 * r.a9 + self.a6 * r.a10 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a9 * r.a10 - self.a10 * r.a9,
            a9: -self.a8 * r.a10 + self.a10 * r.a8,
            a10: self.a8 * r.a9 - self.a9 * r.a8,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<ScalarAndBivector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7,
            a6: self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7,
            a7: -self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: -self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<Trivector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a13: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Mul<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14,
            a3: -self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4,
            a4: -self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a10 * r.a15,
            a6: self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 - self.a9 * r.a15 + self.a10 * r.a7,
            a7: -self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 - self.a8 * r.a15 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: -self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a7 * r.a14 - self.a8 * r.a1 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: self.a5 * r.a4 - self.a6 * r.a14 - self.a7 * r.a2 - self.a8 * r.a13 - self.a9 * r.a1 + self.a10 * r.a11,
            a13: -self.a5 * r.a14 - self.a6 * r.a4 + self.a7 * r.a3 + self.a8 * r.a12 - self.a9 * r.a11 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Float> for Bivector {
    type Output = Bivector;

    fn bitxor(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl BitXor<Vector> for Bivector {
    type Output = Trivector;

    fn bitxor(self, r: Vector) -> Trivector {
        Trivector {
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
        }
    }
}

impl BitXor<Bivector> for Bivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<ScalarAndBivector> for Bivector {
    type Output = FullMultivector;

    fn bitxor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5 * r.a0,
            a6: self.a6 * r.a0,
            a7: self.a7 * r.a0,
            a8: self.a8 * r.a0,
            a9: self.a9 * r.a0,
            a10: self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Trivector> for Bivector {
    type Output = Float;

    fn bitxor(self, _r: Trivector) -> Float {
        0.
    }
}

impl BitXor<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5 * r.a0,
            a6: self.a6 * r.a0,
            a7: self.a7 * r.a0,
            a8: self.a8 * r.a0,
            a9: self.a9 * r.a0,
            a10: self.a10 * r.a0,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitAnd<Float> for Bivector {
    type Output = Float;

    fn bitand(self, _r: Float) -> Float {
        0.
    }
}

impl BitAnd<Vector> for Bivector {
    type Output = Float;

    fn bitand(self, _r: Vector) -> Float {
        0.
    }
}

impl BitAnd<Bivector> for Bivector {
    type Output = Float;

    fn bitand(self, r: Bivector) -> Float {
        self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5
    }
}

impl BitAnd<ScalarAndBivector> for Bivector {
    type Output = Float;

    fn bitand(self, r: ScalarAndBivector) -> Float {
        self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5
    }
}

impl BitAnd<Trivector> for Bivector {
    type Output = Vector;

    fn bitand(self, r: Trivector) -> Vector {
        Vector {
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
        }
    }
}

impl BitAnd<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a5: self.a5 * r.a15,
            a6: self.a6 * r.a15,
            a7: self.a7 * r.a15,
            a8: self.a8 * r.a15,
            a9: self.a9 * r.a15,
            a10: self.a10 * r.a15,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Float> for Bivector {
    type Output = Bivector;

    fn bitor(self, r: Float) -> Bivector {
        Bivector {
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl BitOr<Vector> for Bivector {
    type Output = Vector;

    fn bitor(self, r: Vector) -> Vector {
        Vector {
            a1: self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a8 * r.a3 - self.a9 * r.a4,
            a3: -self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a9 * r.a2 - self.a10 * r.a3,
        }
    }
}

impl BitOr<Bivector> for Bivector {
    type Output = Float;

    fn bitor(self, r: Bivector) -> Float {
        -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10
    }
}

impl BitOr<ScalarAndBivector> for Bivector {
    type Output = ScalarAndBivector;

    fn bitor(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a5: self.a5 * r.a0,
            a6: self.a6 * r.a0,
            a7: self.a7 * r.a0,
            a8: self.a8 * r.a0,
            a9: self.a9 * r.a0,
            a10: self.a10 * r.a0,
        }
    }
}

impl BitOr<Trivector> for Bivector {
    type Output = Vector;

    fn bitor(self, r: Trivector) -> Vector {
        Vector {
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
        }
    }
}

impl BitOr<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14,
            a3: -self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4,
            a4: -self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a5 * r.a0 - self.a10 * r.a15,
            a6: self.a6 * r.a0 - self.a9 * r.a15,
            a7: self.a7 * r.a0 - self.a8 * r.a15,
            a8: self.a8 * r.a0,
            a9: self.a9 * r.a0,
            a10: self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Shl<Float> for Bivector {
    type Output = FullMultivector;

    fn shl(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: -r * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 2. * r * (self.a5 * self.a10 + self.a6 * self.a9 + self.a7 * self.a8),
        }
    }
}

impl Shl<Vector> for Bivector {
    type Output = Vector;

    fn shl(self, r: Vector) -> Vector {
        Vector {
            a1: -2. * self.a5 * self.a8 * r.a3 + 2. * self.a5 * self.a9 * r.a4 + 2. * self.a6 * self.a8 * r.a2 - 2. * self.a6 * self.a10 * r.a4 - 2. * self.a7 * self.a9 * r.a2 + 2. * self.a7 * self.a10 * r.a3 - self.a8.powi(2) * r.a1 - self.a9.powi(2) * r.a1 - self.a10.powi(2) * r.a1,
            a2: self.a8 * (self.a8 * r.a2 - self.a10 * r.a4) + self.a9 * (self.a9 * r.a2 - self.a10 * r.a3) - self.a10 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2),
            a3: self.a8 * (self.a8 * r.a3 - self.a9 * r.a4) - self.a9 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) - self.a10 * (self.a9 * r.a2 - self.a10 * r.a3),
            a4: -self.a8.powi(2) * r.a4 - 2. * self.a8 * self.a9 * r.a3 - 2. * self.a8 * self.a10 * r.a2 + self.a9.powi(2) * r.a4 + self.a10.powi(2) * r.a4,
        }
    }
}

impl Shl<Bivector> for Bivector {
    type Output = Bivector;

    fn shl(self, r: Bivector) -> Bivector {
        Bivector {
            a5: -2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 - self.a10.powi(2) * r.a5,
            a6: -2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 + self.a10.powi(2) * r.a6,
            a7: -2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 + self.a9.powi(2) * r.a7 + self.a10.powi(2) * r.a7,
            a8: -self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8,
            a9: self.a8 * (self.a8 * r.a9 - self.a9 * r.a8) - self.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) - self.a10 * (self.a9 * r.a10 - self.a10 * r.a9),
            a10: self.a8 * (self.a8 * r.a10 - self.a10 * r.a8) + self.a9 * (self.a9 * r.a10 - self.a10 * r.a9) - self.a10 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
        }
    }
}

impl Shl<ScalarAndBivector> for Bivector {
    type Output = FullMultivector;

    fn shl(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0 * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 - self.a10.powi(2) * r.a5,
            a6: -2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 + self.a10.powi(2) * r.a6,
            a7: -2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 + self.a9.powi(2) * r.a7 + self.a10.powi(2) * r.a7,
            a8: -self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8,
            a9: self.a8.powi(2) * r.a9 - 2. * self.a8 * self.a9 * r.a8 - self.a9.powi(2) * r.a9 - 2. * self.a9 * self.a10 * r.a10 + self.a10.powi(2) * r.a9,
            a10: self.a8.powi(2) * r.a10 - 2. * self.a8 * self.a10 * r.a8 + self.a9.powi(2) * r.a10 - 2. * self.a9 * self.a10 * r.a9 - self.a10.powi(2) * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 2. * r.a0 * (self.a5 * self.a10 + self.a6 * self.a9 + self.a7 * self.a8),
        }
    }
}

impl Shl<Trivector> for Bivector {
    type Output = Trivector;

    fn shl(self, r: Trivector) -> Trivector {
        Trivector {
            a11: 2. * self.a5 * self.a9 * r.a14 - 2. * self.a6 * self.a10 * r.a14 - self.a8.powi(2) * r.a11 - 2. * self.a8 * self.a9 * r.a12 - 2. * self.a8 * self.a10 * r.a13 + self.a9.powi(2) * r.a11 + self.a10.powi(2) * r.a11,
            a12: -2. * self.a5 * self.a8 * r.a14 + 2. * self.a7 * self.a10 * r.a14 + self.a8.powi(2) * r.a12 - 2. * self.a8 * self.a9 * r.a11 - self.a9.powi(2) * r.a12 - 2. * self.a9 * self.a10 * r.a13 + self.a10.powi(2) * r.a12,
            a13: 2. * self.a6 * self.a8 * r.a14 - 2. * self.a7 * self.a9 * r.a14 + self.a8.powi(2) * r.a13 - 2. * self.a8 * self.a10 * r.a11 + self.a9.powi(2) * r.a13 - 2. * self.a9 * self.a10 * r.a12 - self.a10.powi(2) * r.a13,
            a14: -r.a14 * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
        }
    }
}

impl Shl<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn shl(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0 * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: -2. * self.a5 * self.a8 * r.a3 + 2. * self.a5 * self.a9 * r.a4 + 2. * self.a6 * self.a8 * r.a2 - 2. * self.a6 * self.a10 * r.a4 - 2. * self.a7 * self.a9 * r.a2 + 2. * self.a7 * self.a10 * r.a3 - self.a8.powi(2) * r.a1 - self.a9.powi(2) * r.a1 - self.a10.powi(2) * r.a1,
            a2: self.a8.powi(2) * r.a2 - 2. * self.a8 * self.a10 * r.a4 + self.a9.powi(2) * r.a2 - 2. * self.a9 * self.a10 * r.a3 - self.a10.powi(2) * r.a2,
            a3: self.a8.powi(2) * r.a3 - 2. * self.a8 * self.a9 * r.a4 - self.a9.powi(2) * r.a3 - 2. * self.a9 * self.a10 * r.a2 + self.a10.powi(2) * r.a3,
            a4: -self.a8.powi(2) * r.a4 - 2. * self.a8 * self.a9 * r.a3 - 2. * self.a8 * self.a10 * r.a2 + self.a9.powi(2) * r.a4 + self.a10.powi(2) * r.a4,
            a5: -2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 - self.a10.powi(2) * r.a5,
            a6: -2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 + self.a10.powi(2) * r.a6,
            a7: -2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 + self.a9.powi(2) * r.a7 + self.a10.powi(2) * r.a7,
            a8: -self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8,
            a9: self.a8.powi(2) * r.a9 - 2. * self.a8 * self.a9 * r.a8 - self.a9.powi(2) * r.a9 - 2. * self.a9 * self.a10 * r.a10 + self.a10.powi(2) * r.a9,
            a10: self.a8.powi(2) * r.a10 - 2. * self.a8 * self.a10 * r.a8 + self.a9.powi(2) * r.a10 - 2. * self.a9 * self.a10 * r.a9 - self.a10.powi(2) * r.a10,
            a11: 2. * self.a5 * self.a9 * r.a14 - 2. * self.a6 * self.a10 * r.a14 - self.a8.powi(2) * r.a11 - 2. * self.a8 * self.a9 * r.a12 - 2. * self.a8 * self.a10 * r.a13 + self.a9.powi(2) * r.a11 + self.a10.powi(2) * r.a11,
            a12: -2. * self.a5 * self.a8 * r.a14 + 2. * self.a7 * self.a10 * r.a14 + self.a8.powi(2) * r.a12 - 2. * self.a8 * self.a9 * r.a11 - self.a9.powi(2) * r.a12 - 2. * self.a9 * self.a10 * r.a13 + self.a10.powi(2) * r.a12,
            a13: 2. * self.a6 * self.a8 * r.a14 - 2. * self.a7 * self.a9 * r.a14 + self.a8.powi(2) * r.a13 - 2. * self.a8 * self.a10 * r.a11 + self.a9.powi(2) * r.a13 - 2. * self.a9 * self.a10 * r.a12 - self.a10.powi(2) * r.a13,
            a14: -r.a14 * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a15: 2. * self.a5 * self.a10 * r.a0 + 2. * self.a6 * self.a9 * r.a0 + 2. * self.a7 * self.a8 * r.a0 - self.a8.powi(2) * r.a15 - self.a9.powi(2) * r.a15 - self.a10.powi(2) * r.a15,
        }
    }
}

impl Shr<Float> for Bivector {
    type Output = FullMultivector;

    fn shr(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -2. * r * (self.a5 * self.a10 + self.a6 * self.a9 + self.a7 * self.a8),
        }
    }
}

impl Shr<Vector> for Bivector {
    type Output = Vector;

    fn shr(self, r: Vector) -> Vector {
        Vector {
            a1: 2. * self.a5 * self.a8 * r.a3 - 2. * self.a5 * self.a9 * r.a4 - 2. * self.a6 * self.a8 * r.a2 + 2. * self.a6 * self.a10 * r.a4 + 2. * self.a7 * self.a9 * r.a2 - 2. * self.a7 * self.a10 * r.a3 + self.a8.powi(2) * r.a1 + self.a9.powi(2) * r.a1 + self.a10.powi(2) * r.a1,
            a2: -self.a8 * (self.a8 * r.a2 - self.a10 * r.a4) - self.a9 * (self.a9 * r.a2 - self.a10 * r.a3) + self.a10 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2),
            a3: -self.a8 * (self.a8 * r.a3 - self.a9 * r.a4) + self.a9 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + self.a10 * (self.a9 * r.a2 - self.a10 * r.a3),
            a4: self.a8 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + self.a9 * (self.a8 * r.a3 - self.a9 * r.a4) + self.a10 * (self.a8 * r.a2 - self.a10 * r.a4),
        }
    }
}

impl Shr<Bivector> for Bivector {
    type Output = Bivector;

    fn shr(self, r: Bivector) -> Bivector {
        Bivector {
            a5: 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 + self.a10.powi(2) * r.a5,
            a6: 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6,
            a7: 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 - self.a10.powi(2) * r.a7,
            a8: self.a8 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + self.a9 * (self.a8 * r.a9 - self.a9 * r.a8) + self.a10 * (self.a8 * r.a10 - self.a10 * r.a8),
            a9: -self.a8 * (self.a8 * r.a9 - self.a9 * r.a8) + self.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + self.a10 * (self.a9 * r.a10 - self.a10 * r.a9),
            a10: -self.a8 * (self.a8 * r.a10 - self.a10 * r.a8) - self.a9 * (self.a9 * r.a10 - self.a10 * r.a9) + self.a10 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
        }
    }
}

impl Shr<ScalarAndBivector> for Bivector {
    type Output = FullMultivector;

    fn shr(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0 * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 + self.a10.powi(2) * r.a5,
            a6: 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6,
            a7: 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 - self.a10.powi(2) * r.a7,
            a8: self.a8.powi(2) * r.a8 + 2. * self.a8 * self.a9 * r.a9 + 2. * self.a8 * self.a10 * r.a10 - self.a9.powi(2) * r.a8 - self.a10.powi(2) * r.a8,
            a9: -self.a8.powi(2) * r.a9 + 2. * self.a8 * self.a9 * r.a8 + self.a9.powi(2) * r.a9 + 2. * self.a9 * self.a10 * r.a10 - self.a10.powi(2) * r.a9,
            a10: -self.a8.powi(2) * r.a10 + 2. * self.a8 * self.a10 * r.a8 - self.a9.powi(2) * r.a10 + 2. * self.a9 * self.a10 * r.a9 + self.a10.powi(2) * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -2. * r.a0 * (self.a5 * self.a10 + self.a6 * self.a9 + self.a7 * self.a8),
        }
    }
}

impl Shr<Trivector> for Bivector {
    type Output = Trivector;

    fn shr(self, r: Trivector) -> Trivector {
        Trivector {
            a11: -2. * self.a5 * self.a9 * r.a14 + 2. * self.a6 * self.a10 * r.a14 + self.a8.powi(2) * r.a11 + 2. * self.a8 * self.a9 * r.a12 + 2. * self.a8 * self.a10 * r.a13 - self.a9.powi(2) * r.a11 - self.a10.powi(2) * r.a11,
            a12: 2. * self.a5 * self.a8 * r.a14 - 2. * self.a7 * self.a10 * r.a14 - self.a8.powi(2) * r.a12 + 2. * self.a8 * self.a9 * r.a11 + self.a9.powi(2) * r.a12 + 2. * self.a9 * self.a10 * r.a13 - self.a10.powi(2) * r.a12,
            a13: -2. * self.a6 * self.a8 * r.a14 + 2. * self.a7 * self.a9 * r.a14 - self.a8.powi(2) * r.a13 + 2. * self.a8 * self.a10 * r.a11 - self.a9.powi(2) * r.a13 + 2. * self.a9 * self.a10 * r.a12 + self.a10.powi(2) * r.a13,
            a14: r.a14 * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
        }
    }
}

impl Shr<FullMultivector> for Bivector {
    type Output = FullMultivector;

    fn shr(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0 * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: 2. * self.a5 * self.a8 * r.a3 - 2. * self.a5 * self.a9 * r.a4 - 2. * self.a6 * self.a8 * r.a2 + 2. * self.a6 * self.a10 * r.a4 + 2. * self.a7 * self.a9 * r.a2 - 2. * self.a7 * self.a10 * r.a3 + self.a8.powi(2) * r.a1 + self.a9.powi(2) * r.a1 + self.a10.powi(2) * r.a1,
            a2: -self.a8.powi(2) * r.a2 + 2. * self.a8 * self.a10 * r.a4 - self.a9.powi(2) * r.a2 + 2. * self.a9 * self.a10 * r.a3 + self.a10.powi(2) * r.a2,
            a3: -self.a8.powi(2) * r.a3 + 2. * self.a8 * self.a9 * r.a4 + self.a9.powi(2) * r.a3 + 2. * self.a9 * self.a10 * r.a2 - self.a10.powi(2) * r.a3,
            a4: self.a8.powi(2) * r.a4 + 2. * self.a8 * self.a9 * r.a3 + 2. * self.a8 * self.a10 * r.a2 - self.a9.powi(2) * r.a4 - self.a10.powi(2) * r.a4,
            a5: 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 + self.a10.powi(2) * r.a5,
            a6: 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6,
            a7: 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 - self.a10.powi(2) * r.a7,
            a8: self.a8.powi(2) * r.a8 + 2. * self.a8 * self.a9 * r.a9 + 2. * self.a8 * self.a10 * r.a10 - self.a9.powi(2) * r.a8 - self.a10.powi(2) * r.a8,
            a9: -self.a8.powi(2) * r.a9 + 2. * self.a8 * self.a9 * r.a8 + self.a9.powi(2) * r.a9 + 2. * self.a9 * self.a10 * r.a10 - self.a10.powi(2) * r.a9,
            a10: -self.a8.powi(2) * r.a10 + 2. * self.a8 * self.a10 * r.a8 - self.a9.powi(2) * r.a10 + 2. * self.a9 * self.a10 * r.a9 + self.a10.powi(2) * r.a10,
            a11: -2. * self.a5 * self.a9 * r.a14 + 2. * self.a6 * self.a10 * r.a14 + self.a8.powi(2) * r.a11 + 2. * self.a8 * self.a9 * r.a12 + 2. * self.a8 * self.a10 * r.a13 - self.a9.powi(2) * r.a11 - self.a10.powi(2) * r.a11,
            a12: 2. * self.a5 * self.a8 * r.a14 - 2. * self.a7 * self.a10 * r.a14 - self.a8.powi(2) * r.a12 + 2. * self.a8 * self.a9 * r.a11 + self.a9.powi(2) * r.a12 + 2. * self.a9 * self.a10 * r.a13 - self.a10.powi(2) * r.a12,
            a13: -2. * self.a6 * self.a8 * r.a14 + 2. * self.a7 * self.a9 * r.a14 - self.a8.powi(2) * r.a13 + 2. * self.a8 * self.a10 * r.a11 - self.a9.powi(2) * r.a13 + 2. * self.a9 * self.a10 * r.a12 + self.a10.powi(2) * r.a13,
            a14: r.a14 * (self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a15: -2. * self.a5 * self.a10 * r.a0 - 2. * self.a6 * self.a9 * r.a0 - 2. * self.a7 * self.a8 * r.a0 + self.a8.powi(2) * r.a15 + self.a9.powi(2) * r.a15 + self.a10.powi(2) * r.a15,
        }
    }
}

// ===========================================================================
// ScalarAndBivector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct ScalarAndBivector {
    a0: Float,
    a5: Float,
    a6: Float,
    a7: Float,
    a8: Float,
    a9: Float,
    a10: Float,
}

impl Multivector for ScalarAndBivector {
    type Dual = FullMultivector;

    fn reverse(self) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }

    fn dual(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a10,
            a6: self.a9,
            a7: self.a8,
            a8: self.a7,
            a9: self.a6,
            a10: self.a5,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a0,
        }
    }

    fn conjugate(self) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }

    fn norm(self) -> Float {
        (self.a0.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)).sqrt()
    }

    fn inorm(self) -> Float {
        (self.a5.powi(2) + self.a6.powi(2) + self.a7.powi(2)).sqrt()
    }

    fn scalar(self) -> Float {
        self.a0
    }

    fn vector(self) -> Vector {
        Vector {
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }

    fn bivector(self) -> Bivector {
        Bivector {
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }

    fn trivector(self) -> Trivector {
        Trivector {
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
        }
    }

    fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Neg for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn neg(self) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a0,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
        }
    }
}

impl Add<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn add(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 + r,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }
}

impl Add<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Add<Bivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn add(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
        }
    }
}

impl Add<ScalarAndBivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn add(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 + r.a0,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
        }
    }
}

impl Add<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: 0.,
        }
    }
}

impl Add<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 + r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: r.a11,
            a12: r.a12,
            a13: r.a13,
            a14: r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 - r,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }
}

impl Sub<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Sub<Bivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
        }
    }
}

impl Sub<ScalarAndBivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn sub(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 - r.a0,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
        }
    }
}

impl Sub<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: 0.,
        }
    }
}

impl Sub<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 - r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: -r.a11,
            a12: -r.a12,
            a13: -r.a13,
            a14: -r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn mul(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl Mul<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4,
            a3: self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: 0.,
        }
    }
}

impl Mul<Bivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7,
            a6: self.a0 * r.a6 + self.a5 * r.a8 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<ScalarAndBivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7,
            a6: self.a0 * r.a6 + self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a0 * r.a8 + self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a0 * r.a11 - self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: self.a0 * r.a12 - self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a13: self.a0 * r.a13 - self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a14: self.a0 * r.a14,
            a15: 0.,
        }
    }
}

impl Mul<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14,
            a3: self.a0 * r.a3 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4,
            a4: self.a0 * r.a4 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a10 * r.a15,
            a6: self.a0 * r.a6 + self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 - self.a9 * r.a15 + self.a10 * r.a7,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 - self.a8 * r.a15 + self.a9 * r.a5 - self.a10 * r.a6,
            a8: self.a0 * r.a8 + self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: self.a0 * r.a11 - self.a5 * r.a3 + self.a6 * r.a2 - self.a7 * r.a14 - self.a8 * r.a1 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: self.a0 * r.a12 + self.a5 * r.a4 - self.a6 * r.a14 - self.a7 * r.a2 - self.a8 * r.a13 - self.a9 * r.a1 + self.a10 * r.a11,
            a13: self.a0 * r.a13 - self.a5 * r.a14 - self.a6 * r.a4 + self.a7 * r.a3 + self.a8 * r.a12 - self.a9 * r.a11 - self.a10 * r.a1,
            a14: self.a0 * r.a14 + self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: self.a0 * r.a15 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitxor(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl BitXor<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a0 * r.a1,
            a2: self.a0 * r.a2,
            a3: self.a0 * r.a3,
            a4: self.a0 * r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: 0.,
        }
    }
}

impl BitXor<Bivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5,
            a6: self.a0 * r.a6,
            a7: self.a0 * r.a7,
            a8: self.a0 * r.a8,
            a9: self.a0 * r.a9,
            a10: self.a0 * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<ScalarAndBivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitxor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<Trivector> for ScalarAndBivector {
    type Output = Trivector;

    fn bitxor(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
        }
    }
}

impl BitXor<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0,
            a1: self.a0 * r.a1,
            a2: self.a0 * r.a2,
            a3: self.a0 * r.a3,
            a4: self.a0 * r.a4,
            a5: self.a0 * r.a5 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: self.a0 * r.a11 - self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a0 * r.a12 + self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: self.a0 * r.a13 - self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a0 * r.a14 + self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: self.a0 * r.a15 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitAnd<Float> for ScalarAndBivector {
    type Output = Float;

    fn bitand(self, _r: Float) -> Float {
        0.
    }
}

impl BitAnd<Vector> for ScalarAndBivector {
    type Output = Float;

    fn bitand(self, _r: Vector) -> Float {
        0.
    }
}

impl BitAnd<Bivector> for ScalarAndBivector {
    type Output = Float;

    fn bitand(self, r: Bivector) -> Float {
        self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5
    }
}

impl BitAnd<ScalarAndBivector> for ScalarAndBivector {
    type Output = Float;

    fn bitand(self, r: ScalarAndBivector) -> Float {
        self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5
    }
}

impl BitAnd<Trivector> for ScalarAndBivector {
    type Output = Vector;

    fn bitand(self, r: Trivector) -> Vector {
        Vector {
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
        }
    }
}

impl BitAnd<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a15 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a5: self.a5 * r.a15,
            a6: self.a6 * r.a15,
            a7: self.a7 * r.a15,
            a8: self.a8 * r.a15,
            a9: self.a9 * r.a15,
            a10: self.a10 * r.a15,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Float> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitor(self, r: Float) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
        }
    }
}

impl BitOr<Vector> for ScalarAndBivector {
    type Output = Vector;

    fn bitor(self, r: Vector) -> Vector {
        Vector {
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4,
            a3: self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3,
        }
    }
}

impl BitOr<Bivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitor(self, r: Bivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a5: self.a0 * r.a5,
            a6: self.a0 * r.a6,
            a7: self.a0 * r.a7,
            a8: self.a0 * r.a8,
            a9: self.a0 * r.a9,
            a10: self.a0 * r.a10,
        }
    }
}

impl BitOr<ScalarAndBivector> for ScalarAndBivector {
    type Output = ScalarAndBivector;

    fn bitor(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a5: self.a0 * r.a5 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
        }
    }
}

impl BitOr<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitor(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
            a15: 0.,
        }
    }
}

impl BitOr<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14,
            a3: self.a0 * r.a3 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4,
            a4: self.a0 * r.a4 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a10 * r.a15,
            a6: self.a0 * r.a6 + self.a6 * r.a0 - self.a9 * r.a15,
            a7: self.a0 * r.a7 + self.a7 * r.a0 - self.a8 * r.a15,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
            a15: self.a0 * r.a15,
        }
    }
}

impl Shl<Float> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shl(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r * (self.a0.powi(2) - self.a8.powi(2) - self.a9.powi(2) - self.a10.powi(2)),
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 2. * self.a0 * self.a5 * r,
            a6: 2. * self.a0 * self.a6 * r,
            a7: 2. * self.a0 * self.a7 * r,
            a8: 2. * self.a0 * self.a8 * r,
            a9: 2. * self.a0 * self.a9 * r,
            a10: 2. * self.a0 * self.a10 * r,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 2. * r * (self.a5 * self.a10 + self.a6 * self.a9 + self.a7 * self.a8),
        }
    }
}

impl Shl<Vector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shl(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a0.powi(2) * r.a1 - 2. * self.a5 * self.a8 * r.a3 + 2. * self.a5 * self.a9 * r.a4 + 2. * self.a6 * self.a8 * r.a2 - 2. * self.a6 * self.a10 * r.a4 - 2. * self.a7 * self.a9 * r.a2 + 2. * self.a7 * self.a10 * r.a3 - self.a8.powi(2) * r.a1 - self.a9.powi(2) * r.a1 - self.a10.powi(2) * r.a1,
            a2: self.a0.powi(2) * r.a2 + self.a8.powi(2) * r.a2 - 2. * self.a8 * self.a10 * r.a4 + self.a9.powi(2) * r.a2 - 2. * self.a9 * self.a10 * r.a3 - self.a10.powi(2) * r.a2,
            a3: self.a0.powi(2) * r.a3 + self.a8.powi(2) * r.a3 - 2. * self.a8 * self.a9 * r.a4 - self.a9.powi(2) * r.a3 - 2. * self.a9 * self.a10 * r.a2 + self.a10.powi(2) * r.a3,
            a4: self.a0.powi(2) * r.a4 - self.a8.powi(2) * r.a4 - 2. * self.a8 * self.a9 * r.a3 - 2. * self.a8 * self.a10 * r.a2 + self.a9.powi(2) * r.a4 + self.a10.powi(2) * r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 2. * self.a0 * (-self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1),
            a12: 2. * self.a0 * (self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1),
            a13: 2. * self.a0 * (-self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1),
            a14: 2. * self.a0 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2),
            a15: 0.,
        }
    }
}

impl Shl<Bivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shl(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -2. * self.a0 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0.powi(2) * r.a5 - 2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 - self.a10.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 - 2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 + self.a10.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 + self.a9.powi(2) * r.a7 + self.a10.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 - self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 + self.a8.powi(2) * r.a9 - 2. * self.a8 * self.a9 * r.a8 - self.a9.powi(2) * r.a9 - 2. * self.a9 * self.a10 * r.a10 + self.a10.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + self.a8.powi(2) * r.a10 - 2. * self.a8 * self.a10 * r.a8 + self.a9.powi(2) * r.a10 - 2. * self.a9 * self.a10 * r.a9 - self.a10.powi(2) * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 2. * self.a0 * (self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5),
        }
    }
}

impl Shl<ScalarAndBivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shl(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0.powi(2) * r.a0 - 2. * self.a0 * self.a8 * r.a8 - 2. * self.a0 * self.a9 * r.a9 - 2. * self.a0 * self.a10 * r.a10 - self.a8.powi(2) * r.a0 - self.a9.powi(2) * r.a0 - self.a10.powi(2) * r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0.powi(2) * r.a5 + 2. * self.a0 * self.a5 * r.a0 - 2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 - self.a10.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a6 * r.a0 - 2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 + self.a10.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 + 2. * self.a0 * self.a7 * r.a0 - 2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 + self.a9.powi(2) * r.a7 + self.a10.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 + 2. * self.a0 * self.a8 * r.a0 - self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 + 2. * self.a0 * self.a9 * r.a0 + self.a8.powi(2) * r.a9 - 2. * self.a8 * self.a9 * r.a8 - self.a9.powi(2) * r.a9 - 2. * self.a9 * self.a10 * r.a10 + self.a10.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + 2. * self.a0 * self.a10 * r.a0 + self.a8.powi(2) * r.a10 - 2. * self.a8 * self.a10 * r.a8 + self.a9.powi(2) * r.a10 - 2. * self.a9 * self.a10 * r.a9 - self.a10.powi(2) * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 2. * self.a0 * self.a5 * r.a10 + 2. * self.a0 * self.a6 * r.a9 + 2. * self.a0 * self.a7 * r.a8 + 2. * self.a0 * self.a8 * r.a7 + 2. * self.a0 * self.a9 * r.a6 + 2. * self.a0 * self.a10 * r.a5 + 2. * self.a5 * self.a10 * r.a0 + 2. * self.a6 * self.a9 * r.a0 + 2. * self.a7 * self.a8 * r.a0,
        }
    }
}

impl Shl<Trivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shl(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 2. * self.a0 * (self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13),
            a2: -2. * self.a0 * self.a10 * r.a14,
            a3: -2. * self.a0 * self.a9 * r.a14,
            a4: -2. * self.a0 * self.a8 * r.a14,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a0.powi(2) * r.a11 + 2. * self.a5 * self.a9 * r.a14 - 2. * self.a6 * self.a10 * r.a14 - self.a8.powi(2) * r.a11 - 2. * self.a8 * self.a9 * r.a12 - 2. * self.a8 * self.a10 * r.a13 + self.a9.powi(2) * r.a11 + self.a10.powi(2) * r.a11,
            a12: self.a0.powi(2) * r.a12 - 2. * self.a5 * self.a8 * r.a14 + 2. * self.a7 * self.a10 * r.a14 + self.a8.powi(2) * r.a12 - 2. * self.a8 * self.a9 * r.a11 - self.a9.powi(2) * r.a12 - 2. * self.a9 * self.a10 * r.a13 + self.a10.powi(2) * r.a12,
            a13: self.a0.powi(2) * r.a13 + 2. * self.a6 * self.a8 * r.a14 - 2. * self.a7 * self.a9 * r.a14 + self.a8.powi(2) * r.a13 - 2. * self.a8 * self.a10 * r.a11 + self.a9.powi(2) * r.a13 - 2. * self.a9 * self.a10 * r.a12 - self.a10.powi(2) * r.a13,
            a14: r.a14 * (self.a0.powi(2) - self.a8.powi(2) - self.a9.powi(2) - self.a10.powi(2)),
            a15: 0.,
        }
    }
}

impl Shl<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shl(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0.powi(2) * r.a0 - 2. * self.a0 * self.a8 * r.a8 - 2. * self.a0 * self.a9 * r.a9 - 2. * self.a0 * self.a10 * r.a10 - self.a8.powi(2) * r.a0 - self.a9.powi(2) * r.a0 - self.a10.powi(2) * r.a0,
            a1: self.a0.powi(2) * r.a1 + 2. * self.a0 * self.a8 * r.a11 + 2. * self.a0 * self.a9 * r.a12 + 2. * self.a0 * self.a10 * r.a13 - 2. * self.a5 * self.a8 * r.a3 + 2. * self.a5 * self.a9 * r.a4 + 2. * self.a6 * self.a8 * r.a2 - 2. * self.a6 * self.a10 * r.a4 - 2. * self.a7 * self.a9 * r.a2 + 2. * self.a7 * self.a10 * r.a3 - self.a8.powi(2) * r.a1 - self.a9.powi(2) * r.a1 - self.a10.powi(2) * r.a1,
            a2: self.a0.powi(2) * r.a2 - 2. * self.a0 * self.a10 * r.a14 + self.a8.powi(2) * r.a2 - 2. * self.a8 * self.a10 * r.a4 + self.a9.powi(2) * r.a2 - 2. * self.a9 * self.a10 * r.a3 - self.a10.powi(2) * r.a2,
            a3: self.a0.powi(2) * r.a3 - 2. * self.a0 * self.a9 * r.a14 + self.a8.powi(2) * r.a3 - 2. * self.a8 * self.a9 * r.a4 - self.a9.powi(2) * r.a3 - 2. * self.a9 * self.a10 * r.a2 + self.a10.powi(2) * r.a3,
            a4: self.a0.powi(2) * r.a4 - 2. * self.a0 * self.a8 * r.a14 - self.a8.powi(2) * r.a4 - 2. * self.a8 * self.a9 * r.a3 - 2. * self.a8 * self.a10 * r.a2 + self.a9.powi(2) * r.a4 + self.a10.powi(2) * r.a4,
            a5: self.a0.powi(2) * r.a5 + 2. * self.a0 * self.a5 * r.a0 - 2. * self.a0 * self.a10 * r.a15 - 2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 - self.a10.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a6 * r.a0 - 2. * self.a0 * self.a9 * r.a15 - 2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 + self.a10.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 + 2. * self.a0 * self.a7 * r.a0 - 2. * self.a0 * self.a8 * r.a15 - 2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 + self.a9.powi(2) * r.a7 + self.a10.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 + 2. * self.a0 * self.a8 * r.a0 - self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 + 2. * self.a0 * self.a9 * r.a0 + self.a8.powi(2) * r.a9 - 2. * self.a8 * self.a9 * r.a8 - self.a9.powi(2) * r.a9 - 2. * self.a9 * self.a10 * r.a10 + self.a10.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + 2. * self.a0 * self.a10 * r.a0 + self.a8.powi(2) * r.a10 - 2. * self.a8 * self.a10 * r.a8 + self.a9.powi(2) * r.a10 - 2. * self.a9 * self.a10 * r.a9 - self.a10.powi(2) * r.a10,
            a11: self.a0.powi(2) * r.a11 - 2. * self.a0 * self.a5 * r.a3 + 2. * self.a0 * self.a6 * r.a2 - 2. * self.a0 * self.a8 * r.a1 + 2. * self.a5 * self.a9 * r.a14 - 2. * self.a6 * self.a10 * r.a14 - self.a8.powi(2) * r.a11 - 2. * self.a8 * self.a9 * r.a12 - 2. * self.a8 * self.a10 * r.a13 + self.a9.powi(2) * r.a11 + self.a10.powi(2) * r.a11,
            a12: self.a0.powi(2) * r.a12 + 2. * self.a0 * self.a5 * r.a4 - 2. * self.a0 * self.a7 * r.a2 - 2. * self.a0 * self.a9 * r.a1 - 2. * self.a5 * self.a8 * r.a14 + 2. * self.a7 * self.a10 * r.a14 + self.a8.powi(2) * r.a12 - 2. * self.a8 * self.a9 * r.a11 - self.a9.powi(2) * r.a12 - 2. * self.a9 * self.a10 * r.a13 + self.a10.powi(2) * r.a12,
            a13: self.a0.powi(2) * r.a13 - 2. * self.a0 * self.a6 * r.a4 + 2. * self.a0 * self.a7 * r.a3 - 2. * self.a0 * self.a10 * r.a1 + 2. * self.a6 * self.a8 * r.a14 - 2. * self.a7 * self.a9 * r.a14 + self.a8.powi(2) * r.a13 - 2. * self.a8 * self.a10 * r.a11 + self.a9.powi(2) * r.a13 - 2. * self.a9 * self.a10 * r.a12 - self.a10.powi(2) * r.a13,
            a14: self.a0.powi(2) * r.a14 + 2. * self.a0 * self.a8 * r.a4 + 2. * self.a0 * self.a9 * r.a3 + 2. * self.a0 * self.a10 * r.a2 - self.a8.powi(2) * r.a14 - self.a9.powi(2) * r.a14 - self.a10.powi(2) * r.a14,
            a15: self.a0.powi(2) * r.a15 + 2. * self.a0 * self.a5 * r.a10 + 2. * self.a0 * self.a6 * r.a9 + 2. * self.a0 * self.a7 * r.a8 + 2. * self.a0 * self.a8 * r.a7 + 2. * self.a0 * self.a9 * r.a6 + 2. * self.a0 * self.a10 * r.a5 + 2. * self.a5 * self.a10 * r.a0 + 2. * self.a6 * self.a9 * r.a0 + 2. * self.a7 * self.a8 * r.a0 - self.a8.powi(2) * r.a15 - self.a9.powi(2) * r.a15 - self.a10.powi(2) * r.a15,
        }
    }
}

impl Shr<Float> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shr(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r * (self.a0.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -2. * r * (self.a5 * self.a10 + self.a6 * self.a9 + self.a7 * self.a8),
        }
    }
}

impl Shr<Vector> for ScalarAndBivector {
    type Output = Vector;

    fn shr(self, r: Vector) -> Vector {
        Vector {
            a1: self.a0.powi(2) * r.a1 + 2. * self.a0 * self.a5 * r.a2 + 2. * self.a0 * self.a6 * r.a3 + 2. * self.a0 * self.a7 * r.a4 + 2. * self.a5 * self.a8 * r.a3 - 2. * self.a5 * self.a9 * r.a4 - 2. * self.a6 * self.a8 * r.a2 + 2. * self.a6 * self.a10 * r.a4 + 2. * self.a7 * self.a9 * r.a2 - 2. * self.a7 * self.a10 * r.a3 + self.a8.powi(2) * r.a1 + self.a9.powi(2) * r.a1 + self.a10.powi(2) * r.a1,
            a2: self.a0 * (self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4) + self.a8 * (self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4) - self.a9 * (self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3) + self.a10 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2),
            a3: self.a0 * (self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4) - self.a8 * (self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4) + self.a9 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + self.a10 * (self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3),
            a4: self.a0 * (self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3) + self.a8 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + self.a9 * (self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4) - self.a10 * (self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4),
        }
    }
}

impl Shr<Bivector> for ScalarAndBivector {
    type Output = Bivector;

    fn shr(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a0.powi(2) * r.a5 - 2. * self.a0 * self.a6 * r.a8 + 2. * self.a0 * self.a7 * r.a9 + 2. * self.a0 * self.a8 * r.a6 - 2. * self.a0 * self.a9 * r.a7 + 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 + self.a10.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a5 * r.a8 - 2. * self.a0 * self.a7 * r.a10 - 2. * self.a0 * self.a8 * r.a5 + 2. * self.a0 * self.a10 * r.a7 + 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a0 * self.a5 * r.a9 + 2. * self.a0 * self.a6 * r.a10 + 2. * self.a0 * self.a9 * r.a5 - 2. * self.a0 * self.a10 * r.a6 + 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 - self.a10.powi(2) * r.a7,
            a8: self.a0 * (self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9) + self.a8 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + self.a9 * (self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8) - self.a10 * (self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8),
            a9: self.a0 * (self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8) - self.a8 * (self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8) + self.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + self.a10 * (self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9),
            a10: self.a0 * (self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8) + self.a8 * (self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8) - self.a9 * (self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9) + self.a10 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10),
        }
    }
}

impl Shr<ScalarAndBivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shr(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0 * (self.a0.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0.powi(2) * r.a5 - 2. * self.a0 * self.a6 * r.a8 + 2. * self.a0 * self.a7 * r.a9 + 2. * self.a0 * self.a8 * r.a6 - 2. * self.a0 * self.a9 * r.a7 + 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 + self.a10.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a5 * r.a8 - 2. * self.a0 * self.a7 * r.a10 - 2. * self.a0 * self.a8 * r.a5 + 2. * self.a0 * self.a10 * r.a7 + 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a0 * self.a5 * r.a9 + 2. * self.a0 * self.a6 * r.a10 + 2. * self.a0 * self.a9 * r.a5 - 2. * self.a0 * self.a10 * r.a6 + 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 - self.a10.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 + 2. * self.a0 * self.a9 * r.a10 - 2. * self.a0 * self.a10 * r.a9 + self.a8.powi(2) * r.a8 + 2. * self.a8 * self.a9 * r.a9 + 2. * self.a8 * self.a10 * r.a10 - self.a9.powi(2) * r.a8 - self.a10.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 - 2. * self.a0 * self.a8 * r.a10 + 2. * self.a0 * self.a10 * r.a8 - self.a8.powi(2) * r.a9 + 2. * self.a8 * self.a9 * r.a8 + self.a9.powi(2) * r.a9 + 2. * self.a9 * self.a10 * r.a10 - self.a10.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + 2. * self.a0 * self.a8 * r.a9 - 2. * self.a0 * self.a9 * r.a8 - self.a8.powi(2) * r.a10 + 2. * self.a8 * self.a10 * r.a8 - self.a9.powi(2) * r.a10 + 2. * self.a9 * self.a10 * r.a9 + self.a10.powi(2) * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -2. * r.a0 * (self.a5 * self.a10 + self.a6 * self.a9 + self.a7 * self.a8),
        }
    }
}

impl Shr<Trivector> for ScalarAndBivector {
    type Output = Trivector;

    fn shr(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a0.powi(2) * r.a11 - 2. * self.a0 * self.a7 * r.a14 + 2. * self.a0 * self.a9 * r.a13 - 2. * self.a0 * self.a10 * r.a12 - 2. * self.a5 * self.a9 * r.a14 + 2. * self.a6 * self.a10 * r.a14 + self.a8.powi(2) * r.a11 + 2. * self.a8 * self.a9 * r.a12 + 2. * self.a8 * self.a10 * r.a13 - self.a9.powi(2) * r.a11 - self.a10.powi(2) * r.a11,
            a12: self.a0.powi(2) * r.a12 - 2. * self.a0 * self.a6 * r.a14 - 2. * self.a0 * self.a8 * r.a13 + 2. * self.a0 * self.a10 * r.a11 + 2. * self.a5 * self.a8 * r.a14 - 2. * self.a7 * self.a10 * r.a14 - self.a8.powi(2) * r.a12 + 2. * self.a8 * self.a9 * r.a11 + self.a9.powi(2) * r.a12 + 2. * self.a9 * self.a10 * r.a13 - self.a10.powi(2) * r.a12,
            a13: self.a0.powi(2) * r.a13 - 2. * self.a0 * self.a5 * r.a14 + 2. * self.a0 * self.a8 * r.a12 - 2. * self.a0 * self.a9 * r.a11 - 2. * self.a6 * self.a8 * r.a14 + 2. * self.a7 * self.a9 * r.a14 - self.a8.powi(2) * r.a13 + 2. * self.a8 * self.a10 * r.a11 - self.a9.powi(2) * r.a13 + 2. * self.a9 * self.a10 * r.a12 + self.a10.powi(2) * r.a13,
            a14: r.a14 * (self.a0.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
        }
    }
}

impl Shr<FullMultivector> for ScalarAndBivector {
    type Output = FullMultivector;

    fn shr(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0 * (self.a0.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a1: self.a0.powi(2) * r.a1 + 2. * self.a0 * self.a5 * r.a2 + 2. * self.a0 * self.a6 * r.a3 + 2. * self.a0 * self.a7 * r.a4 + 2. * self.a5 * self.a8 * r.a3 - 2. * self.a5 * self.a9 * r.a4 - 2. * self.a6 * self.a8 * r.a2 + 2. * self.a6 * self.a10 * r.a4 + 2. * self.a7 * self.a9 * r.a2 - 2. * self.a7 * self.a10 * r.a3 + self.a8.powi(2) * r.a1 + self.a9.powi(2) * r.a1 + self.a10.powi(2) * r.a1,
            a2: self.a0.powi(2) * r.a2 + 2. * self.a0 * self.a8 * r.a3 - 2. * self.a0 * self.a9 * r.a4 - self.a8.powi(2) * r.a2 + 2. * self.a8 * self.a10 * r.a4 - self.a9.powi(2) * r.a2 + 2. * self.a9 * self.a10 * r.a3 + self.a10.powi(2) * r.a2,
            a3: self.a0.powi(2) * r.a3 - 2. * self.a0 * self.a8 * r.a2 + 2. * self.a0 * self.a10 * r.a4 - self.a8.powi(2) * r.a3 + 2. * self.a8 * self.a9 * r.a4 + self.a9.powi(2) * r.a3 + 2. * self.a9 * self.a10 * r.a2 - self.a10.powi(2) * r.a3,
            a4: self.a0.powi(2) * r.a4 + 2. * self.a0 * self.a9 * r.a2 - 2. * self.a0 * self.a10 * r.a3 + self.a8.powi(2) * r.a4 + 2. * self.a8 * self.a9 * r.a3 + 2. * self.a8 * self.a10 * r.a2 - self.a9.powi(2) * r.a4 - self.a10.powi(2) * r.a4,
            a5: self.a0.powi(2) * r.a5 - 2. * self.a0 * self.a6 * r.a8 + 2. * self.a0 * self.a7 * r.a9 + 2. * self.a0 * self.a8 * r.a6 - 2. * self.a0 * self.a9 * r.a7 + 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 + self.a10.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a5 * r.a8 - 2. * self.a0 * self.a7 * r.a10 - 2. * self.a0 * self.a8 * r.a5 + 2. * self.a0 * self.a10 * r.a7 + 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a0 * self.a5 * r.a9 + 2. * self.a0 * self.a6 * r.a10 + 2. * self.a0 * self.a9 * r.a5 - 2. * self.a0 * self.a10 * r.a6 + 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 - self.a10.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 + 2. * self.a0 * self.a9 * r.a10 - 2. * self.a0 * self.a10 * r.a9 + self.a8.powi(2) * r.a8 + 2. * self.a8 * self.a9 * r.a9 + 2. * self.a8 * self.a10 * r.a10 - self.a9.powi(2) * r.a8 - self.a10.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 - 2. * self.a0 * self.a8 * r.a10 + 2. * self.a0 * self.a10 * r.a8 - self.a8.powi(2) * r.a9 + 2. * self.a8 * self.a9 * r.a8 + self.a9.powi(2) * r.a9 + 2. * self.a9 * self.a10 * r.a10 - self.a10.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + 2. * self.a0 * self.a8 * r.a9 - 2. * self.a0 * self.a9 * r.a8 - self.a8.powi(2) * r.a10 + 2. * self.a8 * self.a10 * r.a8 - self.a9.powi(2) * r.a10 + 2. * self.a9 * self.a10 * r.a9 + self.a10.powi(2) * r.a10,
            a11: self.a0.powi(2) * r.a11 - 2. * self.a0 * self.a7 * r.a14 + 2. * self.a0 * self.a9 * r.a13 - 2. * self.a0 * self.a10 * r.a12 - 2. * self.a5 * self.a9 * r.a14 + 2. * self.a6 * self.a10 * r.a14 + self.a8.powi(2) * r.a11 + 2. * self.a8 * self.a9 * r.a12 + 2. * self.a8 * self.a10 * r.a13 - self.a9.powi(2) * r.a11 - self.a10.powi(2) * r.a11,
            a12: self.a0.powi(2) * r.a12 - 2. * self.a0 * self.a6 * r.a14 - 2. * self.a0 * self.a8 * r.a13 + 2. * self.a0 * self.a10 * r.a11 + 2. * self.a5 * self.a8 * r.a14 - 2. * self.a7 * self.a10 * r.a14 - self.a8.powi(2) * r.a12 + 2. * self.a8 * self.a9 * r.a11 + self.a9.powi(2) * r.a12 + 2. * self.a9 * self.a10 * r.a13 - self.a10.powi(2) * r.a12,
            a13: self.a0.powi(2) * r.a13 - 2. * self.a0 * self.a5 * r.a14 + 2. * self.a0 * self.a8 * r.a12 - 2. * self.a0 * self.a9 * r.a11 - 2. * self.a6 * self.a8 * r.a14 + 2. * self.a7 * self.a9 * r.a14 - self.a8.powi(2) * r.a13 + 2. * self.a8 * self.a10 * r.a11 - self.a9.powi(2) * r.a13 + 2. * self.a9 * self.a10 * r.a12 + self.a10.powi(2) * r.a13,
            a14: r.a14 * (self.a0.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2)),
            a15: self.a0.powi(2) * r.a15 - 2. * self.a5 * self.a10 * r.a0 - 2. * self.a6 * self.a9 * r.a0 - 2. * self.a7 * self.a8 * r.a0 + self.a8.powi(2) * r.a15 + self.a9.powi(2) * r.a15 + self.a10.powi(2) * r.a15,
        }
    }
}

// ===========================================================================
// Trivector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct Trivector {
    a11: Float,
    a12: Float,
    a13: Float,
    a14: Float,
}

impl Multivector for Trivector {
    type Dual = Vector;

    fn reverse(self) -> Trivector {
        Trivector {
            a11: -self.a11,
            a12: -self.a12,
            a13: -self.a13,
            a14: -self.a14,
        }
    }

    fn dual(self) -> Vector {
        Vector {
            a1: self.a14,
            a2: self.a13,
            a3: self.a12,
            a4: self.a11,
        }
    }

    fn conjugate(self) -> Trivector {
        Trivector {
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
        }
    }

    fn norm(self) -> Float {
        self.a14.abs()
    }

    fn inorm(self) -> Float {
        (self.a11.powi(2) + self.a12.powi(2) + self.a13.powi(2)).sqrt()
    }

    fn scalar(self) -> Float {
        0.
    }

    fn vector(self) -> Vector {
        Vector {
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
        }
    }

    fn bivector(self) -> Bivector {
        Bivector {
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }

    fn trivector(self) -> Trivector {
        Trivector {
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
        }
    }

    fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Neg for Trivector {
    type Output = Trivector;

    fn neg(self) -> Trivector {
        Trivector {
            a11: -self.a11,
            a12: -self.a12,
            a13: -self.a13,
            a14: -self.a14,
        }
    }
}

impl Add<Float> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Add<Vector> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Add<Bivector> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Add<ScalarAndBivector> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Add<Trivector> for Trivector {
    type Output = Trivector;

    fn add(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a11 + r.a11,
            a12: self.a12 + r.a12,
            a13: self.a13 + r.a13,
            a14: self.a14 + r.a14,
        }
    }
}

impl Add<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0,
            a1: r.a1,
            a2: r.a2,
            a3: r.a3,
            a4: r.a4,
            a5: r.a5,
            a6: r.a6,
            a7: r.a7,
            a8: r.a8,
            a9: r.a9,
            a10: r.a10,
            a11: self.a11 + r.a11,
            a12: self.a12 + r.a12,
            a13: self.a13 + r.a13,
            a14: self.a14 + r.a14,
            a15: r.a15,
        }
    }
}

impl Sub<Float> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: -r,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Sub<Vector> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Sub<Bivector> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Sub<ScalarAndBivector> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: 0.,
        }
    }
}

impl Sub<Trivector> for Trivector {
    type Output = Trivector;

    fn sub(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a11 - r.a11,
            a12: self.a12 - r.a12,
            a13: self.a13 - r.a13,
            a14: self.a14 - r.a14,
        }
    }
}

impl Sub<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -r.a0,
            a1: -r.a1,
            a2: -r.a2,
            a3: -r.a3,
            a4: -r.a4,
            a5: -r.a5,
            a6: -r.a6,
            a7: -r.a7,
            a8: -r.a8,
            a9: -r.a9,
            a10: -r.a10,
            a11: self.a11 - r.a11,
            a12: self.a12 - r.a12,
            a13: self.a13 - r.a13,
            a14: self.a14 - r.a14,
            a15: -r.a15,
        }
    }
}

impl Mul<Float> for Trivector {
    type Output = Trivector;

    fn mul(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
        }
    }
}

impl Mul<Vector> for Trivector {
    type Output = FullMultivector;

    fn mul(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a11 * r.a2 - self.a13 * r.a4,
            a7: -self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl Mul<Bivector> for Trivector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a11 * r.a10 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: self.a11 * r.a9 - self.a12 * r.a8 + self.a14 * r.a5,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl Mul<ScalarAndBivector> for Trivector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11 * r.a0 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a11 * r.a10 + self.a12 * r.a0 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: self.a11 * r.a9 - self.a12 * r.a8 + self.a13 * r.a0 + self.a14 * r.a5,
            a14: self.a14 * r.a0,
            a15: 0.,
        }
    }
}

impl Mul<Trivector> for Trivector {
    type Output = ScalarAndBivector;

    fn mul(self, r: Trivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a14 * r.a14,
            a5: self.a13 * r.a14 - self.a14 * r.a13,
            a6: self.a12 * r.a14 - self.a14 * r.a12,
            a7: self.a11 * r.a14 - self.a14 * r.a11,
            a8: 0.,
            a9: 0.,
            a10: 0.,
        }
    }
}

impl Mul<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14 * r.a14,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: -self.a11 * r.a3 + self.a12 * r.a4 + self.a13 * r.a14 - self.a14 * r.a13,
            a6: self.a11 * r.a2 + self.a12 * r.a14 - self.a13 * r.a4 - self.a14 * r.a12,
            a7: self.a11 * r.a14 - self.a12 * r.a2 + self.a13 * r.a3 - self.a14 * r.a11,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
            a11: self.a11 * r.a0 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a11 * r.a10 + self.a12 * r.a0 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: self.a11 * r.a9 - self.a12 * r.a8 + self.a13 * r.a0 + self.a14 * r.a5,
            a14: self.a14 * r.a0,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl BitXor<Float> for Trivector {
    type Output = Trivector;

    fn bitxor(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
        }
    }
}

impl BitXor<Vector> for Trivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl BitXor<Bivector> for Trivector {
    type Output = Float;

    fn bitxor(self, _r: Bivector) -> Float {
        0.
    }
}

impl BitXor<ScalarAndBivector> for Trivector {
    type Output = Trivector;

    fn bitxor(self, r: ScalarAndBivector) -> Trivector {
        Trivector {
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
        }
    }
}

impl BitXor<Trivector> for Trivector {
    type Output = Float;

    fn bitxor(self, _r: Trivector) -> Float {
        0.
    }
}

impl BitXor<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl BitAnd<Float> for Trivector {
    type Output = Float;

    fn bitand(self, _r: Float) -> Float {
        0.
    }
}

impl BitAnd<Vector> for Trivector {
    type Output = Float;

    fn bitand(self, r: Vector) -> Float {
        self.a11 * r.a4 + self.a12 * r.a3 + self.a13 * r.a2 + self.a14 * r.a1
    }
}

impl BitAnd<Bivector> for Trivector {
    type Output = Vector;

    fn bitand(self, r: Bivector) -> Vector {
        Vector {
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
        }
    }
}

impl BitAnd<ScalarAndBivector> for Trivector {
    type Output = Vector;

    fn bitand(self, r: ScalarAndBivector) -> Vector {
        Vector {
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
        }
    }
}

impl BitAnd<Trivector> for Trivector {
    type Output = Bivector;

    fn bitand(self, r: Trivector) -> Bivector {
        Bivector {
            a5: -self.a11 * r.a12 + self.a12 * r.a11,
            a6: self.a11 * r.a13 - self.a13 * r.a11,
            a7: -self.a12 * r.a13 + self.a13 * r.a12,
            a8: -self.a11 * r.a14 + self.a14 * r.a11,
            a9: -self.a12 * r.a14 + self.a14 * r.a12,
            a10: -self.a13 * r.a14 + self.a14 * r.a13,
        }
    }
}

impl BitAnd<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a11 * r.a4 + self.a12 * r.a3 + self.a13 * r.a2 + self.a14 * r.a1,
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
            a5: -self.a11 * r.a12 + self.a12 * r.a11,
            a6: self.a11 * r.a13 - self.a13 * r.a11,
            a7: -self.a12 * r.a13 + self.a13 * r.a12,
            a8: -self.a11 * r.a14 + self.a14 * r.a11,
            a9: -self.a12 * r.a14 + self.a14 * r.a12,
            a10: -self.a13 * r.a14 + self.a14 * r.a13,
            a11: self.a11 * r.a15,
            a12: self.a12 * r.a15,
            a13: self.a13 * r.a15,
            a14: self.a14 * r.a15,
            a15: 0.,
        }
    }
}

impl BitOr<Float> for Trivector {
    type Output = Trivector;

    fn bitor(self, r: Float) -> Trivector {
        Trivector {
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
        }
    }
}

impl BitOr<Vector> for Trivector {
    type Output = Bivector;

    fn bitor(self, r: Vector) -> Bivector {
        Bivector {
            a5: -self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a11 * r.a2 - self.a13 * r.a4,
            a7: -self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
        }
    }
}

impl BitOr<Bivector> for Trivector {
    type Output = Vector;

    fn bitor(self, r: Bivector) -> Vector {
        Vector {
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
        }
    }
}

impl BitOr<ScalarAndBivector> for Trivector {
    type Output = FullMultivector;

    fn bitor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
            a15: 0.,
        }
    }
}

impl BitOr<Trivector> for Trivector {
    type Output = Float;

    fn bitor(self, r: Trivector) -> Float {
        -self.a14 * r.a14
    }
}

impl BitOr<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14 * r.a14,
            a1: self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15,
            a2: -self.a14 * r.a10,
            a3: -self.a14 * r.a9,
            a4: -self.a14 * r.a8,
            a5: -self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a11 * r.a2 - self.a13 * r.a4,
            a7: -self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
            a15: 0.,
        }
    }
}

impl Shl<Float> for Trivector {
    type Output = Float;

    fn shl(self, r: Float) -> Float {
        -self.a14.powi(2) * r
    }
}

impl Shl<Vector> for Trivector {
    type Output = Vector;

    fn shl(self, r: Vector) -> Vector {
        Vector {
            a1: self.a14 * (2. * self.a11 * r.a4 + 2. * self.a12 * r.a3 + 2. * self.a13 * r.a2 + self.a14 * r.a1),
            a2: -self.a14.powi(2) * r.a2,
            a3: -self.a14.powi(2) * r.a3,
            a4: -self.a14.powi(2) * r.a4,
        }
    }
}

impl Shl<Bivector> for Trivector {
    type Output = Bivector;

    fn shl(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a14 * (2. * self.a11 * r.a9 - 2. * self.a12 * r.a8 + self.a14 * r.a5),
            a6: self.a14 * (-2. * self.a11 * r.a10 + 2. * self.a13 * r.a8 + self.a14 * r.a6),
            a7: self.a14 * (2. * self.a12 * r.a10 - 2. * self.a13 * r.a9 + self.a14 * r.a7),
            a8: -self.a14.powi(2) * r.a8,
            a9: -self.a14.powi(2) * r.a9,
            a10: -self.a14.powi(2) * r.a10,
        }
    }
}

impl Shl<ScalarAndBivector> for Trivector {
    type Output = ScalarAndBivector;

    fn shl(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: -self.a14.powi(2) * r.a0,
            a5: self.a14 * (2. * self.a11 * r.a9 - 2. * self.a12 * r.a8 + self.a14 * r.a5),
            a6: self.a14 * (-2. * self.a11 * r.a10 + 2. * self.a13 * r.a8 + self.a14 * r.a6),
            a7: self.a14 * (2. * self.a12 * r.a10 - 2. * self.a13 * r.a9 + self.a14 * r.a7),
            a8: -self.a14.powi(2) * r.a8,
            a9: -self.a14.powi(2) * r.a9,
            a10: -self.a14.powi(2) * r.a10,
        }
    }
}

impl Shl<Trivector> for Trivector {
    type Output = Trivector;

    fn shl(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a14 * (-2. * self.a11 * r.a14 + self.a14 * r.a11),
            a12: self.a14 * (-2. * self.a12 * r.a14 + self.a14 * r.a12),
            a13: self.a14 * (-2. * self.a13 * r.a14 + self.a14 * r.a13),
            a14: -self.a14.powi(2) * r.a14,
        }
    }
}

impl Shl<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn shl(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14.powi(2) * r.a0,
            a1: self.a14 * (2. * self.a11 * r.a4 + 2. * self.a12 * r.a3 + 2. * self.a13 * r.a2 + self.a14 * r.a1),
            a2: -self.a14.powi(2) * r.a2,
            a3: -self.a14.powi(2) * r.a3,
            a4: -self.a14.powi(2) * r.a4,
            a5: self.a14 * (2. * self.a11 * r.a9 - 2. * self.a12 * r.a8 + self.a14 * r.a5),
            a6: self.a14 * (-2. * self.a11 * r.a10 + 2. * self.a13 * r.a8 + self.a14 * r.a6),
            a7: self.a14 * (2. * self.a12 * r.a10 - 2. * self.a13 * r.a9 + self.a14 * r.a7),
            a8: -self.a14.powi(2) * r.a8,
            a9: -self.a14.powi(2) * r.a9,
            a10: -self.a14.powi(2) * r.a10,
            a11: self.a14 * (-2. * self.a11 * r.a14 + self.a14 * r.a11),
            a12: self.a14 * (-2. * self.a12 * r.a14 + self.a14 * r.a12),
            a13: self.a14 * (-2. * self.a13 * r.a14 + self.a14 * r.a13),
            a14: -self.a14.powi(2) * r.a14,
            a15: self.a14.powi(2) * r.a15,
        }
    }
}

impl Shr<Float> for Trivector {
    type Output = Float;

    fn shr(self, r: Float) -> Float {
        self.a14.powi(2) * r
    }
}

impl Shr<Vector> for Trivector {
    type Output = Vector;

    fn shr(self, r: Vector) -> Vector {
        Vector {
            a1: -self.a14 * (2. * self.a11 * r.a4 + 2. * self.a12 * r.a3 + 2. * self.a13 * r.a2 + self.a14 * r.a1),
            a2: self.a14.powi(2) * r.a2,
            a3: self.a14.powi(2) * r.a3,
            a4: self.a14.powi(2) * r.a4,
        }
    }
}

impl Shr<Bivector> for Trivector {
    type Output = Bivector;

    fn shr(self, r: Bivector) -> Bivector {
        Bivector {
            a5: self.a14 * (-2. * self.a11 * r.a9 + 2. * self.a12 * r.a8 - self.a14 * r.a5),
            a6: self.a14 * (2. * self.a11 * r.a10 - 2. * self.a13 * r.a8 - self.a14 * r.a6),
            a7: self.a14 * (-2. * self.a12 * r.a10 + 2. * self.a13 * r.a9 - self.a14 * r.a7),
            a8: self.a14.powi(2) * r.a8,
            a9: self.a14.powi(2) * r.a9,
            a10: self.a14.powi(2) * r.a10,
        }
    }
}

impl Shr<ScalarAndBivector> for Trivector {
    type Output = ScalarAndBivector;

    fn shr(self, r: ScalarAndBivector) -> ScalarAndBivector {
        ScalarAndBivector {
            a0: self.a14.powi(2) * r.a0,
            a5: self.a14 * (-2. * self.a11 * r.a9 + 2. * self.a12 * r.a8 - self.a14 * r.a5),
            a6: self.a14 * (2. * self.a11 * r.a10 - 2. * self.a13 * r.a8 - self.a14 * r.a6),
            a7: self.a14 * (-2. * self.a12 * r.a10 + 2. * self.a13 * r.a9 - self.a14 * r.a7),
            a8: self.a14.powi(2) * r.a8,
            a9: self.a14.powi(2) * r.a9,
            a10: self.a14.powi(2) * r.a10,
        }
    }
}

impl Shr<Trivector> for Trivector {
    type Output = Trivector;

    fn shr(self, r: Trivector) -> Trivector {
        Trivector {
            a11: self.a14 * (2. * self.a11 * r.a14 - self.a14 * r.a11),
            a12: self.a14 * (2. * self.a12 * r.a14 - self.a14 * r.a12),
            a13: self.a14 * (2. * self.a13 * r.a14 - self.a14 * r.a13),
            a14: self.a14.powi(2) * r.a14,
        }
    }
}

impl Shr<FullMultivector> for Trivector {
    type Output = FullMultivector;

    fn shr(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a14.powi(2) * r.a0,
            a1: -self.a14 * (2. * self.a11 * r.a4 + 2. * self.a12 * r.a3 + 2. * self.a13 * r.a2 + self.a14 * r.a1),
            a2: self.a14.powi(2) * r.a2,
            a3: self.a14.powi(2) * r.a3,
            a4: self.a14.powi(2) * r.a4,
            a5: self.a14 * (-2. * self.a11 * r.a9 + 2. * self.a12 * r.a8 - self.a14 * r.a5),
            a6: self.a14 * (2. * self.a11 * r.a10 - 2. * self.a13 * r.a8 - self.a14 * r.a6),
            a7: self.a14 * (-2. * self.a12 * r.a10 + 2. * self.a13 * r.a9 - self.a14 * r.a7),
            a8: self.a14.powi(2) * r.a8,
            a9: self.a14.powi(2) * r.a9,
            a10: self.a14.powi(2) * r.a10,
            a11: self.a14 * (2. * self.a11 * r.a14 - self.a14 * r.a11),
            a12: self.a14 * (2. * self.a12 * r.a14 - self.a14 * r.a12),
            a13: self.a14 * (2. * self.a13 * r.a14 - self.a14 * r.a13),
            a14: self.a14.powi(2) * r.a14,
            a15: -self.a14.powi(2) * r.a15,
        }
    }
}

// ===========================================================================
// FullMultivector
// ===========================================================================


#[derive(Default,Debug,Clone,Copy,PartialEq)]
pub struct FullMultivector {
    a0: Float,
    a1: Float,
    a2: Float,
    a3: Float,
    a4: Float,
    a5: Float,
    a6: Float,
    a7: Float,
    a8: Float,
    a9: Float,
    a10: Float,
    a11: Float,
    a12: Float,
    a13: Float,
    a14: Float,
    a15: Float,
}

impl Multivector for FullMultivector {
    type Dual = FullMultivector;

    fn reverse(self) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
            a11: -self.a11,
            a12: -self.a12,
            a13: -self.a13,
            a14: -self.a14,
            a15: self.a15,
        }
    }

    fn dual(self) -> FullMultivector {
        FullMultivector {
            a0: self.a15,
            a1: self.a14,
            a2: self.a13,
            a3: self.a12,
            a4: self.a11,
            a5: self.a10,
            a6: self.a9,
            a7: self.a8,
            a8: self.a7,
            a9: self.a6,
            a10: self.a5,
            a11: self.a4,
            a12: self.a3,
            a13: self.a2,
            a14: self.a1,
            a15: self.a0,
        }
    }

    fn conjugate(self) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: -self.a1,
            a2: -self.a2,
            a3: -self.a3,
            a4: -self.a4,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }

    fn norm(self) -> Float {
        (self.a0.powi(2) + self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2) + self.a14.powi(2)).sqrt()
    }

    fn inorm(self) -> Float {
        (self.a1.powi(2) + self.a5.powi(2) + self.a6.powi(2) + self.a7.powi(2) + self.a11.powi(2) + self.a12.powi(2) + self.a13.powi(2) + self.a15.powi(2)).sqrt()
    }

    fn scalar(self) -> Float {
        self.a0
    }

    fn vector(self) -> Vector {
        Vector {
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
        }
    }

    fn bivector(self) -> Bivector {
        Bivector {
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
        }
    }

    fn trivector(self) -> Trivector {
        Trivector {
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
        }
    }

    fn full_multivector(self) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Neg for FullMultivector {
    type Output = FullMultivector;

    fn neg(self) -> FullMultivector {
        FullMultivector {
            a0: -self.a0,
            a1: -self.a1,
            a2: -self.a2,
            a3: -self.a3,
            a4: -self.a4,
            a5: -self.a5,
            a6: -self.a6,
            a7: -self.a7,
            a8: -self.a8,
            a9: -self.a9,
            a10: -self.a10,
            a11: -self.a11,
            a12: -self.a12,
            a13: -self.a13,
            a14: -self.a14,
            a15: -self.a15,
        }
    }
}

impl Add<Float> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 + r,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Add<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1 + r.a1,
            a2: self.a2 + r.a2,
            a3: self.a3 + r.a3,
            a4: self.a4 + r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Add<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Add<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 + r.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Add<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11 + r.a11,
            a12: self.a12 + r.a12,
            a13: self.a13 + r.a13,
            a14: self.a14 + r.a14,
            a15: self.a15,
        }
    }
}

impl Add<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn add(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 + r.a0,
            a1: self.a1 + r.a1,
            a2: self.a2 + r.a2,
            a3: self.a3 + r.a3,
            a4: self.a4 + r.a4,
            a5: self.a5 + r.a5,
            a6: self.a6 + r.a6,
            a7: self.a7 + r.a7,
            a8: self.a8 + r.a8,
            a9: self.a9 + r.a9,
            a10: self.a10 + r.a10,
            a11: self.a11 + r.a11,
            a12: self.a12 + r.a12,
            a13: self.a13 + r.a13,
            a14: self.a14 + r.a14,
            a15: self.a15 + r.a15,
        }
    }
}

impl Sub<Float> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 - r,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Sub<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1 - r.a1,
            a2: self.a2 - r.a2,
            a3: self.a3 - r.a3,
            a4: self.a4 - r.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Sub<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Sub<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 - r.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: self.a11,
            a12: self.a12,
            a13: self.a13,
            a14: self.a14,
            a15: self.a15,
        }
    }
}

impl Sub<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0,
            a1: self.a1,
            a2: self.a2,
            a3: self.a3,
            a4: self.a4,
            a5: self.a5,
            a6: self.a6,
            a7: self.a7,
            a8: self.a8,
            a9: self.a9,
            a10: self.a10,
            a11: self.a11 - r.a11,
            a12: self.a12 - r.a12,
            a13: self.a13 - r.a13,
            a14: self.a14 - r.a14,
            a15: self.a15,
        }
    }
}

impl Sub<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn sub(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 - r.a0,
            a1: self.a1 - r.a1,
            a2: self.a2 - r.a2,
            a3: self.a3 - r.a3,
            a4: self.a4 - r.a4,
            a5: self.a5 - r.a5,
            a6: self.a6 - r.a6,
            a7: self.a7 - r.a7,
            a8: self.a8 - r.a8,
            a9: self.a9 - r.a9,
            a10: self.a10 - r.a10,
            a11: self.a11 - r.a11,
            a12: self.a12 - r.a12,
            a13: self.a13 - r.a13,
            a14: self.a14 - r.a14,
            a15: self.a15 - r.a15,
        }
    }
}

impl Mul<Float> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r,
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
            a15: self.a15 * r,
        }
    }
}

impl Mul<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4,
            a3: self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: self.a1 * r.a2 - self.a2 * r.a1 - self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a1 * r.a3 - self.a3 * r.a1 + self.a11 * r.a2 - self.a13 * r.a4,
            a7: self.a1 * r.a4 - self.a4 * r.a1 - self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a2 * r.a3 - self.a3 * r.a2 + self.a14 * r.a4,
            a9: -self.a2 * r.a4 + self.a4 * r.a2 + self.a14 * r.a3,
            a10: self.a3 * r.a4 - self.a4 * r.a3 + self.a14 * r.a2,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1 - self.a15 * r.a4,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1 - self.a15 * r.a3,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1 - self.a15 * r.a2,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl Mul<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: -self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10,
            a3: self.a2 * r.a8 - self.a4 * r.a10 - self.a14 * r.a9,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 - self.a14 * r.a8,
            a5: self.a0 * r.a5 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a5 * r.a8 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7 - self.a15 * r.a9,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a9 * r.a5 - self.a10 * r.a6 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5 - self.a11 * r.a10 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6 + self.a11 * r.a9 - self.a12 * r.a8 + self.a14 * r.a5,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl Mul<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a14 * r.a9,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a14 * r.a8,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 + self.a10 * r.a7 - self.a15 * r.a9,
            a7: self.a0 * r.a7 - self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 + self.a9 * r.a5 - self.a10 * r.a6 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9,
            a9: self.a0 * r.a9 - self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8,
            a10: self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a11 * r.a0 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5 - self.a11 * r.a10 + self.a12 * r.a0 + self.a13 * r.a8 + self.a14 * r.a6,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6 + self.a11 * r.a9 - self.a12 * r.a8 + self.a13 * r.a0 + self.a14 * r.a5,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8 + self.a14 * r.a0,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 + self.a15 * r.a0,
        }
    }
}

impl Mul<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14 * r.a14,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 - self.a15 * r.a14,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: -self.a3 * r.a11 + self.a4 * r.a12 + self.a13 * r.a14 - self.a14 * r.a13,
            a6: self.a2 * r.a11 - self.a4 * r.a13 + self.a12 * r.a14 - self.a14 * r.a12,
            a7: -self.a2 * r.a12 + self.a3 * r.a13 + self.a11 * r.a14 - self.a14 * r.a11,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
            a11: self.a0 * r.a11 - self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a12: self.a0 * r.a12 - self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a13: self.a0 * r.a13 - self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a14: self.a0 * r.a14,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl Mul<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn mul(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 + self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10 - self.a14 * r.a14,
            a1: self.a0 * r.a1 + self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15 - self.a15 * r.a14,
            a2: self.a0 * r.a2 + self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14 - self.a14 * r.a10,
            a3: self.a0 * r.a3 + self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4 - self.a14 * r.a9,
            a4: self.a0 * r.a4 - self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3 - self.a14 * r.a8,
            a5: self.a0 * r.a5 + self.a1 * r.a2 - self.a2 * r.a1 - self.a3 * r.a11 + self.a4 * r.a12 + self.a5 * r.a0 - self.a6 * r.a8 + self.a7 * r.a9 + self.a8 * r.a6 - self.a9 * r.a7 - self.a10 * r.a15 - self.a11 * r.a3 + self.a12 * r.a4 + self.a13 * r.a14 - self.a14 * r.a13 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a1 * r.a3 + self.a2 * r.a11 - self.a3 * r.a1 - self.a4 * r.a13 + self.a5 * r.a8 + self.a6 * r.a0 - self.a7 * r.a10 - self.a8 * r.a5 - self.a9 * r.a15 + self.a10 * r.a7 + self.a11 * r.a2 + self.a12 * r.a14 - self.a13 * r.a4 - self.a14 * r.a12 - self.a15 * r.a9,
            a7: self.a0 * r.a7 + self.a1 * r.a4 - self.a2 * r.a12 + self.a3 * r.a13 - self.a4 * r.a1 - self.a5 * r.a9 + self.a6 * r.a10 + self.a7 * r.a0 - self.a8 * r.a15 + self.a9 * r.a5 - self.a10 * r.a6 + self.a11 * r.a14 - self.a12 * r.a2 + self.a13 * r.a3 - self.a14 * r.a11 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a2 * r.a3 - self.a3 * r.a2 + self.a4 * r.a14 + self.a8 * r.a0 + self.a9 * r.a10 - self.a10 * r.a9 + self.a14 * r.a4,
            a9: self.a0 * r.a9 - self.a2 * r.a4 + self.a3 * r.a14 + self.a4 * r.a2 - self.a8 * r.a10 + self.a9 * r.a0 + self.a10 * r.a8 + self.a14 * r.a3,
            a10: self.a0 * r.a10 + self.a2 * r.a14 + self.a3 * r.a4 - self.a4 * r.a3 + self.a8 * r.a9 - self.a9 * r.a8 + self.a10 * r.a0 + self.a14 * r.a2,
            a11: self.a0 * r.a11 - self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a4 * r.a15 - self.a5 * r.a3 + self.a6 * r.a2 - self.a7 * r.a14 - self.a8 * r.a1 + self.a9 * r.a13 - self.a10 * r.a12 + self.a11 * r.a0 + self.a12 * r.a10 - self.a13 * r.a9 + self.a14 * r.a7 - self.a15 * r.a4,
            a12: self.a0 * r.a12 - self.a1 * r.a9 - self.a2 * r.a7 + self.a3 * r.a15 + self.a4 * r.a5 + self.a5 * r.a4 - self.a6 * r.a14 - self.a7 * r.a2 - self.a8 * r.a13 - self.a9 * r.a1 + self.a10 * r.a11 - self.a11 * r.a10 + self.a12 * r.a0 + self.a13 * r.a8 + self.a14 * r.a6 - self.a15 * r.a3,
            a13: self.a0 * r.a13 - self.a1 * r.a10 + self.a2 * r.a15 + self.a3 * r.a7 - self.a4 * r.a6 - self.a5 * r.a14 - self.a6 * r.a4 + self.a7 * r.a3 + self.a8 * r.a12 - self.a9 * r.a11 - self.a10 * r.a1 + self.a11 * r.a9 - self.a12 * r.a8 + self.a13 * r.a0 + self.a14 * r.a5 - self.a15 * r.a2,
            a14: self.a0 * r.a14 + self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8 + self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2 + self.a14 * r.a0,
            a15: self.a0 * r.a15 + self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 - self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1 + self.a15 * r.a0,
        }
    }
}

impl BitXor<Float> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r,
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
            a15: self.a15 * r,
        }
    }
}

impl BitXor<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: self.a0 * r.a1,
            a2: self.a0 * r.a2,
            a3: self.a0 * r.a3,
            a4: self.a0 * r.a4,
            a5: self.a1 * r.a2 - self.a2 * r.a1,
            a6: self.a1 * r.a3 - self.a3 * r.a1,
            a7: self.a1 * r.a4 - self.a4 * r.a1,
            a8: self.a2 * r.a3 - self.a3 * r.a2,
            a9: -self.a2 * r.a4 + self.a4 * r.a2,
            a10: self.a3 * r.a4 - self.a4 * r.a3,
            a11: -self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1,
            a12: self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1,
            a13: -self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1,
            a14: self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2,
            a15: -self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1,
        }
    }
}

impl BitXor<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0 * r.a5,
            a6: self.a0 * r.a6,
            a7: self.a0 * r.a7,
            a8: self.a0 * r.a8,
            a9: self.a0 * r.a9,
            a10: self.a0 * r.a10,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
        }
    }
}

impl BitXor<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0,
            a1: self.a1 * r.a0,
            a2: self.a2 * r.a0,
            a3: self.a3 * r.a0,
            a4: self.a4 * r.a0,
            a5: self.a0 * r.a5 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: -self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 + self.a11 * r.a0,
            a12: -self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5 + self.a12 * r.a0,
            a13: -self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6 + self.a13 * r.a0,
            a14: self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8 + self.a14 * r.a0,
            a15: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 + self.a15 * r.a0,
        }
    }
}

impl BitXor<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
            a15: self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11,
        }
    }
}

impl BitXor<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitxor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0,
            a1: self.a0 * r.a1 + self.a1 * r.a0,
            a2: self.a0 * r.a2 + self.a2 * r.a0,
            a3: self.a0 * r.a3 + self.a3 * r.a0,
            a4: self.a0 * r.a4 + self.a4 * r.a0,
            a5: self.a0 * r.a5 + self.a1 * r.a2 - self.a2 * r.a1 + self.a5 * r.a0,
            a6: self.a0 * r.a6 + self.a1 * r.a3 - self.a3 * r.a1 + self.a6 * r.a0,
            a7: self.a0 * r.a7 + self.a1 * r.a4 - self.a4 * r.a1 + self.a7 * r.a0,
            a8: self.a0 * r.a8 + self.a2 * r.a3 - self.a3 * r.a2 + self.a8 * r.a0,
            a9: self.a0 * r.a9 - self.a2 * r.a4 + self.a4 * r.a2 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a3 * r.a4 - self.a4 * r.a3 + self.a10 * r.a0,
            a11: self.a0 * r.a11 - self.a1 * r.a8 + self.a2 * r.a6 - self.a3 * r.a5 - self.a5 * r.a3 + self.a6 * r.a2 - self.a8 * r.a1 + self.a11 * r.a0,
            a12: self.a0 * r.a12 - self.a1 * r.a9 - self.a2 * r.a7 + self.a4 * r.a5 + self.a5 * r.a4 - self.a7 * r.a2 - self.a9 * r.a1 + self.a12 * r.a0,
            a13: self.a0 * r.a13 - self.a1 * r.a10 + self.a3 * r.a7 - self.a4 * r.a6 - self.a6 * r.a4 + self.a7 * r.a3 - self.a10 * r.a1 + self.a13 * r.a0,
            a14: self.a0 * r.a14 + self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8 + self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2 + self.a14 * r.a0,
            a15: self.a0 * r.a15 + self.a1 * r.a14 + self.a2 * r.a13 + self.a3 * r.a12 + self.a4 * r.a11 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 - self.a11 * r.a4 - self.a12 * r.a3 - self.a13 * r.a2 - self.a14 * r.a1 + self.a15 * r.a0,
        }
    }
}

impl BitAnd<Float> for FullMultivector {
    type Output = Float;

    fn bitand(self, r: Float) -> Float {
        self.a15 * r
    }
}

impl BitAnd<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a11 * r.a4 + self.a12 * r.a3 + self.a13 * r.a2 + self.a14 * r.a1,
            a1: self.a15 * r.a1,
            a2: self.a15 * r.a2,
            a3: self.a15 * r.a3,
            a4: self.a15 * r.a4,
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitAnd<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5,
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
            a5: self.a15 * r.a5,
            a6: self.a15 * r.a6,
            a7: self.a15 * r.a7,
            a8: self.a15 * r.a8,
            a9: self.a15 * r.a9,
            a10: self.a15 * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitAnd<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 + self.a15 * r.a0,
            a1: self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5,
            a2: -self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5,
            a3: self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6,
            a4: -self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7,
            a5: self.a15 * r.a5,
            a6: self.a15 * r.a6,
            a7: self.a15 * r.a7,
            a8: self.a15 * r.a8,
            a9: self.a15 * r.a9,
            a10: self.a15 * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitAnd<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a1 * r.a14 - self.a2 * r.a13 - self.a3 * r.a12 - self.a4 * r.a11,
            a1: self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11,
            a2: -self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11,
            a3: -self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11,
            a4: -self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12,
            a5: -self.a11 * r.a12 + self.a12 * r.a11,
            a6: self.a11 * r.a13 - self.a13 * r.a11,
            a7: -self.a12 * r.a13 + self.a13 * r.a12,
            a8: -self.a11 * r.a14 + self.a14 * r.a11,
            a9: -self.a12 * r.a14 + self.a14 * r.a12,
            a10: -self.a13 * r.a14 + self.a14 * r.a13,
            a11: self.a15 * r.a11,
            a12: self.a15 * r.a12,
            a13: self.a15 * r.a13,
            a14: self.a15 * r.a14,
            a15: 0.,
        }
    }
}

impl BitAnd<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitand(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a15 - self.a1 * r.a14 - self.a2 * r.a13 - self.a3 * r.a12 - self.a4 * r.a11 + self.a5 * r.a10 + self.a6 * r.a9 + self.a7 * r.a8 + self.a8 * r.a7 + self.a9 * r.a6 + self.a10 * r.a5 + self.a11 * r.a4 + self.a12 * r.a3 + self.a13 * r.a2 + self.a14 * r.a1 + self.a15 * r.a0,
            a1: self.a1 * r.a15 + self.a5 * r.a13 + self.a6 * r.a12 + self.a7 * r.a11 + self.a11 * r.a7 + self.a12 * r.a6 + self.a13 * r.a5 + self.a15 * r.a1,
            a2: self.a2 * r.a15 - self.a5 * r.a14 + self.a8 * r.a12 - self.a9 * r.a11 - self.a11 * r.a9 + self.a12 * r.a8 - self.a14 * r.a5 + self.a15 * r.a2,
            a3: self.a3 * r.a15 - self.a6 * r.a14 - self.a8 * r.a13 + self.a10 * r.a11 + self.a11 * r.a10 - self.a13 * r.a8 - self.a14 * r.a6 + self.a15 * r.a3,
            a4: self.a4 * r.a15 - self.a7 * r.a14 + self.a9 * r.a13 - self.a10 * r.a12 - self.a12 * r.a10 + self.a13 * r.a9 - self.a14 * r.a7 + self.a15 * r.a4,
            a5: self.a5 * r.a15 - self.a11 * r.a12 + self.a12 * r.a11 + self.a15 * r.a5,
            a6: self.a6 * r.a15 + self.a11 * r.a13 - self.a13 * r.a11 + self.a15 * r.a6,
            a7: self.a7 * r.a15 - self.a12 * r.a13 + self.a13 * r.a12 + self.a15 * r.a7,
            a8: self.a8 * r.a15 - self.a11 * r.a14 + self.a14 * r.a11 + self.a15 * r.a8,
            a9: self.a9 * r.a15 - self.a12 * r.a14 + self.a14 * r.a12 + self.a15 * r.a9,
            a10: self.a10 * r.a15 - self.a13 * r.a14 + self.a14 * r.a13 + self.a15 * r.a10,
            a11: self.a11 * r.a15 + self.a15 * r.a11,
            a12: self.a12 * r.a15 + self.a15 * r.a12,
            a13: self.a13 * r.a15 + self.a15 * r.a13,
            a14: self.a14 * r.a15 + self.a15 * r.a14,
            a15: self.a15 * r.a15,
        }
    }
}

impl BitOr<Float> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r,
            a1: self.a1 * r,
            a2: self.a2 * r,
            a3: self.a3 * r,
            a4: self.a4 * r,
            a5: self.a5 * r,
            a6: self.a6 * r,
            a7: self.a7 * r,
            a8: self.a8 * r,
            a9: self.a9 * r,
            a10: self.a10 * r,
            a11: self.a11 * r,
            a12: self.a12 * r,
            a13: self.a13 * r,
            a14: self.a14 * r,
            a15: self.a15 * r,
        }
    }
}

impl BitOr<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4,
            a1: self.a0 * r.a1 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4,
            a2: self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4,
            a3: self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4,
            a4: self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3,
            a5: -self.a11 * r.a3 + self.a12 * r.a4,
            a6: self.a11 * r.a2 - self.a13 * r.a4,
            a7: -self.a12 * r.a2 + self.a13 * r.a3,
            a8: self.a14 * r.a4,
            a9: self.a14 * r.a3,
            a10: self.a14 * r.a2,
            a11: -self.a15 * r.a4,
            a12: -self.a15 * r.a3,
            a13: -self.a15 * r.a2,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: -self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: -self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10,
            a3: self.a2 * r.a8 - self.a4 * r.a10 - self.a14 * r.a9,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 - self.a14 * r.a8,
            a5: self.a0 * r.a5 - self.a15 * r.a10,
            a6: self.a0 * r.a6 - self.a15 * r.a9,
            a7: self.a0 * r.a7 - self.a15 * r.a8,
            a8: self.a0 * r.a8,
            a9: self.a0 * r.a9,
            a10: self.a0 * r.a10,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 0.,
        }
    }
}

impl BitOr<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10,
            a1: self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10,
            a2: self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 - self.a14 * r.a10,
            a3: self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a14 * r.a9,
            a4: -self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a14 * r.a8,
            a5: self.a0 * r.a5 + self.a5 * r.a0 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a6 * r.a0 - self.a15 * r.a9,
            a7: self.a0 * r.a7 + self.a7 * r.a0 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a8 * r.a0,
            a9: self.a0 * r.a9 + self.a9 * r.a0,
            a10: self.a0 * r.a10 + self.a10 * r.a0,
            a11: self.a11 * r.a0,
            a12: self.a12 * r.a0,
            a13: self.a13 * r.a0,
            a14: self.a14 * r.a0,
            a15: self.a15 * r.a0,
        }
    }
}

impl BitOr<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -self.a14 * r.a14,
            a1: self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 - self.a15 * r.a14,
            a2: -self.a10 * r.a14,
            a3: -self.a9 * r.a14,
            a4: -self.a8 * r.a14,
            a5: -self.a3 * r.a11 + self.a4 * r.a12,
            a6: self.a2 * r.a11 - self.a4 * r.a13,
            a7: -self.a2 * r.a12 + self.a3 * r.a13,
            a8: self.a4 * r.a14,
            a9: self.a3 * r.a14,
            a10: self.a2 * r.a14,
            a11: self.a0 * r.a11,
            a12: self.a0 * r.a12,
            a13: self.a0 * r.a13,
            a14: self.a0 * r.a14,
            a15: 0.,
        }
    }
}

impl BitOr<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn bitor(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0 * r.a0 + self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4 - self.a8 * r.a8 - self.a9 * r.a9 - self.a10 * r.a10 - self.a14 * r.a14,
            a1: self.a0 * r.a1 + self.a1 * r.a0 - self.a2 * r.a5 - self.a3 * r.a6 - self.a4 * r.a7 + self.a5 * r.a2 + self.a6 * r.a3 + self.a7 * r.a4 + self.a8 * r.a11 + self.a9 * r.a12 + self.a10 * r.a13 + self.a11 * r.a8 + self.a12 * r.a9 + self.a13 * r.a10 + self.a14 * r.a15 - self.a15 * r.a14,
            a2: self.a0 * r.a2 + self.a2 * r.a0 - self.a3 * r.a8 + self.a4 * r.a9 + self.a8 * r.a3 - self.a9 * r.a4 - self.a10 * r.a14 - self.a14 * r.a10,
            a3: self.a0 * r.a3 + self.a2 * r.a8 + self.a3 * r.a0 - self.a4 * r.a10 - self.a8 * r.a2 - self.a9 * r.a14 + self.a10 * r.a4 - self.a14 * r.a9,
            a4: self.a0 * r.a4 - self.a2 * r.a9 + self.a3 * r.a10 + self.a4 * r.a0 - self.a8 * r.a14 + self.a9 * r.a2 - self.a10 * r.a3 - self.a14 * r.a8,
            a5: self.a0 * r.a5 - self.a3 * r.a11 + self.a4 * r.a12 + self.a5 * r.a0 - self.a10 * r.a15 - self.a11 * r.a3 + self.a12 * r.a4 - self.a15 * r.a10,
            a6: self.a0 * r.a6 + self.a2 * r.a11 - self.a4 * r.a13 + self.a6 * r.a0 - self.a9 * r.a15 + self.a11 * r.a2 - self.a13 * r.a4 - self.a15 * r.a9,
            a7: self.a0 * r.a7 - self.a2 * r.a12 + self.a3 * r.a13 + self.a7 * r.a0 - self.a8 * r.a15 - self.a12 * r.a2 + self.a13 * r.a3 - self.a15 * r.a8,
            a8: self.a0 * r.a8 + self.a4 * r.a14 + self.a8 * r.a0 + self.a14 * r.a4,
            a9: self.a0 * r.a9 + self.a3 * r.a14 + self.a9 * r.a0 + self.a14 * r.a3,
            a10: self.a0 * r.a10 + self.a2 * r.a14 + self.a10 * r.a0 + self.a14 * r.a2,
            a11: self.a0 * r.a11 + self.a4 * r.a15 + self.a11 * r.a0 - self.a15 * r.a4,
            a12: self.a0 * r.a12 + self.a3 * r.a15 + self.a12 * r.a0 - self.a15 * r.a3,
            a13: self.a0 * r.a13 + self.a2 * r.a15 + self.a13 * r.a0 - self.a15 * r.a2,
            a14: self.a0 * r.a14 + self.a14 * r.a0,
            a15: self.a0 * r.a15 + self.a15 * r.a0,
        }
    }
}

impl Shl<Float> for FullMultivector {
    type Output = FullMultivector;

    fn shl(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r * (self.a0.powi(2) + self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2) - self.a8.powi(2) - self.a9.powi(2) - self.a10.powi(2) - self.a14.powi(2)),
            a1: 2. * r * (self.a0 * self.a1 + self.a8 * self.a11 + self.a9 * self.a12 + self.a10 * self.a13),
            a2: 2. * r * (self.a0 * self.a2 - self.a10 * self.a14),
            a3: 2. * r * (self.a0 * self.a3 - self.a9 * self.a14),
            a4: 2. * r * (self.a0 * self.a4 - self.a8 * self.a14),
            a5: 2. * r * (self.a0 * self.a5 - self.a3 * self.a11 + self.a4 * self.a12 - self.a10 * self.a15),
            a6: 2. * r * (self.a0 * self.a6 + self.a2 * self.a11 - self.a4 * self.a13 - self.a9 * self.a15),
            a7: 2. * r * (self.a0 * self.a7 - self.a2 * self.a12 + self.a3 * self.a13 - self.a8 * self.a15),
            a8: 2. * r * (self.a0 * self.a8 + self.a4 * self.a14),
            a9: 2. * r * (self.a0 * self.a9 + self.a3 * self.a14),
            a10: 2. * r * (self.a0 * self.a10 + self.a2 * self.a14),
            a11: 2. * r * (self.a0 * self.a11 - self.a1 * self.a8 + self.a2 * self.a6 - self.a3 * self.a5),
            a12: 2. * r * (self.a0 * self.a12 - self.a1 * self.a9 - self.a2 * self.a7 + self.a4 * self.a5),
            a13: 2. * r * (self.a0 * self.a13 - self.a1 * self.a10 + self.a3 * self.a7 - self.a4 * self.a6),
            a14: 2. * r * (self.a0 * self.a14 + self.a2 * self.a10 + self.a3 * self.a9 + self.a4 * self.a8),
            a15: 2. * r * (self.a0 * self.a15 + self.a5 * self.a10 + self.a6 * self.a9 + self.a7 * self.a8),
        }
    }
}

impl Shl<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn shl(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 2. * self.a0 * self.a2 * r.a2 + 2. * self.a0 * self.a3 * r.a3 + 2. * self.a0 * self.a4 * r.a4 - 2. * self.a8 * self.a14 * r.a4 - 2. * self.a9 * self.a14 * r.a3 - 2. * self.a10 * self.a14 * r.a2,
            a1: self.a0.powi(2) * r.a1 + 2. * self.a1 * self.a2 * r.a2 + 2. * self.a1 * self.a3 * r.a3 + 2. * self.a1 * self.a4 * r.a4 - self.a2.powi(2) * r.a1 - self.a3.powi(2) * r.a1 - self.a4.powi(2) * r.a1 - 2. * self.a5 * self.a8 * r.a3 + 2. * self.a5 * self.a9 * r.a4 + 2. * self.a6 * self.a8 * r.a2 - 2. * self.a6 * self.a10 * r.a4 - 2. * self.a7 * self.a9 * r.a2 + 2. * self.a7 * self.a10 * r.a3 - self.a8.powi(2) * r.a1 - self.a9.powi(2) * r.a1 - self.a10.powi(2) * r.a1 + 2. * self.a11 * self.a14 * r.a4 + 2. * self.a12 * self.a14 * r.a3 + 2. * self.a13 * self.a14 * r.a2 + self.a14.powi(2) * r.a1,
            a2: self.a0.powi(2) * r.a2 + self.a2.powi(2) * r.a2 + 2. * self.a2 * self.a3 * r.a3 + 2. * self.a2 * self.a4 * r.a4 - self.a3.powi(2) * r.a2 - self.a4.powi(2) * r.a2 + self.a8.powi(2) * r.a2 - 2. * self.a8 * self.a10 * r.a4 + self.a9.powi(2) * r.a2 - 2. * self.a9 * self.a10 * r.a3 - self.a10.powi(2) * r.a2 - self.a14.powi(2) * r.a2,
            a3: self.a0.powi(2) * r.a3 - self.a2.powi(2) * r.a3 + 2. * self.a2 * self.a3 * r.a2 + self.a3.powi(2) * r.a3 + 2. * self.a3 * self.a4 * r.a4 - self.a4.powi(2) * r.a3 + self.a8.powi(2) * r.a3 - 2. * self.a8 * self.a9 * r.a4 - self.a9.powi(2) * r.a3 - 2. * self.a9 * self.a10 * r.a2 + self.a10.powi(2) * r.a3 - self.a14.powi(2) * r.a3,
            a4: self.a0.powi(2) * r.a4 - self.a2.powi(2) * r.a4 + 2. * self.a2 * self.a4 * r.a2 - self.a3.powi(2) * r.a4 + 2. * self.a3 * self.a4 * r.a3 + self.a4.powi(2) * r.a4 - self.a8.powi(2) * r.a4 - 2. * self.a8 * self.a9 * r.a3 - 2. * self.a8 * self.a10 * r.a2 + self.a9.powi(2) * r.a4 + self.a10.powi(2) * r.a4 - self.a14.powi(2) * r.a4,
            a5: -2. * self.a0 * self.a11 * r.a3 + 2. * self.a0 * self.a12 * r.a4 - 2. * self.a1 * self.a8 * r.a3 + 2. * self.a1 * self.a9 * r.a4 + 2. * self.a2 * self.a5 * r.a2 + 2. * self.a2 * self.a6 * r.a3 + 2. * self.a2 * self.a7 * r.a4 + 2. * self.a3 * self.a5 * r.a3 - 2. * self.a3 * self.a6 * r.a2 + 2. * self.a3 * self.a8 * r.a1 + 2. * self.a4 * self.a5 * r.a4 - 2. * self.a4 * self.a7 * r.a2 - 2. * self.a4 * self.a9 * r.a1 - 2. * self.a14 * self.a15 * r.a2,
            a6: 2. * self.a0 * self.a11 * r.a2 - 2. * self.a0 * self.a13 * r.a4 + 2. * self.a1 * self.a8 * r.a2 - 2. * self.a1 * self.a10 * r.a4 - 2. * self.a2 * self.a5 * r.a3 + 2. * self.a2 * self.a6 * r.a2 - 2. * self.a2 * self.a8 * r.a1 + 2. * self.a3 * self.a5 * r.a2 + 2. * self.a3 * self.a6 * r.a3 + 2. * self.a3 * self.a7 * r.a4 + 2. * self.a4 * self.a6 * r.a4 - 2. * self.a4 * self.a7 * r.a3 + 2. * self.a4 * self.a10 * r.a1 - 2. * self.a14 * self.a15 * r.a3,
            a7: -2. * self.a0 * self.a12 * r.a2 + 2. * self.a0 * self.a13 * r.a3 - 2. * self.a1 * self.a9 * r.a2 + 2. * self.a1 * self.a10 * r.a3 - 2. * self.a2 * self.a5 * r.a4 + 2. * self.a2 * self.a7 * r.a2 + 2. * self.a2 * self.a9 * r.a1 - 2. * self.a3 * self.a6 * r.a4 + 2. * self.a3 * self.a7 * r.a3 - 2. * self.a3 * self.a10 * r.a1 + 2. * self.a4 * self.a5 * r.a2 + 2. * self.a4 * self.a6 * r.a3 + 2. * self.a4 * self.a7 * r.a4 - 2. * self.a14 * self.a15 * r.a4,
            a8: 2. * self.a0 * self.a14 * r.a4 + 2. * self.a2 * self.a8 * r.a2 - 2. * self.a2 * self.a10 * r.a4 + 2. * self.a3 * self.a8 * r.a3 - 2. * self.a3 * self.a9 * r.a4 + 2. * self.a4 * self.a8 * r.a4 + 2. * self.a4 * self.a9 * r.a3 + 2. * self.a4 * self.a10 * r.a2,
            a9: 2. * self.a0 * self.a14 * r.a3 + 2. * self.a2 * self.a9 * r.a2 - 2. * self.a2 * self.a10 * r.a3 + 2. * self.a3 * self.a8 * r.a4 + 2. * self.a3 * self.a9 * r.a3 + 2. * self.a3 * self.a10 * r.a2 - 2. * self.a4 * self.a8 * r.a3 + 2. * self.a4 * self.a9 * r.a4,
            a10: 2. * self.a0 * self.a14 * r.a2 + 2. * self.a2 * self.a8 * r.a4 + 2. * self.a2 * self.a9 * r.a3 + 2. * self.a2 * self.a10 * r.a2 - 2. * self.a3 * self.a9 * r.a2 + 2. * self.a3 * self.a10 * r.a3 - 2. * self.a4 * self.a8 * r.a2 + 2. * self.a4 * self.a10 * r.a4,
            a11: -2. * self.a0 * self.a5 * r.a3 + 2. * self.a0 * self.a6 * r.a2 - 2. * self.a0 * self.a8 * r.a1 - 2. * self.a1 * self.a14 * r.a4 + 2. * self.a2 * self.a11 * r.a2 - 2. * self.a2 * self.a13 * r.a4 + 2. * self.a3 * self.a11 * r.a3 - 2. * self.a3 * self.a12 * r.a4 + 2. * self.a4 * self.a11 * r.a4 + 2. * self.a4 * self.a12 * r.a3 + 2. * self.a4 * self.a13 * r.a2 + 2. * self.a4 * self.a14 * r.a1 + 2. * self.a9 * self.a15 * r.a2 - 2. * self.a10 * self.a15 * r.a3,
            a12: 2. * self.a0 * self.a5 * r.a4 - 2. * self.a0 * self.a7 * r.a2 - 2. * self.a0 * self.a9 * r.a1 - 2. * self.a1 * self.a14 * r.a3 + 2. * self.a2 * self.a12 * r.a2 - 2. * self.a2 * self.a13 * r.a3 + 2. * self.a3 * self.a11 * r.a4 + 2. * self.a3 * self.a12 * r.a3 + 2. * self.a3 * self.a13 * r.a2 + 2. * self.a3 * self.a14 * r.a1 - 2. * self.a4 * self.a11 * r.a3 + 2. * self.a4 * self.a12 * r.a4 - 2. * self.a8 * self.a15 * r.a2 + 2. * self.a10 * self.a15 * r.a4,
            a13: -2. * self.a0 * self.a6 * r.a4 + 2. * self.a0 * self.a7 * r.a3 - 2. * self.a0 * self.a10 * r.a1 - 2. * self.a1 * self.a14 * r.a2 + 2. * self.a2 * self.a11 * r.a4 + 2. * self.a2 * self.a12 * r.a3 + 2. * self.a2 * self.a13 * r.a2 + 2. * self.a2 * self.a14 * r.a1 - 2. * self.a3 * self.a12 * r.a2 + 2. * self.a3 * self.a13 * r.a3 - 2. * self.a4 * self.a11 * r.a2 + 2. * self.a4 * self.a13 * r.a4 + 2. * self.a8 * self.a15 * r.a3 - 2. * self.a9 * self.a15 * r.a4,
            a14: 2. * self.a0 * self.a8 * r.a4 + 2. * self.a0 * self.a9 * r.a3 + 2. * self.a0 * self.a10 * r.a2 + 2. * self.a2 * self.a14 * r.a2 + 2. * self.a3 * self.a14 * r.a3 + 2. * self.a4 * self.a14 * r.a4,
            a15: 2. * self.a2 * self.a15 * r.a2 + 2. * self.a3 * self.a15 * r.a3 + 2. * self.a4 * self.a15 * r.a4 + 2. * self.a5 * self.a14 * r.a2 + 2. * self.a6 * self.a14 * r.a3 + 2. * self.a7 * self.a14 * r.a4 - 2. * self.a8 * self.a12 * r.a2 + 2. * self.a8 * self.a13 * r.a3 + 2. * self.a9 * self.a11 * r.a2 - 2. * self.a9 * self.a13 * r.a4 - 2. * self.a10 * self.a11 * r.a3 + 2. * self.a10 * self.a12 * r.a4,
        }
    }
}

impl Shl<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn shl(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: -2. * self.a0 * self.a8 * r.a8 - 2. * self.a0 * self.a9 * r.a9 - 2. * self.a0 * self.a10 * r.a10 - 2. * self.a2 * self.a14 * r.a10 - 2. * self.a3 * self.a14 * r.a9 - 2. * self.a4 * self.a14 * r.a8,
            a1: 2. * self.a0 * self.a11 * r.a8 + 2. * self.a0 * self.a12 * r.a9 + 2. * self.a0 * self.a13 * r.a10 - 2. * self.a1 * self.a8 * r.a8 - 2. * self.a1 * self.a9 * r.a9 - 2. * self.a1 * self.a10 * r.a10 - 2. * self.a2 * self.a6 * r.a8 + 2. * self.a2 * self.a7 * r.a9 + 2. * self.a2 * self.a8 * r.a6 - 2. * self.a2 * self.a9 * r.a7 + 2. * self.a3 * self.a5 * r.a8 - 2. * self.a3 * self.a7 * r.a10 - 2. * self.a3 * self.a8 * r.a5 + 2. * self.a3 * self.a10 * r.a7 - 2. * self.a4 * self.a5 * r.a9 + 2. * self.a4 * self.a6 * r.a10 + 2. * self.a4 * self.a9 * r.a5 - 2. * self.a4 * self.a10 * r.a6,
            a2: -2. * self.a0 * self.a14 * r.a10 - 2. * self.a2 * self.a8 * r.a8 - 2. * self.a2 * self.a9 * r.a9 - 2. * self.a2 * self.a10 * r.a10 + 2. * self.a3 * self.a9 * r.a10 - 2. * self.a3 * self.a10 * r.a9 + 2. * self.a4 * self.a8 * r.a10 - 2. * self.a4 * self.a10 * r.a8,
            a3: -2. * self.a0 * self.a14 * r.a9 - 2. * self.a2 * self.a9 * r.a10 + 2. * self.a2 * self.a10 * r.a9 - 2. * self.a3 * self.a8 * r.a8 - 2. * self.a3 * self.a9 * r.a9 - 2. * self.a3 * self.a10 * r.a10 + 2. * self.a4 * self.a8 * r.a9 - 2. * self.a4 * self.a9 * r.a8,
            a4: -2. * self.a0 * self.a14 * r.a8 - 2. * self.a2 * self.a8 * r.a10 + 2. * self.a2 * self.a10 * r.a8 - 2. * self.a3 * self.a8 * r.a9 + 2. * self.a3 * self.a9 * r.a8 - 2. * self.a4 * self.a8 * r.a8 - 2. * self.a4 * self.a9 * r.a9 - 2. * self.a4 * self.a10 * r.a10,
            a5: self.a0.powi(2) * r.a5 - 2. * self.a0 * self.a15 * r.a10 + 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + self.a3.powi(2) * r.a5 + self.a4.powi(2) * r.a5 - 2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 - self.a10.powi(2) * r.a5 + 2. * self.a11 * self.a14 * r.a9 - 2. * self.a12 * self.a14 * r.a8 + self.a14.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 - 2. * self.a0 * self.a15 * r.a9 - 2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + self.a4.powi(2) * r.a6 - 2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 + self.a10.powi(2) * r.a6 - 2. * self.a11 * self.a14 * r.a10 + 2. * self.a13 * self.a14 * r.a8 + self.a14.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a0 * self.a15 * r.a8 + 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - self.a4.powi(2) * r.a7 - 2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 + self.a9.powi(2) * r.a7 + self.a10.powi(2) * r.a7 + 2. * self.a12 * self.a14 * r.a10 - 2. * self.a13 * self.a14 * r.a9 + self.a14.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 - self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 + self.a4.powi(2) * r.a8 - self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8 - self.a14.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 - self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 - self.a4.powi(2) * r.a9 + self.a8.powi(2) * r.a9 - 2. * self.a8 * self.a9 * r.a8 - self.a9.powi(2) * r.a9 - 2. * self.a9 * self.a10 * r.a10 + self.a10.powi(2) * r.a9 - self.a14.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 - self.a3.powi(2) * r.a10 - self.a4.powi(2) * r.a10 + self.a8.powi(2) * r.a10 - 2. * self.a8 * self.a10 * r.a8 + self.a9.powi(2) * r.a10 - 2. * self.a9 * self.a10 * r.a9 - self.a10.powi(2) * r.a10 - self.a14.powi(2) * r.a10,
            a11: -2. * self.a0 * self.a1 * r.a8 + 2. * self.a0 * self.a2 * r.a6 - 2. * self.a0 * self.a3 * r.a5 - 2. * self.a2 * self.a15 * r.a9 + 2. * self.a3 * self.a15 * r.a10 + 2. * self.a5 * self.a14 * r.a9 - 2. * self.a6 * self.a14 * r.a10 - 2. * self.a8 * self.a11 * r.a8 - 2. * self.a8 * self.a12 * r.a9 - 2. * self.a8 * self.a13 * r.a10 - 2. * self.a9 * self.a11 * r.a9 + 2. * self.a9 * self.a12 * r.a8 - 2. * self.a9 * self.a14 * r.a5 - 2. * self.a10 * self.a11 * r.a10 + 2. * self.a10 * self.a13 * r.a8 + 2. * self.a10 * self.a14 * r.a6,
            a12: -2. * self.a0 * self.a1 * r.a9 - 2. * self.a0 * self.a2 * r.a7 + 2. * self.a0 * self.a4 * r.a5 + 2. * self.a2 * self.a15 * r.a8 - 2. * self.a4 * self.a15 * r.a10 - 2. * self.a5 * self.a14 * r.a8 + 2. * self.a7 * self.a14 * r.a10 + 2. * self.a8 * self.a11 * r.a9 - 2. * self.a8 * self.a12 * r.a8 + 2. * self.a8 * self.a14 * r.a5 - 2. * self.a9 * self.a11 * r.a8 - 2. * self.a9 * self.a12 * r.a9 - 2. * self.a9 * self.a13 * r.a10 - 2. * self.a10 * self.a12 * r.a10 + 2. * self.a10 * self.a13 * r.a9 - 2. * self.a10 * self.a14 * r.a7,
            a13: -2. * self.a0 * self.a1 * r.a10 + 2. * self.a0 * self.a3 * r.a7 - 2. * self.a0 * self.a4 * r.a6 - 2. * self.a3 * self.a15 * r.a8 + 2. * self.a4 * self.a15 * r.a9 + 2. * self.a6 * self.a14 * r.a8 - 2. * self.a7 * self.a14 * r.a9 + 2. * self.a8 * self.a11 * r.a10 - 2. * self.a8 * self.a13 * r.a8 - 2. * self.a8 * self.a14 * r.a6 + 2. * self.a9 * self.a12 * r.a10 - 2. * self.a9 * self.a13 * r.a9 + 2. * self.a9 * self.a14 * r.a7 - 2. * self.a10 * self.a11 * r.a8 - 2. * self.a10 * self.a12 * r.a9 - 2. * self.a10 * self.a13 * r.a10,
            a14: 2. * self.a0 * self.a2 * r.a10 + 2. * self.a0 * self.a3 * r.a9 + 2. * self.a0 * self.a4 * r.a8 - 2. * self.a8 * self.a14 * r.a8 - 2. * self.a9 * self.a14 * r.a9 - 2. * self.a10 * self.a14 * r.a10,
            a15: 2. * self.a0 * self.a5 * r.a10 + 2. * self.a0 * self.a6 * r.a9 + 2. * self.a0 * self.a7 * r.a8 + 2. * self.a0 * self.a8 * r.a7 + 2. * self.a0 * self.a9 * r.a6 + 2. * self.a0 * self.a10 * r.a5 - 2. * self.a2 * self.a11 * r.a9 + 2. * self.a2 * self.a12 * r.a8 - 2. * self.a2 * self.a14 * r.a5 + 2. * self.a3 * self.a11 * r.a10 - 2. * self.a3 * self.a13 * r.a8 - 2. * self.a3 * self.a14 * r.a6 - 2. * self.a4 * self.a12 * r.a10 + 2. * self.a4 * self.a13 * r.a9 - 2. * self.a4 * self.a14 * r.a7 - 2. * self.a8 * self.a15 * r.a8 - 2. * self.a9 * self.a15 * r.a9 - 2. * self.a10 * self.a15 * r.a10,
        }
    }
}

impl Shl<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn shl(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0.powi(2) * r.a0 - 2. * self.a0 * self.a8 * r.a8 - 2. * self.a0 * self.a9 * r.a9 - 2. * self.a0 * self.a10 * r.a10 + self.a2.powi(2) * r.a0 - 2. * self.a2 * self.a14 * r.a10 + self.a3.powi(2) * r.a0 - 2. * self.a3 * self.a14 * r.a9 + self.a4.powi(2) * r.a0 - 2. * self.a4 * self.a14 * r.a8 - self.a8.powi(2) * r.a0 - self.a9.powi(2) * r.a0 - self.a10.powi(2) * r.a0 - self.a14.powi(2) * r.a0,
            a1: 2. * self.a0 * self.a1 * r.a0 + 2. * self.a0 * self.a11 * r.a8 + 2. * self.a0 * self.a12 * r.a9 + 2. * self.a0 * self.a13 * r.a10 - 2. * self.a1 * self.a8 * r.a8 - 2. * self.a1 * self.a9 * r.a9 - 2. * self.a1 * self.a10 * r.a10 - 2. * self.a2 * self.a6 * r.a8 + 2. * self.a2 * self.a7 * r.a9 + 2. * self.a2 * self.a8 * r.a6 - 2. * self.a2 * self.a9 * r.a7 + 2. * self.a3 * self.a5 * r.a8 - 2. * self.a3 * self.a7 * r.a10 - 2. * self.a3 * self.a8 * r.a5 + 2. * self.a3 * self.a10 * r.a7 - 2. * self.a4 * self.a5 * r.a9 + 2. * self.a4 * self.a6 * r.a10 + 2. * self.a4 * self.a9 * r.a5 - 2. * self.a4 * self.a10 * r.a6 + 2. * self.a8 * self.a11 * r.a0 + 2. * self.a9 * self.a12 * r.a0 + 2. * self.a10 * self.a13 * r.a0,
            a2: 2. * self.a0 * self.a2 * r.a0 - 2. * self.a0 * self.a14 * r.a10 - 2. * self.a2 * self.a8 * r.a8 - 2. * self.a2 * self.a9 * r.a9 - 2. * self.a2 * self.a10 * r.a10 + 2. * self.a3 * self.a9 * r.a10 - 2. * self.a3 * self.a10 * r.a9 + 2. * self.a4 * self.a8 * r.a10 - 2. * self.a4 * self.a10 * r.a8 - 2. * self.a10 * self.a14 * r.a0,
            a3: 2. * self.a0 * self.a3 * r.a0 - 2. * self.a0 * self.a14 * r.a9 - 2. * self.a2 * self.a9 * r.a10 + 2. * self.a2 * self.a10 * r.a9 - 2. * self.a3 * self.a8 * r.a8 - 2. * self.a3 * self.a9 * r.a9 - 2. * self.a3 * self.a10 * r.a10 + 2. * self.a4 * self.a8 * r.a9 - 2. * self.a4 * self.a9 * r.a8 - 2. * self.a9 * self.a14 * r.a0,
            a4: 2. * self.a0 * self.a4 * r.a0 - 2. * self.a0 * self.a14 * r.a8 - 2. * self.a2 * self.a8 * r.a10 + 2. * self.a2 * self.a10 * r.a8 - 2. * self.a3 * self.a8 * r.a9 + 2. * self.a3 * self.a9 * r.a8 - 2. * self.a4 * self.a8 * r.a8 - 2. * self.a4 * self.a9 * r.a9 - 2. * self.a4 * self.a10 * r.a10 - 2. * self.a8 * self.a14 * r.a0,
            a5: self.a0.powi(2) * r.a5 + 2. * self.a0 * self.a5 * r.a0 - 2. * self.a0 * self.a15 * r.a10 + 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + self.a3.powi(2) * r.a5 - 2. * self.a3 * self.a11 * r.a0 + self.a4.powi(2) * r.a5 + 2. * self.a4 * self.a12 * r.a0 - 2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 - self.a10.powi(2) * r.a5 - 2. * self.a10 * self.a15 * r.a0 + 2. * self.a11 * self.a14 * r.a9 - 2. * self.a12 * self.a14 * r.a8 + self.a14.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a6 * r.a0 - 2. * self.a0 * self.a15 * r.a9 - 2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 + 2. * self.a2 * self.a11 * r.a0 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + self.a4.powi(2) * r.a6 - 2. * self.a4 * self.a13 * r.a0 - 2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 - 2. * self.a9 * self.a15 * r.a0 + self.a10.powi(2) * r.a6 - 2. * self.a11 * self.a14 * r.a10 + 2. * self.a13 * self.a14 * r.a8 + self.a14.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 + 2. * self.a0 * self.a7 * r.a0 - 2. * self.a0 * self.a15 * r.a8 + 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 - 2. * self.a2 * self.a12 * r.a0 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 + 2. * self.a3 * self.a13 * r.a0 - self.a4.powi(2) * r.a7 - 2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 - 2. * self.a8 * self.a15 * r.a0 + self.a9.powi(2) * r.a7 + self.a10.powi(2) * r.a7 + 2. * self.a12 * self.a14 * r.a10 - 2. * self.a13 * self.a14 * r.a9 + self.a14.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 + 2. * self.a0 * self.a8 * r.a0 - self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 + self.a4.powi(2) * r.a8 + 2. * self.a4 * self.a14 * r.a0 - self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8 - self.a14.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 + 2. * self.a0 * self.a9 * r.a0 - self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 + 2. * self.a3 * self.a14 * r.a0 - self.a4.powi(2) * r.a9 + self.a8.powi(2) * r.a9 - 2. * self.a8 * self.a9 * r.a8 - self.a9.powi(2) * r.a9 - 2. * self.a9 * self.a10 * r.a10 + self.a10.powi(2) * r.a9 - self.a14.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + 2. * self.a0 * self.a10 * r.a0 + self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 + 2. * self.a2 * self.a14 * r.a0 - self.a3.powi(2) * r.a10 - self.a4.powi(2) * r.a10 + self.a8.powi(2) * r.a10 - 2. * self.a8 * self.a10 * r.a8 + self.a9.powi(2) * r.a10 - 2. * self.a9 * self.a10 * r.a9 - self.a10.powi(2) * r.a10 - self.a14.powi(2) * r.a10,
            a11: -2. * self.a0 * self.a1 * r.a8 + 2. * self.a0 * self.a2 * r.a6 - 2. * self.a0 * self.a3 * r.a5 + 2. * self.a0 * self.a11 * r.a0 - 2. * self.a1 * self.a8 * r.a0 + 2. * self.a2 * self.a6 * r.a0 - 2. * self.a2 * self.a15 * r.a9 - 2. * self.a3 * self.a5 * r.a0 + 2. * self.a3 * self.a15 * r.a10 + 2. * self.a5 * self.a14 * r.a9 - 2. * self.a6 * self.a14 * r.a10 - 2. * self.a8 * self.a11 * r.a8 - 2. * self.a8 * self.a12 * r.a9 - 2. * self.a8 * self.a13 * r.a10 - 2. * self.a9 * self.a11 * r.a9 + 2. * self.a9 * self.a12 * r.a8 - 2. * self.a9 * self.a14 * r.a5 - 2. * self.a10 * self.a11 * r.a10 + 2. * self.a10 * self.a13 * r.a8 + 2. * self.a10 * self.a14 * r.a6,
            a12: -2. * self.a0 * self.a1 * r.a9 - 2. * self.a0 * self.a2 * r.a7 + 2. * self.a0 * self.a4 * r.a5 + 2. * self.a0 * self.a12 * r.a0 - 2. * self.a1 * self.a9 * r.a0 - 2. * self.a2 * self.a7 * r.a0 + 2. * self.a2 * self.a15 * r.a8 + 2. * self.a4 * self.a5 * r.a0 - 2. * self.a4 * self.a15 * r.a10 - 2. * self.a5 * self.a14 * r.a8 + 2. * self.a7 * self.a14 * r.a10 + 2. * self.a8 * self.a11 * r.a9 - 2. * self.a8 * self.a12 * r.a8 + 2. * self.a8 * self.a14 * r.a5 - 2. * self.a9 * self.a11 * r.a8 - 2. * self.a9 * self.a12 * r.a9 - 2. * self.a9 * self.a13 * r.a10 - 2. * self.a10 * self.a12 * r.a10 + 2. * self.a10 * self.a13 * r.a9 - 2. * self.a10 * self.a14 * r.a7,
            a13: -2. * self.a0 * self.a1 * r.a10 + 2. * self.a0 * self.a3 * r.a7 - 2. * self.a0 * self.a4 * r.a6 + 2. * self.a0 * self.a13 * r.a0 - 2. * self.a1 * self.a10 * r.a0 + 2. * self.a3 * self.a7 * r.a0 - 2. * self.a3 * self.a15 * r.a8 - 2. * self.a4 * self.a6 * r.a0 + 2. * self.a4 * self.a15 * r.a9 + 2. * self.a6 * self.a14 * r.a8 - 2. * self.a7 * self.a14 * r.a9 + 2. * self.a8 * self.a11 * r.a10 - 2. * self.a8 * self.a13 * r.a8 - 2. * self.a8 * self.a14 * r.a6 + 2. * self.a9 * self.a12 * r.a10 - 2. * self.a9 * self.a13 * r.a9 + 2. * self.a9 * self.a14 * r.a7 - 2. * self.a10 * self.a11 * r.a8 - 2. * self.a10 * self.a12 * r.a9 - 2. * self.a10 * self.a13 * r.a10,
            a14: 2. * self.a0 * self.a2 * r.a10 + 2. * self.a0 * self.a3 * r.a9 + 2. * self.a0 * self.a4 * r.a8 + 2. * self.a0 * self.a14 * r.a0 + 2. * self.a2 * self.a10 * r.a0 + 2. * self.a3 * self.a9 * r.a0 + 2. * self.a4 * self.a8 * r.a0 - 2. * self.a8 * self.a14 * r.a8 - 2. * self.a9 * self.a14 * r.a9 - 2. * self.a10 * self.a14 * r.a10,
            a15: 2. * self.a0 * self.a5 * r.a10 + 2. * self.a0 * self.a6 * r.a9 + 2. * self.a0 * self.a7 * r.a8 + 2. * self.a0 * self.a8 * r.a7 + 2. * self.a0 * self.a9 * r.a6 + 2. * self.a0 * self.a10 * r.a5 + 2. * self.a0 * self.a15 * r.a0 - 2. * self.a2 * self.a11 * r.a9 + 2. * self.a2 * self.a12 * r.a8 - 2. * self.a2 * self.a14 * r.a5 + 2. * self.a3 * self.a11 * r.a10 - 2. * self.a3 * self.a13 * r.a8 - 2. * self.a3 * self.a14 * r.a6 - 2. * self.a4 * self.a12 * r.a10 + 2. * self.a4 * self.a13 * r.a9 - 2. * self.a4 * self.a14 * r.a7 + 2. * self.a5 * self.a10 * r.a0 + 2. * self.a6 * self.a9 * r.a0 + 2. * self.a7 * self.a8 * r.a0 - 2. * self.a8 * self.a15 * r.a8 - 2. * self.a9 * self.a15 * r.a9 - 2. * self.a10 * self.a15 * r.a10,
        }
    }
}

impl Shl<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn shl(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: -2. * r.a14 * (self.a0 * self.a14 + self.a2 * self.a10 + self.a3 * self.a9 + self.a4 * self.a8),
            a1: 2. * self.a0 * self.a8 * r.a11 + 2. * self.a0 * self.a9 * r.a12 + 2. * self.a0 * self.a10 * r.a13 - 2. * self.a1 * self.a14 * r.a14 + 2. * self.a2 * self.a13 * r.a14 - 2. * self.a2 * self.a14 * r.a13 + 2. * self.a3 * self.a12 * r.a14 - 2. * self.a3 * self.a14 * r.a12 + 2. * self.a4 * self.a11 * r.a14 - 2. * self.a4 * self.a14 * r.a11,
            a2: -2. * r.a14 * (self.a0 * self.a10 + self.a2 * self.a14),
            a3: -2. * r.a14 * (self.a0 * self.a9 + self.a3 * self.a14),
            a4: -2. * r.a14 * (self.a0 * self.a8 + self.a4 * self.a14),
            a5: -2. * self.a0 * self.a3 * r.a11 + 2. * self.a0 * self.a4 * r.a12 - 2. * self.a2 * self.a15 * r.a14 - 2. * self.a5 * self.a14 * r.a14 - 2. * self.a8 * self.a12 * r.a14 + 2. * self.a8 * self.a14 * r.a12 + 2. * self.a9 * self.a11 * r.a14 - 2. * self.a9 * self.a14 * r.a11,
            a6: 2. * self.a0 * self.a2 * r.a11 - 2. * self.a0 * self.a4 * r.a13 - 2. * self.a3 * self.a15 * r.a14 - 2. * self.a6 * self.a14 * r.a14 + 2. * self.a8 * self.a13 * r.a14 - 2. * self.a8 * self.a14 * r.a13 - 2. * self.a10 * self.a11 * r.a14 + 2. * self.a10 * self.a14 * r.a11,
            a7: -2. * self.a0 * self.a2 * r.a12 + 2. * self.a0 * self.a3 * r.a13 - 2. * self.a4 * self.a15 * r.a14 - 2. * self.a7 * self.a14 * r.a14 - 2. * self.a9 * self.a13 * r.a14 + 2. * self.a9 * self.a14 * r.a13 + 2. * self.a10 * self.a12 * r.a14 - 2. * self.a10 * self.a14 * r.a12,
            a8: 2. * r.a14 * (self.a0 * self.a4 - self.a8 * self.a14),
            a9: 2. * r.a14 * (self.a0 * self.a3 - self.a9 * self.a14),
            a10: 2. * r.a14 * (self.a0 * self.a2 - self.a10 * self.a14),
            a11: self.a0.powi(2) * r.a11 - 2. * self.a1 * self.a4 * r.a14 + self.a2.powi(2) * r.a11 - 2. * self.a2 * self.a4 * r.a13 + self.a3.powi(2) * r.a11 - 2. * self.a3 * self.a4 * r.a12 - self.a4.powi(2) * r.a11 + 2. * self.a5 * self.a9 * r.a14 - 2. * self.a6 * self.a10 * r.a14 - self.a8.powi(2) * r.a11 - 2. * self.a8 * self.a9 * r.a12 - 2. * self.a8 * self.a10 * r.a13 + self.a9.powi(2) * r.a11 + self.a10.powi(2) * r.a11 - 2. * self.a11 * self.a14 * r.a14 + self.a14.powi(2) * r.a11,
            a12: self.a0.powi(2) * r.a12 - 2. * self.a1 * self.a3 * r.a14 + self.a2.powi(2) * r.a12 - 2. * self.a2 * self.a3 * r.a13 - self.a3.powi(2) * r.a12 - 2. * self.a3 * self.a4 * r.a11 + self.a4.powi(2) * r.a12 - 2. * self.a5 * self.a8 * r.a14 + 2. * self.a7 * self.a10 * r.a14 + self.a8.powi(2) * r.a12 - 2. * self.a8 * self.a9 * r.a11 - self.a9.powi(2) * r.a12 - 2. * self.a9 * self.a10 * r.a13 + self.a10.powi(2) * r.a12 - 2. * self.a12 * self.a14 * r.a14 + self.a14.powi(2) * r.a12,
            a13: self.a0.powi(2) * r.a13 - 2. * self.a1 * self.a2 * r.a14 - self.a2.powi(2) * r.a13 - 2. * self.a2 * self.a3 * r.a12 - 2. * self.a2 * self.a4 * r.a11 + self.a3.powi(2) * r.a13 + self.a4.powi(2) * r.a13 + 2. * self.a6 * self.a8 * r.a14 - 2. * self.a7 * self.a9 * r.a14 + self.a8.powi(2) * r.a13 - 2. * self.a8 * self.a10 * r.a11 + self.a9.powi(2) * r.a13 - 2. * self.a9 * self.a10 * r.a12 - self.a10.powi(2) * r.a13 - 2. * self.a13 * self.a14 * r.a14 + self.a14.powi(2) * r.a13,
            a14: r.a14 * (self.a0.powi(2) + self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2) - self.a8.powi(2) - self.a9.powi(2) - self.a10.powi(2) - self.a14.powi(2)),
            a15: 2. * self.a2 * self.a5 * r.a14 - 2. * self.a2 * self.a8 * r.a12 + 2. * self.a2 * self.a9 * r.a11 + 2. * self.a3 * self.a6 * r.a14 + 2. * self.a3 * self.a8 * r.a13 - 2. * self.a3 * self.a10 * r.a11 + 2. * self.a4 * self.a7 * r.a14 - 2. * self.a4 * self.a9 * r.a13 + 2. * self.a4 * self.a10 * r.a12 - 2. * self.a14 * self.a15 * r.a14,
        }
    }
}

impl Shl<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn shl(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0.powi(2) * r.a0 + 2. * self.a0 * self.a2 * r.a2 + 2. * self.a0 * self.a3 * r.a3 + 2. * self.a0 * self.a4 * r.a4 - 2. * self.a0 * self.a8 * r.a8 - 2. * self.a0 * self.a9 * r.a9 - 2. * self.a0 * self.a10 * r.a10 - 2. * self.a0 * self.a14 * r.a14 + self.a2.powi(2) * r.a0 - 2. * self.a2 * self.a10 * r.a14 - 2. * self.a2 * self.a14 * r.a10 + self.a3.powi(2) * r.a0 - 2. * self.a3 * self.a9 * r.a14 - 2. * self.a3 * self.a14 * r.a9 + self.a4.powi(2) * r.a0 - 2. * self.a4 * self.a8 * r.a14 - 2. * self.a4 * self.a14 * r.a8 - self.a8.powi(2) * r.a0 - 2. * self.a8 * self.a14 * r.a4 - self.a9.powi(2) * r.a0 - 2. * self.a9 * self.a14 * r.a3 - self.a10.powi(2) * r.a0 - 2. * self.a10 * self.a14 * r.a2 - self.a14.powi(2) * r.a0,
            a1: self.a0.powi(2) * r.a1 + 2. * self.a0 * self.a1 * r.a0 + 2. * self.a0 * self.a8 * r.a11 + 2. * self.a0 * self.a9 * r.a12 + 2. * self.a0 * self.a10 * r.a13 + 2. * self.a0 * self.a11 * r.a8 + 2. * self.a0 * self.a12 * r.a9 + 2. * self.a0 * self.a13 * r.a10 + 2. * self.a1 * self.a2 * r.a2 + 2. * self.a1 * self.a3 * r.a3 + 2. * self.a1 * self.a4 * r.a4 - 2. * self.a1 * self.a8 * r.a8 - 2. * self.a1 * self.a9 * r.a9 - 2. * self.a1 * self.a10 * r.a10 - 2. * self.a1 * self.a14 * r.a14 - self.a2.powi(2) * r.a1 - 2. * self.a2 * self.a6 * r.a8 + 2. * self.a2 * self.a7 * r.a9 + 2. * self.a2 * self.a8 * r.a6 - 2. * self.a2 * self.a9 * r.a7 + 2. * self.a2 * self.a13 * r.a14 - 2. * self.a2 * self.a14 * r.a13 - self.a3.powi(2) * r.a1 + 2. * self.a3 * self.a5 * r.a8 - 2. * self.a3 * self.a7 * r.a10 - 2. * self.a3 * self.a8 * r.a5 + 2. * self.a3 * self.a10 * r.a7 + 2. * self.a3 * self.a12 * r.a14 - 2. * self.a3 * self.a14 * r.a12 - self.a4.powi(2) * r.a1 - 2. * self.a4 * self.a5 * r.a9 + 2. * self.a4 * self.a6 * r.a10 + 2. * self.a4 * self.a9 * r.a5 - 2. * self.a4 * self.a10 * r.a6 + 2. * self.a4 * self.a11 * r.a14 - 2. * self.a4 * self.a14 * r.a11 - 2. * self.a5 * self.a8 * r.a3 + 2. * self.a5 * self.a9 * r.a4 + 2. * self.a6 * self.a8 * r.a2 - 2. * self.a6 * self.a10 * r.a4 - 2. * self.a7 * self.a9 * r.a2 + 2. * self.a7 * self.a10 * r.a3 - self.a8.powi(2) * r.a1 + 2. * self.a8 * self.a11 * r.a0 - self.a9.powi(2) * r.a1 + 2. * self.a9 * self.a12 * r.a0 - self.a10.powi(2) * r.a1 + 2. * self.a10 * self.a13 * r.a0 + 2. * self.a11 * self.a14 * r.a4 + 2. * self.a12 * self.a14 * r.a3 + 2. * self.a13 * self.a14 * r.a2 + self.a14.powi(2) * r.a1,
            a2: self.a0.powi(2) * r.a2 + 2. * self.a0 * self.a2 * r.a0 - 2. * self.a0 * self.a10 * r.a14 - 2. * self.a0 * self.a14 * r.a10 + self.a2.powi(2) * r.a2 + 2. * self.a2 * self.a3 * r.a3 + 2. * self.a2 * self.a4 * r.a4 - 2. * self.a2 * self.a8 * r.a8 - 2. * self.a2 * self.a9 * r.a9 - 2. * self.a2 * self.a10 * r.a10 - 2. * self.a2 * self.a14 * r.a14 - self.a3.powi(2) * r.a2 + 2. * self.a3 * self.a9 * r.a10 - 2. * self.a3 * self.a10 * r.a9 - self.a4.powi(2) * r.a2 + 2. * self.a4 * self.a8 * r.a10 - 2. * self.a4 * self.a10 * r.a8 + self.a8.powi(2) * r.a2 - 2. * self.a8 * self.a10 * r.a4 + self.a9.powi(2) * r.a2 - 2. * self.a9 * self.a10 * r.a3 - self.a10.powi(2) * r.a2 - 2. * self.a10 * self.a14 * r.a0 - self.a14.powi(2) * r.a2,
            a3: self.a0.powi(2) * r.a3 + 2. * self.a0 * self.a3 * r.a0 - 2. * self.a0 * self.a9 * r.a14 - 2. * self.a0 * self.a14 * r.a9 - self.a2.powi(2) * r.a3 + 2. * self.a2 * self.a3 * r.a2 - 2. * self.a2 * self.a9 * r.a10 + 2. * self.a2 * self.a10 * r.a9 + self.a3.powi(2) * r.a3 + 2. * self.a3 * self.a4 * r.a4 - 2. * self.a3 * self.a8 * r.a8 - 2. * self.a3 * self.a9 * r.a9 - 2. * self.a3 * self.a10 * r.a10 - 2. * self.a3 * self.a14 * r.a14 - self.a4.powi(2) * r.a3 + 2. * self.a4 * self.a8 * r.a9 - 2. * self.a4 * self.a9 * r.a8 + self.a8.powi(2) * r.a3 - 2. * self.a8 * self.a9 * r.a4 - self.a9.powi(2) * r.a3 - 2. * self.a9 * self.a10 * r.a2 - 2. * self.a9 * self.a14 * r.a0 + self.a10.powi(2) * r.a3 - self.a14.powi(2) * r.a3,
            a4: self.a0.powi(2) * r.a4 + 2. * self.a0 * self.a4 * r.a0 - 2. * self.a0 * self.a8 * r.a14 - 2. * self.a0 * self.a14 * r.a8 - self.a2.powi(2) * r.a4 + 2. * self.a2 * self.a4 * r.a2 - 2. * self.a2 * self.a8 * r.a10 + 2. * self.a2 * self.a10 * r.a8 - self.a3.powi(2) * r.a4 + 2. * self.a3 * self.a4 * r.a3 - 2. * self.a3 * self.a8 * r.a9 + 2. * self.a3 * self.a9 * r.a8 + self.a4.powi(2) * r.a4 - 2. * self.a4 * self.a8 * r.a8 - 2. * self.a4 * self.a9 * r.a9 - 2. * self.a4 * self.a10 * r.a10 - 2. * self.a4 * self.a14 * r.a14 - self.a8.powi(2) * r.a4 - 2. * self.a8 * self.a9 * r.a3 - 2. * self.a8 * self.a10 * r.a2 - 2. * self.a8 * self.a14 * r.a0 + self.a9.powi(2) * r.a4 + self.a10.powi(2) * r.a4 - self.a14.powi(2) * r.a4,
            a5: self.a0.powi(2) * r.a5 - 2. * self.a0 * self.a3 * r.a11 + 2. * self.a0 * self.a4 * r.a12 + 2. * self.a0 * self.a5 * r.a0 - 2. * self.a0 * self.a10 * r.a15 - 2. * self.a0 * self.a11 * r.a3 + 2. * self.a0 * self.a12 * r.a4 - 2. * self.a0 * self.a15 * r.a10 + 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 - 2. * self.a1 * self.a8 * r.a3 + 2. * self.a1 * self.a9 * r.a4 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + 2. * self.a2 * self.a5 * r.a2 + 2. * self.a2 * self.a6 * r.a3 + 2. * self.a2 * self.a7 * r.a4 + 2. * self.a2 * self.a14 * r.a15 - 2. * self.a2 * self.a15 * r.a14 + self.a3.powi(2) * r.a5 + 2. * self.a3 * self.a5 * r.a3 - 2. * self.a3 * self.a6 * r.a2 + 2. * self.a3 * self.a8 * r.a1 - 2. * self.a3 * self.a11 * r.a0 + self.a4.powi(2) * r.a5 + 2. * self.a4 * self.a5 * r.a4 - 2. * self.a4 * self.a7 * r.a2 - 2. * self.a4 * self.a9 * r.a1 + 2. * self.a4 * self.a12 * r.a0 - 2. * self.a5 * self.a8 * r.a8 - 2. * self.a5 * self.a9 * r.a9 - 2. * self.a5 * self.a10 * r.a10 - 2. * self.a5 * self.a14 * r.a14 + 2. * self.a6 * self.a9 * r.a10 - 2. * self.a6 * self.a10 * r.a9 + 2. * self.a7 * self.a8 * r.a10 - 2. * self.a7 * self.a10 * r.a8 + self.a8.powi(2) * r.a5 - 2. * self.a8 * self.a10 * r.a7 - 2. * self.a8 * self.a12 * r.a14 + 2. * self.a8 * self.a14 * r.a12 + self.a9.powi(2) * r.a5 - 2. * self.a9 * self.a10 * r.a6 + 2. * self.a9 * self.a11 * r.a14 - 2. * self.a9 * self.a14 * r.a11 - self.a10.powi(2) * r.a5 - 2. * self.a10 * self.a15 * r.a0 + 2. * self.a11 * self.a14 * r.a9 - 2. * self.a12 * self.a14 * r.a8 + self.a14.powi(2) * r.a5 - 2. * self.a14 * self.a15 * r.a2,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a2 * r.a11 - 2. * self.a0 * self.a4 * r.a13 + 2. * self.a0 * self.a6 * r.a0 - 2. * self.a0 * self.a9 * r.a15 + 2. * self.a0 * self.a11 * r.a2 - 2. * self.a0 * self.a13 * r.a4 - 2. * self.a0 * self.a15 * r.a9 - 2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + 2. * self.a1 * self.a8 * r.a2 - 2. * self.a1 * self.a10 * r.a4 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - 2. * self.a2 * self.a5 * r.a3 + 2. * self.a2 * self.a6 * r.a2 - 2. * self.a2 * self.a8 * r.a1 + 2. * self.a2 * self.a11 * r.a0 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + 2. * self.a3 * self.a5 * r.a2 + 2. * self.a3 * self.a6 * r.a3 + 2. * self.a3 * self.a7 * r.a4 + 2. * self.a3 * self.a14 * r.a15 - 2. * self.a3 * self.a15 * r.a14 + self.a4.powi(2) * r.a6 + 2. * self.a4 * self.a6 * r.a4 - 2. * self.a4 * self.a7 * r.a3 + 2. * self.a4 * self.a10 * r.a1 - 2. * self.a4 * self.a13 * r.a0 - 2. * self.a5 * self.a9 * r.a10 + 2. * self.a5 * self.a10 * r.a9 - 2. * self.a6 * self.a8 * r.a8 - 2. * self.a6 * self.a9 * r.a9 - 2. * self.a6 * self.a10 * r.a10 - 2. * self.a6 * self.a14 * r.a14 + 2. * self.a7 * self.a8 * r.a9 - 2. * self.a7 * self.a9 * r.a8 + self.a8.powi(2) * r.a6 - 2. * self.a8 * self.a9 * r.a7 + 2. * self.a8 * self.a13 * r.a14 - 2. * self.a8 * self.a14 * r.a13 - self.a9.powi(2) * r.a6 - 2. * self.a9 * self.a10 * r.a5 - 2. * self.a9 * self.a15 * r.a0 + self.a10.powi(2) * r.a6 - 2. * self.a10 * self.a11 * r.a14 + 2. * self.a10 * self.a14 * r.a11 - 2. * self.a11 * self.a14 * r.a10 + 2. * self.a13 * self.a14 * r.a8 + self.a14.powi(2) * r.a6 - 2. * self.a14 * self.a15 * r.a3,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a0 * self.a2 * r.a12 + 2. * self.a0 * self.a3 * r.a13 + 2. * self.a0 * self.a7 * r.a0 - 2. * self.a0 * self.a8 * r.a15 - 2. * self.a0 * self.a12 * r.a2 + 2. * self.a0 * self.a13 * r.a3 - 2. * self.a0 * self.a15 * r.a8 + 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 - 2. * self.a1 * self.a9 * r.a2 + 2. * self.a1 * self.a10 * r.a3 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 - 2. * self.a2 * self.a5 * r.a4 + 2. * self.a2 * self.a7 * r.a2 + 2. * self.a2 * self.a9 * r.a1 - 2. * self.a2 * self.a12 * r.a0 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - 2. * self.a3 * self.a6 * r.a4 + 2. * self.a3 * self.a7 * r.a3 - 2. * self.a3 * self.a10 * r.a1 + 2. * self.a3 * self.a13 * r.a0 - self.a4.powi(2) * r.a7 + 2. * self.a4 * self.a5 * r.a2 + 2. * self.a4 * self.a6 * r.a3 + 2. * self.a4 * self.a7 * r.a4 + 2. * self.a4 * self.a14 * r.a15 - 2. * self.a4 * self.a15 * r.a14 - 2. * self.a5 * self.a8 * r.a10 + 2. * self.a5 * self.a10 * r.a8 - 2. * self.a6 * self.a8 * r.a9 + 2. * self.a6 * self.a9 * r.a8 - 2. * self.a7 * self.a8 * r.a8 - 2. * self.a7 * self.a9 * r.a9 - 2. * self.a7 * self.a10 * r.a10 - 2. * self.a7 * self.a14 * r.a14 - self.a8.powi(2) * r.a7 - 2. * self.a8 * self.a9 * r.a6 - 2. * self.a8 * self.a10 * r.a5 - 2. * self.a8 * self.a15 * r.a0 + self.a9.powi(2) * r.a7 - 2. * self.a9 * self.a13 * r.a14 + 2. * self.a9 * self.a14 * r.a13 + self.a10.powi(2) * r.a7 + 2. * self.a10 * self.a12 * r.a14 - 2. * self.a10 * self.a14 * r.a12 + 2. * self.a12 * self.a14 * r.a10 - 2. * self.a13 * self.a14 * r.a9 + self.a14.powi(2) * r.a7 - 2. * self.a14 * self.a15 * r.a4,
            a8: self.a0.powi(2) * r.a8 + 2. * self.a0 * self.a4 * r.a14 + 2. * self.a0 * self.a8 * r.a0 + 2. * self.a0 * self.a14 * r.a4 - self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 + 2. * self.a2 * self.a8 * r.a2 - 2. * self.a2 * self.a10 * r.a4 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 + 2. * self.a3 * self.a8 * r.a3 - 2. * self.a3 * self.a9 * r.a4 + self.a4.powi(2) * r.a8 + 2. * self.a4 * self.a8 * r.a4 + 2. * self.a4 * self.a9 * r.a3 + 2. * self.a4 * self.a10 * r.a2 + 2. * self.a4 * self.a14 * r.a0 - self.a8.powi(2) * r.a8 - 2. * self.a8 * self.a9 * r.a9 - 2. * self.a8 * self.a10 * r.a10 - 2. * self.a8 * self.a14 * r.a14 + self.a9.powi(2) * r.a8 + self.a10.powi(2) * r.a8 - self.a14.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 + 2. * self.a0 * self.a3 * r.a14 + 2. * self.a0 * self.a9 * r.a0 + 2. * self.a0 * self.a14 * r.a3 - self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 + 2. * self.a2 * self.a9 * r.a2 - 2. * self.a2 * self.a10 * r.a3 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 + 2. * self.a3 * self.a8 * r.a4 + 2. * self.a3 * self.a9 * r.a3 + 2. * self.a3 * self.a10 * r.a2 + 2. * self.a3 * self.a14 * r.a0 - self.a4.powi(2) * r.a9 - 2. * self.a4 * self.a8 * r.a3 + 2. * self.a4 * self.a9 * r.a4 + self.a8.powi(2) * r.a9 - 2. * self.a8 * self.a9 * r.a8 - self.a9.powi(2) * r.a9 - 2. * self.a9 * self.a10 * r.a10 - 2. * self.a9 * self.a14 * r.a14 + self.a10.powi(2) * r.a9 - self.a14.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + 2. * self.a0 * self.a2 * r.a14 + 2. * self.a0 * self.a10 * r.a0 + 2. * self.a0 * self.a14 * r.a2 + self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 + 2. * self.a2 * self.a8 * r.a4 + 2. * self.a2 * self.a9 * r.a3 + 2. * self.a2 * self.a10 * r.a2 + 2. * self.a2 * self.a14 * r.a0 - self.a3.powi(2) * r.a10 - 2. * self.a3 * self.a9 * r.a2 + 2. * self.a3 * self.a10 * r.a3 - self.a4.powi(2) * r.a10 - 2. * self.a4 * self.a8 * r.a2 + 2. * self.a4 * self.a10 * r.a4 + self.a8.powi(2) * r.a10 - 2. * self.a8 * self.a10 * r.a8 + self.a9.powi(2) * r.a10 - 2. * self.a9 * self.a10 * r.a9 - self.a10.powi(2) * r.a10 - 2. * self.a10 * self.a14 * r.a14 - self.a14.powi(2) * r.a10,
            a11: self.a0.powi(2) * r.a11 - 2. * self.a0 * self.a1 * r.a8 + 2. * self.a0 * self.a2 * r.a6 - 2. * self.a0 * self.a3 * r.a5 - 2. * self.a0 * self.a5 * r.a3 + 2. * self.a0 * self.a6 * r.a2 - 2. * self.a0 * self.a8 * r.a1 + 2. * self.a0 * self.a11 * r.a0 - 2. * self.a1 * self.a4 * r.a14 - 2. * self.a1 * self.a8 * r.a0 - 2. * self.a1 * self.a14 * r.a4 + self.a2.powi(2) * r.a11 - 2. * self.a2 * self.a4 * r.a13 + 2. * self.a2 * self.a6 * r.a0 - 2. * self.a2 * self.a9 * r.a15 + 2. * self.a2 * self.a11 * r.a2 - 2. * self.a2 * self.a13 * r.a4 - 2. * self.a2 * self.a15 * r.a9 + self.a3.powi(2) * r.a11 - 2. * self.a3 * self.a4 * r.a12 - 2. * self.a3 * self.a5 * r.a0 + 2. * self.a3 * self.a10 * r.a15 + 2. * self.a3 * self.a11 * r.a3 - 2. * self.a3 * self.a12 * r.a4 + 2. * self.a3 * self.a15 * r.a10 - self.a4.powi(2) * r.a11 + 2. * self.a4 * self.a11 * r.a4 + 2. * self.a4 * self.a12 * r.a3 + 2. * self.a4 * self.a13 * r.a2 + 2. * self.a4 * self.a14 * r.a1 + 2. * self.a5 * self.a9 * r.a14 + 2. * self.a5 * self.a14 * r.a9 - 2. * self.a6 * self.a10 * r.a14 - 2. * self.a6 * self.a14 * r.a10 - self.a8.powi(2) * r.a11 - 2. * self.a8 * self.a9 * r.a12 - 2. * self.a8 * self.a10 * r.a13 - 2. * self.a8 * self.a11 * r.a8 - 2. * self.a8 * self.a12 * r.a9 - 2. * self.a8 * self.a13 * r.a10 + self.a9.powi(2) * r.a11 - 2. * self.a9 * self.a11 * r.a9 + 2. * self.a9 * self.a12 * r.a8 - 2. * self.a9 * self.a14 * r.a5 + 2. * self.a9 * self.a15 * r.a2 + self.a10.powi(2) * r.a11 - 2. * self.a10 * self.a11 * r.a10 + 2. * self.a10 * self.a13 * r.a8 + 2. * self.a10 * self.a14 * r.a6 - 2. * self.a10 * self.a15 * r.a3 - 2. * self.a11 * self.a14 * r.a14 + self.a14.powi(2) * r.a11,
            a12: self.a0.powi(2) * r.a12 - 2. * self.a0 * self.a1 * r.a9 - 2. * self.a0 * self.a2 * r.a7 + 2. * self.a0 * self.a4 * r.a5 + 2. * self.a0 * self.a5 * r.a4 - 2. * self.a0 * self.a7 * r.a2 - 2. * self.a0 * self.a9 * r.a1 + 2. * self.a0 * self.a12 * r.a0 - 2. * self.a1 * self.a3 * r.a14 - 2. * self.a1 * self.a9 * r.a0 - 2. * self.a1 * self.a14 * r.a3 + self.a2.powi(2) * r.a12 - 2. * self.a2 * self.a3 * r.a13 - 2. * self.a2 * self.a7 * r.a0 + 2. * self.a2 * self.a8 * r.a15 + 2. * self.a2 * self.a12 * r.a2 - 2. * self.a2 * self.a13 * r.a3 + 2. * self.a2 * self.a15 * r.a8 - self.a3.powi(2) * r.a12 - 2. * self.a3 * self.a4 * r.a11 + 2. * self.a3 * self.a11 * r.a4 + 2. * self.a3 * self.a12 * r.a3 + 2. * self.a3 * self.a13 * r.a2 + 2. * self.a3 * self.a14 * r.a1 + self.a4.powi(2) * r.a12 + 2. * self.a4 * self.a5 * r.a0 - 2. * self.a4 * self.a10 * r.a15 - 2. * self.a4 * self.a11 * r.a3 + 2. * self.a4 * self.a12 * r.a4 - 2. * self.a4 * self.a15 * r.a10 - 2. * self.a5 * self.a8 * r.a14 - 2. * self.a5 * self.a14 * r.a8 + 2. * self.a7 * self.a10 * r.a14 + 2. * self.a7 * self.a14 * r.a10 + self.a8.powi(2) * r.a12 - 2. * self.a8 * self.a9 * r.a11 + 2. * self.a8 * self.a11 * r.a9 - 2. * self.a8 * self.a12 * r.a8 + 2. * self.a8 * self.a14 * r.a5 - 2. * self.a8 * self.a15 * r.a2 - self.a9.powi(2) * r.a12 - 2. * self.a9 * self.a10 * r.a13 - 2. * self.a9 * self.a11 * r.a8 - 2. * self.a9 * self.a12 * r.a9 - 2. * self.a9 * self.a13 * r.a10 + self.a10.powi(2) * r.a12 - 2. * self.a10 * self.a12 * r.a10 + 2. * self.a10 * self.a13 * r.a9 - 2. * self.a10 * self.a14 * r.a7 + 2. * self.a10 * self.a15 * r.a4 - 2. * self.a12 * self.a14 * r.a14 + self.a14.powi(2) * r.a12,
            a13: self.a0.powi(2) * r.a13 - 2. * self.a0 * self.a1 * r.a10 + 2. * self.a0 * self.a3 * r.a7 - 2. * self.a0 * self.a4 * r.a6 - 2. * self.a0 * self.a6 * r.a4 + 2. * self.a0 * self.a7 * r.a3 - 2. * self.a0 * self.a10 * r.a1 + 2. * self.a0 * self.a13 * r.a0 - 2. * self.a1 * self.a2 * r.a14 - 2. * self.a1 * self.a10 * r.a0 - 2. * self.a1 * self.a14 * r.a2 - self.a2.powi(2) * r.a13 - 2. * self.a2 * self.a3 * r.a12 - 2. * self.a2 * self.a4 * r.a11 + 2. * self.a2 * self.a11 * r.a4 + 2. * self.a2 * self.a12 * r.a3 + 2. * self.a2 * self.a13 * r.a2 + 2. * self.a2 * self.a14 * r.a1 + self.a3.powi(2) * r.a13 + 2. * self.a3 * self.a7 * r.a0 - 2. * self.a3 * self.a8 * r.a15 - 2. * self.a3 * self.a12 * r.a2 + 2. * self.a3 * self.a13 * r.a3 - 2. * self.a3 * self.a15 * r.a8 + self.a4.powi(2) * r.a13 - 2. * self.a4 * self.a6 * r.a0 + 2. * self.a4 * self.a9 * r.a15 - 2. * self.a4 * self.a11 * r.a2 + 2. * self.a4 * self.a13 * r.a4 + 2. * self.a4 * self.a15 * r.a9 + 2. * self.a6 * self.a8 * r.a14 + 2. * self.a6 * self.a14 * r.a8 - 2. * self.a7 * self.a9 * r.a14 - 2. * self.a7 * self.a14 * r.a9 + self.a8.powi(2) * r.a13 - 2. * self.a8 * self.a10 * r.a11 + 2. * self.a8 * self.a11 * r.a10 - 2. * self.a8 * self.a13 * r.a8 - 2. * self.a8 * self.a14 * r.a6 + 2. * self.a8 * self.a15 * r.a3 + self.a9.powi(2) * r.a13 - 2. * self.a9 * self.a10 * r.a12 + 2. * self.a9 * self.a12 * r.a10 - 2. * self.a9 * self.a13 * r.a9 + 2. * self.a9 * self.a14 * r.a7 - 2. * self.a9 * self.a15 * r.a4 - self.a10.powi(2) * r.a13 - 2. * self.a10 * self.a11 * r.a8 - 2. * self.a10 * self.a12 * r.a9 - 2. * self.a10 * self.a13 * r.a10 - 2. * self.a13 * self.a14 * r.a14 + self.a14.powi(2) * r.a13,
            a14: self.a0.powi(2) * r.a14 + 2. * self.a0 * self.a2 * r.a10 + 2. * self.a0 * self.a3 * r.a9 + 2. * self.a0 * self.a4 * r.a8 + 2. * self.a0 * self.a8 * r.a4 + 2. * self.a0 * self.a9 * r.a3 + 2. * self.a0 * self.a10 * r.a2 + 2. * self.a0 * self.a14 * r.a0 + self.a2.powi(2) * r.a14 + 2. * self.a2 * self.a10 * r.a0 + 2. * self.a2 * self.a14 * r.a2 + self.a3.powi(2) * r.a14 + 2. * self.a3 * self.a9 * r.a0 + 2. * self.a3 * self.a14 * r.a3 + self.a4.powi(2) * r.a14 + 2. * self.a4 * self.a8 * r.a0 + 2. * self.a4 * self.a14 * r.a4 - self.a8.powi(2) * r.a14 - 2. * self.a8 * self.a14 * r.a8 - self.a9.powi(2) * r.a14 - 2. * self.a9 * self.a14 * r.a9 - self.a10.powi(2) * r.a14 - 2. * self.a10 * self.a14 * r.a10 - self.a14.powi(2) * r.a14,
            a15: self.a0.powi(2) * r.a15 + 2. * self.a0 * self.a5 * r.a10 + 2. * self.a0 * self.a6 * r.a9 + 2. * self.a0 * self.a7 * r.a8 + 2. * self.a0 * self.a8 * r.a7 + 2. * self.a0 * self.a9 * r.a6 + 2. * self.a0 * self.a10 * r.a5 + 2. * self.a0 * self.a15 * r.a0 - self.a2.powi(2) * r.a15 + 2. * self.a2 * self.a5 * r.a14 - 2. * self.a2 * self.a8 * r.a12 + 2. * self.a2 * self.a9 * r.a11 - 2. * self.a2 * self.a11 * r.a9 + 2. * self.a2 * self.a12 * r.a8 - 2. * self.a2 * self.a14 * r.a5 + 2. * self.a2 * self.a15 * r.a2 - self.a3.powi(2) * r.a15 + 2. * self.a3 * self.a6 * r.a14 + 2. * self.a3 * self.a8 * r.a13 - 2. * self.a3 * self.a10 * r.a11 + 2. * self.a3 * self.a11 * r.a10 - 2. * self.a3 * self.a13 * r.a8 - 2. * self.a3 * self.a14 * r.a6 + 2. * self.a3 * self.a15 * r.a3 - self.a4.powi(2) * r.a15 + 2. * self.a4 * self.a7 * r.a14 - 2. * self.a4 * self.a9 * r.a13 + 2. * self.a4 * self.a10 * r.a12 - 2. * self.a4 * self.a12 * r.a10 + 2. * self.a4 * self.a13 * r.a9 - 2. * self.a4 * self.a14 * r.a7 + 2. * self.a4 * self.a15 * r.a4 + 2. * self.a5 * self.a10 * r.a0 + 2. * self.a5 * self.a14 * r.a2 + 2. * self.a6 * self.a9 * r.a0 + 2. * self.a6 * self.a14 * r.a3 + 2. * self.a7 * self.a8 * r.a0 + 2. * self.a7 * self.a14 * r.a4 - self.a8.powi(2) * r.a15 - 2. * self.a8 * self.a12 * r.a2 + 2. * self.a8 * self.a13 * r.a3 - 2. * self.a8 * self.a15 * r.a8 - self.a9.powi(2) * r.a15 + 2. * self.a9 * self.a11 * r.a2 - 2. * self.a9 * self.a13 * r.a4 - 2. * self.a9 * self.a15 * r.a9 - self.a10.powi(2) * r.a15 - 2. * self.a10 * self.a11 * r.a3 + 2. * self.a10 * self.a12 * r.a4 - 2. * self.a10 * self.a15 * r.a10 + self.a14.powi(2) * r.a15 - 2. * self.a14 * self.a15 * r.a14,
        }
    }
}

impl Shr<Float> for FullMultivector {
    type Output = FullMultivector;

    fn shr(self, r: Float) -> FullMultivector {
        FullMultivector {
            a0: r * (self.a0.powi(2) + self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2) + self.a14.powi(2)),
            a1: 2. * r * (self.a0 * self.a1 + self.a2 * self.a5 + self.a3 * self.a6 + self.a4 * self.a7 - self.a8 * self.a11 - self.a9 * self.a12 - self.a10 * self.a13 + self.a14 * self.a15),
            a2: 2. * r * (self.a0 * self.a2 + self.a3 * self.a8 - self.a4 * self.a9 + self.a10 * self.a14),
            a3: 2. * r * (self.a0 * self.a3 - self.a2 * self.a8 + self.a4 * self.a10 + self.a9 * self.a14),
            a4: 2. * r * (self.a0 * self.a4 + self.a2 * self.a9 - self.a3 * self.a10 + self.a8 * self.a14),
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: 2. * r * (self.a0 * self.a15 - self.a1 * self.a14 - self.a2 * self.a13 - self.a3 * self.a12 - self.a4 * self.a11 - self.a5 * self.a10 - self.a6 * self.a9 - self.a7 * self.a8),
        }
    }
}

impl Shr<Vector> for FullMultivector {
    type Output = FullMultivector;

    fn shr(self, r: Vector) -> FullMultivector {
        FullMultivector {
            a0: 2. * self.a0 * self.a2 * r.a2 + 2. * self.a0 * self.a3 * r.a3 + 2. * self.a0 * self.a4 * r.a4 + 2. * self.a2 * self.a8 * r.a3 - 2. * self.a2 * self.a9 * r.a4 - 2. * self.a3 * self.a8 * r.a2 + 2. * self.a3 * self.a10 * r.a4 + 2. * self.a4 * self.a9 * r.a2 - 2. * self.a4 * self.a10 * r.a3 + 2. * self.a8 * self.a14 * r.a4 + 2. * self.a9 * self.a14 * r.a3 + 2. * self.a10 * self.a14 * r.a2,
            a1: self.a0.powi(2) * r.a1 + 2. * self.a0 * self.a5 * r.a2 + 2. * self.a0 * self.a6 * r.a3 + 2. * self.a0 * self.a7 * r.a4 + 2. * self.a1 * self.a2 * r.a2 + 2. * self.a1 * self.a3 * r.a3 + 2. * self.a1 * self.a4 * r.a4 - self.a2.powi(2) * r.a1 - 2. * self.a2 * self.a11 * r.a3 + 2. * self.a2 * self.a12 * r.a4 - self.a3.powi(2) * r.a1 + 2. * self.a3 * self.a11 * r.a2 - 2. * self.a3 * self.a13 * r.a4 - self.a4.powi(2) * r.a1 - 2. * self.a4 * self.a12 * r.a2 + 2. * self.a4 * self.a13 * r.a3 + 2. * self.a5 * self.a8 * r.a3 - 2. * self.a5 * self.a9 * r.a4 - 2. * self.a6 * self.a8 * r.a2 + 2. * self.a6 * self.a10 * r.a4 + 2. * self.a7 * self.a9 * r.a2 - 2. * self.a7 * self.a10 * r.a3 + self.a8.powi(2) * r.a1 + 2. * self.a8 * self.a15 * r.a4 + self.a9.powi(2) * r.a1 + 2. * self.a9 * self.a15 * r.a3 + self.a10.powi(2) * r.a1 + 2. * self.a10 * self.a15 * r.a2 - 2. * self.a11 * self.a14 * r.a4 - 2. * self.a12 * self.a14 * r.a3 - 2. * self.a13 * self.a14 * r.a2 - self.a14.powi(2) * r.a1,
            a2: self.a0 * (self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4) + self.a2 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) + self.a3 * (self.a2 * r.a3 - self.a3 * r.a2 + self.a14 * r.a4) - self.a4 * (-self.a2 * r.a4 + self.a4 * r.a2 + self.a14 * r.a3) + self.a8 * (self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4) - self.a9 * (self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3) + self.a10 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + self.a14 * (self.a3 * r.a4 - self.a4 * r.a3 + self.a14 * r.a2),
            a3: self.a0 * (self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4) - self.a2 * (self.a2 * r.a3 - self.a3 * r.a2 + self.a14 * r.a4) + self.a3 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) + self.a4 * (self.a3 * r.a4 - self.a4 * r.a3 + self.a14 * r.a2) - self.a8 * (self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4) + self.a9 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + self.a10 * (self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3) + self.a14 * (-self.a2 * r.a4 + self.a4 * r.a2 + self.a14 * r.a3),
            a4: self.a0 * (self.a0 * r.a4 + self.a9 * r.a2 - self.a10 * r.a3) + self.a2 * (-self.a2 * r.a4 + self.a4 * r.a2 + self.a14 * r.a3) - self.a3 * (self.a3 * r.a4 - self.a4 * r.a3 + self.a14 * r.a2) + self.a4 * (self.a2 * r.a2 + self.a3 * r.a3 + self.a4 * r.a4) + self.a8 * (self.a8 * r.a4 + self.a9 * r.a3 + self.a10 * r.a2) + self.a9 * (self.a0 * r.a2 + self.a8 * r.a3 - self.a9 * r.a4) - self.a10 * (self.a0 * r.a3 - self.a8 * r.a2 + self.a10 * r.a4) + self.a14 * (self.a2 * r.a3 - self.a3 * r.a2 + self.a14 * r.a4),
            a5: 0.,
            a6: 0.,
            a7: 0.,
            a8: 0.,
            a9: 0.,
            a10: 0.,
            a11: 0.,
            a12: 0.,
            a13: 0.,
            a14: 0.,
            a15: -2. * self.a0 * self.a11 * r.a4 - 2. * self.a0 * self.a12 * r.a3 - 2. * self.a0 * self.a13 * r.a2 - 2. * self.a0 * self.a14 * r.a1 - 2. * self.a1 * self.a8 * r.a4 - 2. * self.a1 * self.a9 * r.a3 - 2. * self.a1 * self.a10 * r.a2 + 2. * self.a2 * self.a6 * r.a4 - 2. * self.a2 * self.a7 * r.a3 + 2. * self.a2 * self.a10 * r.a1 + 2. * self.a2 * self.a15 * r.a2 - 2. * self.a3 * self.a5 * r.a4 + 2. * self.a3 * self.a7 * r.a2 + 2. * self.a3 * self.a9 * r.a1 + 2. * self.a3 * self.a15 * r.a3 + 2. * self.a4 * self.a5 * r.a3 - 2. * self.a4 * self.a6 * r.a2 + 2. * self.a4 * self.a8 * r.a1 + 2. * self.a4 * self.a15 * r.a4 - 2. * self.a5 * self.a14 * r.a2 - 2. * self.a6 * self.a14 * r.a3 - 2. * self.a7 * self.a14 * r.a4 + 2. * self.a8 * self.a12 * r.a2 - 2. * self.a8 * self.a13 * r.a3 - 2. * self.a9 * self.a11 * r.a2 + 2. * self.a9 * self.a13 * r.a4 + 2. * self.a10 * self.a11 * r.a3 - 2. * self.a10 * self.a12 * r.a4,
        }
    }
}

impl Shr<Bivector> for FullMultivector {
    type Output = FullMultivector;

    fn shr(self, r: Bivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: self.a0.powi(2) * r.a5 - 2. * self.a0 * self.a6 * r.a8 + 2. * self.a0 * self.a7 * r.a9 + 2. * self.a0 * self.a8 * r.a6 - 2. * self.a0 * self.a9 * r.a7 - 2. * self.a0 * self.a15 * r.a10 + 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 + 2. * self.a1 * self.a14 * r.a10 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + 2. * self.a2 * self.a11 * r.a8 + 2. * self.a2 * self.a12 * r.a9 + 2. * self.a2 * self.a13 * r.a10 + self.a3.powi(2) * r.a5 - 2. * self.a3 * self.a12 * r.a10 + 2. * self.a3 * self.a13 * r.a9 - 2. * self.a3 * self.a14 * r.a7 + self.a4.powi(2) * r.a5 - 2. * self.a4 * self.a11 * r.a10 + 2. * self.a4 * self.a13 * r.a8 + 2. * self.a4 * self.a14 * r.a6 + 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 - 2. * self.a8 * self.a15 * r.a9 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 + 2. * self.a9 * self.a15 * r.a8 + self.a10.powi(2) * r.a5 - 2. * self.a11 * self.a14 * r.a9 + 2. * self.a12 * self.a14 * r.a8 - self.a14.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a5 * r.a8 - 2. * self.a0 * self.a7 * r.a10 - 2. * self.a0 * self.a8 * r.a5 + 2. * self.a0 * self.a10 * r.a7 - 2. * self.a0 * self.a15 * r.a9 - 2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + 2. * self.a1 * self.a14 * r.a9 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 + 2. * self.a2 * self.a12 * r.a10 - 2. * self.a2 * self.a13 * r.a9 + 2. * self.a2 * self.a14 * r.a7 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + 2. * self.a3 * self.a11 * r.a8 + 2. * self.a3 * self.a12 * r.a9 + 2. * self.a3 * self.a13 * r.a10 + self.a4.powi(2) * r.a6 - 2. * self.a4 * self.a11 * r.a9 + 2. * self.a4 * self.a12 * r.a8 - 2. * self.a4 * self.a14 * r.a5 + 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 + 2. * self.a8 * self.a15 * r.a10 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6 - 2. * self.a10 * self.a15 * r.a8 + 2. * self.a11 * self.a14 * r.a10 - 2. * self.a13 * self.a14 * r.a8 - self.a14.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a0 * self.a5 * r.a9 + 2. * self.a0 * self.a6 * r.a10 + 2. * self.a0 * self.a9 * r.a5 - 2. * self.a0 * self.a10 * r.a6 - 2. * self.a0 * self.a15 * r.a8 + 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + 2. * self.a1 * self.a14 * r.a8 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + 2. * self.a2 * self.a11 * r.a10 - 2. * self.a2 * self.a13 * r.a8 - 2. * self.a2 * self.a14 * r.a6 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 + 2. * self.a3 * self.a11 * r.a9 - 2. * self.a3 * self.a12 * r.a8 + 2. * self.a3 * self.a14 * r.a5 - self.a4.powi(2) * r.a7 + 2. * self.a4 * self.a11 * r.a8 + 2. * self.a4 * self.a12 * r.a9 + 2. * self.a4 * self.a13 * r.a10 + 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 - 2. * self.a9 * self.a15 * r.a10 - self.a10.powi(2) * r.a7 + 2. * self.a10 * self.a15 * r.a9 - 2. * self.a12 * self.a14 * r.a10 + 2. * self.a13 * self.a14 * r.a9 - self.a14.powi(2) * r.a7,
            a8: self.a0 * (self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9) + self.a2 * (-self.a2 * r.a8 + self.a4 * r.a10 + self.a14 * r.a9) - self.a3 * (self.a3 * r.a8 - self.a4 * r.a9 + self.a14 * r.a10) + self.a4 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + self.a8 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + self.a9 * (self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8) - self.a10 * (self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8) + self.a14 * (self.a2 * r.a9 - self.a3 * r.a10 + self.a14 * r.a8),
            a9: self.a0 * (self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8) - self.a2 * (self.a2 * r.a9 - self.a3 * r.a10 + self.a14 * r.a8) + self.a3 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + self.a4 * (self.a3 * r.a8 - self.a4 * r.a9 + self.a14 * r.a10) - self.a8 * (self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8) + self.a9 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + self.a10 * (self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9) + self.a14 * (-self.a2 * r.a8 + self.a4 * r.a10 + self.a14 * r.a9),
            a10: self.a0 * (self.a0 * r.a10 + self.a8 * r.a9 - self.a9 * r.a8) + self.a2 * (self.a2 * r.a10 + self.a3 * r.a9 + self.a4 * r.a8) + self.a3 * (self.a2 * r.a9 - self.a3 * r.a10 + self.a14 * r.a8) - self.a4 * (-self.a2 * r.a8 + self.a4 * r.a10 + self.a14 * r.a9) + self.a8 * (self.a0 * r.a9 - self.a8 * r.a10 + self.a10 * r.a8) - self.a9 * (self.a0 * r.a8 + self.a9 * r.a10 - self.a10 * r.a9) + self.a10 * (self.a8 * r.a8 + self.a9 * r.a9 + self.a10 * r.a10) + self.a14 * (self.a3 * r.a8 - self.a4 * r.a9 + self.a14 * r.a10),
            a11: -2. * self.a0 * self.a1 * r.a8 + 2. * self.a0 * self.a2 * r.a6 - 2. * self.a0 * self.a3 * r.a5 + 2. * self.a0 * self.a12 * r.a10 - 2. * self.a0 * self.a13 * r.a9 + 2. * self.a0 * self.a14 * r.a7 - 2. * self.a1 * self.a9 * r.a10 + 2. * self.a1 * self.a10 * r.a9 + 2. * self.a2 * self.a5 * r.a8 - 2. * self.a2 * self.a7 * r.a10 - 2. * self.a2 * self.a8 * r.a5 + 2. * self.a2 * self.a10 * r.a7 - 2. * self.a2 * self.a15 * r.a9 + 2. * self.a3 * self.a6 * r.a8 - 2. * self.a3 * self.a7 * r.a9 - 2. * self.a3 * self.a8 * r.a6 + 2. * self.a3 * self.a9 * r.a7 + 2. * self.a3 * self.a15 * r.a10 - 2. * self.a4 * self.a5 * r.a10 - 2. * self.a4 * self.a6 * r.a9 - 2. * self.a4 * self.a7 * r.a8 - 2. * self.a4 * self.a8 * r.a7 - 2. * self.a4 * self.a9 * r.a6 - 2. * self.a4 * self.a10 * r.a5 - 2. * self.a5 * self.a14 * r.a9 + 2. * self.a6 * self.a14 * r.a10 + 2. * self.a8 * self.a11 * r.a8 + 2. * self.a8 * self.a12 * r.a9 + 2. * self.a8 * self.a13 * r.a10 + 2. * self.a9 * self.a11 * r.a9 - 2. * self.a9 * self.a12 * r.a8 + 2. * self.a9 * self.a14 * r.a5 + 2. * self.a10 * self.a11 * r.a10 - 2. * self.a10 * self.a13 * r.a8 - 2. * self.a10 * self.a14 * r.a6 - 2. * self.a14 * self.a15 * r.a8,
            a12: -2. * self.a0 * self.a1 * r.a9 - 2. * self.a0 * self.a2 * r.a7 + 2. * self.a0 * self.a4 * r.a5 - 2. * self.a0 * self.a11 * r.a10 + 2. * self.a0 * self.a13 * r.a8 + 2. * self.a0 * self.a14 * r.a6 + 2. * self.a1 * self.a8 * r.a10 - 2. * self.a1 * self.a10 * r.a8 + 2. * self.a2 * self.a5 * r.a9 - 2. * self.a2 * self.a6 * r.a10 - 2. * self.a2 * self.a9 * r.a5 + 2. * self.a2 * self.a10 * r.a6 + 2. * self.a2 * self.a15 * r.a8 - 2. * self.a3 * self.a5 * r.a10 - 2. * self.a3 * self.a6 * r.a9 - 2. * self.a3 * self.a7 * r.a8 - 2. * self.a3 * self.a8 * r.a7 - 2. * self.a3 * self.a9 * r.a6 - 2. * self.a3 * self.a10 * r.a5 - 2. * self.a4 * self.a6 * r.a8 + 2. * self.a4 * self.a7 * r.a9 + 2. * self.a4 * self.a8 * r.a6 - 2. * self.a4 * self.a9 * r.a7 - 2. * self.a4 * self.a15 * r.a10 + 2. * self.a5 * self.a14 * r.a8 - 2. * self.a7 * self.a14 * r.a10 - 2. * self.a8 * self.a11 * r.a9 + 2. * self.a8 * self.a12 * r.a8 - 2. * self.a8 * self.a14 * r.a5 + 2. * self.a9 * self.a11 * r.a8 + 2. * self.a9 * self.a12 * r.a9 + 2. * self.a9 * self.a13 * r.a10 + 2. * self.a10 * self.a12 * r.a10 - 2. * self.a10 * self.a13 * r.a9 + 2. * self.a10 * self.a14 * r.a7 - 2. * self.a14 * self.a15 * r.a9,
            a13: -2. * self.a0 * self.a1 * r.a10 + 2. * self.a0 * self.a3 * r.a7 - 2. * self.a0 * self.a4 * r.a6 + 2. * self.a0 * self.a11 * r.a9 - 2. * self.a0 * self.a12 * r.a8 + 2. * self.a0 * self.a14 * r.a5 - 2. * self.a1 * self.a8 * r.a9 + 2. * self.a1 * self.a9 * r.a8 - 2. * self.a2 * self.a5 * r.a10 - 2. * self.a2 * self.a6 * r.a9 - 2. * self.a2 * self.a7 * r.a8 - 2. * self.a2 * self.a8 * r.a7 - 2. * self.a2 * self.a9 * r.a6 - 2. * self.a2 * self.a10 * r.a5 - 2. * self.a3 * self.a5 * r.a9 + 2. * self.a3 * self.a6 * r.a10 + 2. * self.a3 * self.a9 * r.a5 - 2. * self.a3 * self.a10 * r.a6 - 2. * self.a3 * self.a15 * r.a8 - 2. * self.a4 * self.a5 * r.a8 + 2. * self.a4 * self.a7 * r.a10 + 2. * self.a4 * self.a8 * r.a5 - 2. * self.a4 * self.a10 * r.a7 + 2. * self.a4 * self.a15 * r.a9 - 2. * self.a6 * self.a14 * r.a8 + 2. * self.a7 * self.a14 * r.a9 - 2. * self.a8 * self.a11 * r.a10 + 2. * self.a8 * self.a13 * r.a8 + 2. * self.a8 * self.a14 * r.a6 - 2. * self.a9 * self.a12 * r.a10 + 2. * self.a9 * self.a13 * r.a9 - 2. * self.a9 * self.a14 * r.a7 + 2. * self.a10 * self.a11 * r.a8 + 2. * self.a10 * self.a12 * r.a9 + 2. * self.a10 * self.a13 * r.a10 - 2. * self.a14 * self.a15 * r.a10,
            a14: 2. * self.a0 * self.a2 * r.a10 + 2. * self.a0 * self.a3 * r.a9 + 2. * self.a0 * self.a4 * r.a8 + 2. * self.a2 * self.a8 * r.a9 - 2. * self.a2 * self.a9 * r.a8 - 2. * self.a3 * self.a8 * r.a10 + 2. * self.a3 * self.a10 * r.a8 + 2. * self.a4 * self.a9 * r.a10 - 2. * self.a4 * self.a10 * r.a9 + 2. * self.a8 * self.a14 * r.a8 + 2. * self.a9 * self.a14 * r.a9 + 2. * self.a10 * self.a14 * r.a10,
            a15: 0.,
        }
    }
}

impl Shr<ScalarAndBivector> for FullMultivector {
    type Output = FullMultivector;

    fn shr(self, r: ScalarAndBivector) -> FullMultivector {
        FullMultivector {
            a0: r.a0 * (self.a0.powi(2) + self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2) + self.a14.powi(2)),
            a1: 2. * r.a0 * (self.a0 * self.a1 + self.a2 * self.a5 + self.a3 * self.a6 + self.a4 * self.a7 - self.a8 * self.a11 - self.a9 * self.a12 - self.a10 * self.a13 + self.a14 * self.a15),
            a2: 2. * r.a0 * (self.a0 * self.a2 + self.a3 * self.a8 - self.a4 * self.a9 + self.a10 * self.a14),
            a3: 2. * r.a0 * (self.a0 * self.a3 - self.a2 * self.a8 + self.a4 * self.a10 + self.a9 * self.a14),
            a4: 2. * r.a0 * (self.a0 * self.a4 + self.a2 * self.a9 - self.a3 * self.a10 + self.a8 * self.a14),
            a5: self.a0.powi(2) * r.a5 - 2. * self.a0 * self.a6 * r.a8 + 2. * self.a0 * self.a7 * r.a9 + 2. * self.a0 * self.a8 * r.a6 - 2. * self.a0 * self.a9 * r.a7 - 2. * self.a0 * self.a15 * r.a10 + 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 + 2. * self.a1 * self.a14 * r.a10 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + 2. * self.a2 * self.a11 * r.a8 + 2. * self.a2 * self.a12 * r.a9 + 2. * self.a2 * self.a13 * r.a10 + self.a3.powi(2) * r.a5 - 2. * self.a3 * self.a12 * r.a10 + 2. * self.a3 * self.a13 * r.a9 - 2. * self.a3 * self.a14 * r.a7 + self.a4.powi(2) * r.a5 - 2. * self.a4 * self.a11 * r.a10 + 2. * self.a4 * self.a13 * r.a8 + 2. * self.a4 * self.a14 * r.a6 + 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 - 2. * self.a8 * self.a15 * r.a9 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 + 2. * self.a9 * self.a15 * r.a8 + self.a10.powi(2) * r.a5 - 2. * self.a11 * self.a14 * r.a9 + 2. * self.a12 * self.a14 * r.a8 - self.a14.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a5 * r.a8 - 2. * self.a0 * self.a7 * r.a10 - 2. * self.a0 * self.a8 * r.a5 + 2. * self.a0 * self.a10 * r.a7 - 2. * self.a0 * self.a15 * r.a9 - 2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + 2. * self.a1 * self.a14 * r.a9 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 + 2. * self.a2 * self.a12 * r.a10 - 2. * self.a2 * self.a13 * r.a9 + 2. * self.a2 * self.a14 * r.a7 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + 2. * self.a3 * self.a11 * r.a8 + 2. * self.a3 * self.a12 * r.a9 + 2. * self.a3 * self.a13 * r.a10 + self.a4.powi(2) * r.a6 - 2. * self.a4 * self.a11 * r.a9 + 2. * self.a4 * self.a12 * r.a8 - 2. * self.a4 * self.a14 * r.a5 + 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 + 2. * self.a8 * self.a15 * r.a10 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6 - 2. * self.a10 * self.a15 * r.a8 + 2. * self.a11 * self.a14 * r.a10 - 2. * self.a13 * self.a14 * r.a8 - self.a14.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a0 * self.a5 * r.a9 + 2. * self.a0 * self.a6 * r.a10 + 2. * self.a0 * self.a9 * r.a5 - 2. * self.a0 * self.a10 * r.a6 - 2. * self.a0 * self.a15 * r.a8 + 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + 2. * self.a1 * self.a14 * r.a8 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + 2. * self.a2 * self.a11 * r.a10 - 2. * self.a2 * self.a13 * r.a8 - 2. * self.a2 * self.a14 * r.a6 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 + 2. * self.a3 * self.a11 * r.a9 - 2. * self.a3 * self.a12 * r.a8 + 2. * self.a3 * self.a14 * r.a5 - self.a4.powi(2) * r.a7 + 2. * self.a4 * self.a11 * r.a8 + 2. * self.a4 * self.a12 * r.a9 + 2. * self.a4 * self.a13 * r.a10 + 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 - 2. * self.a9 * self.a15 * r.a10 - self.a10.powi(2) * r.a7 + 2. * self.a10 * self.a15 * r.a9 - 2. * self.a12 * self.a14 * r.a10 + 2. * self.a13 * self.a14 * r.a9 - self.a14.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 + 2. * self.a0 * self.a9 * r.a10 - 2. * self.a0 * self.a10 * r.a9 - self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 + 2. * self.a2 * self.a14 * r.a9 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 - 2. * self.a3 * self.a14 * r.a10 + self.a4.powi(2) * r.a8 + self.a8.powi(2) * r.a8 + 2. * self.a8 * self.a9 * r.a9 + 2. * self.a8 * self.a10 * r.a10 - self.a9.powi(2) * r.a8 - self.a10.powi(2) * r.a8 + self.a14.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 - 2. * self.a0 * self.a8 * r.a10 + 2. * self.a0 * self.a10 * r.a8 - self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 - 2. * self.a2 * self.a14 * r.a8 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 - self.a4.powi(2) * r.a9 + 2. * self.a4 * self.a14 * r.a10 - self.a8.powi(2) * r.a9 + 2. * self.a8 * self.a9 * r.a8 + self.a9.powi(2) * r.a9 + 2. * self.a9 * self.a10 * r.a10 - self.a10.powi(2) * r.a9 + self.a14.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + 2. * self.a0 * self.a8 * r.a9 - 2. * self.a0 * self.a9 * r.a8 + self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 - self.a3.powi(2) * r.a10 + 2. * self.a3 * self.a14 * r.a8 - self.a4.powi(2) * r.a10 - 2. * self.a4 * self.a14 * r.a9 - self.a8.powi(2) * r.a10 + 2. * self.a8 * self.a10 * r.a8 - self.a9.powi(2) * r.a10 + 2. * self.a9 * self.a10 * r.a9 + self.a10.powi(2) * r.a10 + self.a14.powi(2) * r.a10,
            a11: -2. * self.a0 * self.a1 * r.a8 + 2. * self.a0 * self.a2 * r.a6 - 2. * self.a0 * self.a3 * r.a5 + 2. * self.a0 * self.a12 * r.a10 - 2. * self.a0 * self.a13 * r.a9 + 2. * self.a0 * self.a14 * r.a7 - 2. * self.a1 * self.a9 * r.a10 + 2. * self.a1 * self.a10 * r.a9 + 2. * self.a2 * self.a5 * r.a8 - 2. * self.a2 * self.a7 * r.a10 - 2. * self.a2 * self.a8 * r.a5 + 2. * self.a2 * self.a10 * r.a7 - 2. * self.a2 * self.a15 * r.a9 + 2. * self.a3 * self.a6 * r.a8 - 2. * self.a3 * self.a7 * r.a9 - 2. * self.a3 * self.a8 * r.a6 + 2. * self.a3 * self.a9 * r.a7 + 2. * self.a3 * self.a15 * r.a10 - 2. * self.a4 * self.a5 * r.a10 - 2. * self.a4 * self.a6 * r.a9 - 2. * self.a4 * self.a7 * r.a8 - 2. * self.a4 * self.a8 * r.a7 - 2. * self.a4 * self.a9 * r.a6 - 2. * self.a4 * self.a10 * r.a5 - 2. * self.a5 * self.a14 * r.a9 + 2. * self.a6 * self.a14 * r.a10 + 2. * self.a8 * self.a11 * r.a8 + 2. * self.a8 * self.a12 * r.a9 + 2. * self.a8 * self.a13 * r.a10 + 2. * self.a9 * self.a11 * r.a9 - 2. * self.a9 * self.a12 * r.a8 + 2. * self.a9 * self.a14 * r.a5 + 2. * self.a10 * self.a11 * r.a10 - 2. * self.a10 * self.a13 * r.a8 - 2. * self.a10 * self.a14 * r.a6 - 2. * self.a14 * self.a15 * r.a8,
            a12: -2. * self.a0 * self.a1 * r.a9 - 2. * self.a0 * self.a2 * r.a7 + 2. * self.a0 * self.a4 * r.a5 - 2. * self.a0 * self.a11 * r.a10 + 2. * self.a0 * self.a13 * r.a8 + 2. * self.a0 * self.a14 * r.a6 + 2. * self.a1 * self.a8 * r.a10 - 2. * self.a1 * self.a10 * r.a8 + 2. * self.a2 * self.a5 * r.a9 - 2. * self.a2 * self.a6 * r.a10 - 2. * self.a2 * self.a9 * r.a5 + 2. * self.a2 * self.a10 * r.a6 + 2. * self.a2 * self.a15 * r.a8 - 2. * self.a3 * self.a5 * r.a10 - 2. * self.a3 * self.a6 * r.a9 - 2. * self.a3 * self.a7 * r.a8 - 2. * self.a3 * self.a8 * r.a7 - 2. * self.a3 * self.a9 * r.a6 - 2. * self.a3 * self.a10 * r.a5 - 2. * self.a4 * self.a6 * r.a8 + 2. * self.a4 * self.a7 * r.a9 + 2. * self.a4 * self.a8 * r.a6 - 2. * self.a4 * self.a9 * r.a7 - 2. * self.a4 * self.a15 * r.a10 + 2. * self.a5 * self.a14 * r.a8 - 2. * self.a7 * self.a14 * r.a10 - 2. * self.a8 * self.a11 * r.a9 + 2. * self.a8 * self.a12 * r.a8 - 2. * self.a8 * self.a14 * r.a5 + 2. * self.a9 * self.a11 * r.a8 + 2. * self.a9 * self.a12 * r.a9 + 2. * self.a9 * self.a13 * r.a10 + 2. * self.a10 * self.a12 * r.a10 - 2. * self.a10 * self.a13 * r.a9 + 2. * self.a10 * self.a14 * r.a7 - 2. * self.a14 * self.a15 * r.a9,
            a13: -2. * self.a0 * self.a1 * r.a10 + 2. * self.a0 * self.a3 * r.a7 - 2. * self.a0 * self.a4 * r.a6 + 2. * self.a0 * self.a11 * r.a9 - 2. * self.a0 * self.a12 * r.a8 + 2. * self.a0 * self.a14 * r.a5 - 2. * self.a1 * self.a8 * r.a9 + 2. * self.a1 * self.a9 * r.a8 - 2. * self.a2 * self.a5 * r.a10 - 2. * self.a2 * self.a6 * r.a9 - 2. * self.a2 * self.a7 * r.a8 - 2. * self.a2 * self.a8 * r.a7 - 2. * self.a2 * self.a9 * r.a6 - 2. * self.a2 * self.a10 * r.a5 - 2. * self.a3 * self.a5 * r.a9 + 2. * self.a3 * self.a6 * r.a10 + 2. * self.a3 * self.a9 * r.a5 - 2. * self.a3 * self.a10 * r.a6 - 2. * self.a3 * self.a15 * r.a8 - 2. * self.a4 * self.a5 * r.a8 + 2. * self.a4 * self.a7 * r.a10 + 2. * self.a4 * self.a8 * r.a5 - 2. * self.a4 * self.a10 * r.a7 + 2. * self.a4 * self.a15 * r.a9 - 2. * self.a6 * self.a14 * r.a8 + 2. * self.a7 * self.a14 * r.a9 - 2. * self.a8 * self.a11 * r.a10 + 2. * self.a8 * self.a13 * r.a8 + 2. * self.a8 * self.a14 * r.a6 - 2. * self.a9 * self.a12 * r.a10 + 2. * self.a9 * self.a13 * r.a9 - 2. * self.a9 * self.a14 * r.a7 + 2. * self.a10 * self.a11 * r.a8 + 2. * self.a10 * self.a12 * r.a9 + 2. * self.a10 * self.a13 * r.a10 - 2. * self.a14 * self.a15 * r.a10,
            a14: 2. * self.a0 * self.a2 * r.a10 + 2. * self.a0 * self.a3 * r.a9 + 2. * self.a0 * self.a4 * r.a8 + 2. * self.a2 * self.a8 * r.a9 - 2. * self.a2 * self.a9 * r.a8 - 2. * self.a3 * self.a8 * r.a10 + 2. * self.a3 * self.a10 * r.a8 + 2. * self.a4 * self.a9 * r.a10 - 2. * self.a4 * self.a10 * r.a9 + 2. * self.a8 * self.a14 * r.a8 + 2. * self.a9 * self.a14 * r.a9 + 2. * self.a10 * self.a14 * r.a10,
            a15: 2. * r.a0 * (self.a0 * self.a15 - self.a1 * self.a14 - self.a2 * self.a13 - self.a3 * self.a12 - self.a4 * self.a11 - self.a5 * self.a10 - self.a6 * self.a9 - self.a7 * self.a8),
        }
    }
}

impl Shr<Trivector> for FullMultivector {
    type Output = FullMultivector;

    fn shr(self, r: Trivector) -> FullMultivector {
        FullMultivector {
            a0: 0.,
            a1: 0.,
            a2: 0.,
            a3: 0.,
            a4: 0.,
            a5: -2. * self.a0 * self.a3 * r.a11 + 2. * self.a0 * self.a4 * r.a12 + 2. * self.a0 * self.a13 * r.a14 - 2. * self.a0 * self.a14 * r.a13 + 2. * self.a1 * self.a10 * r.a14 + 2. * self.a2 * self.a8 * r.a11 + 2. * self.a2 * self.a9 * r.a12 + 2. * self.a2 * self.a10 * r.a13 - 2. * self.a2 * self.a15 * r.a14 + 2. * self.a3 * self.a7 * r.a14 - 2. * self.a3 * self.a9 * r.a13 + 2. * self.a3 * self.a10 * r.a12 - 2. * self.a4 * self.a6 * r.a14 - 2. * self.a4 * self.a8 * r.a13 + 2. * self.a4 * self.a10 * r.a11 + 2. * self.a5 * self.a14 * r.a14 + 2. * self.a8 * self.a12 * r.a14 - 2. * self.a8 * self.a14 * r.a12 - 2. * self.a9 * self.a11 * r.a14 + 2. * self.a9 * self.a14 * r.a11,
            a6: 2. * self.a0 * self.a2 * r.a11 - 2. * self.a0 * self.a4 * r.a13 + 2. * self.a0 * self.a12 * r.a14 - 2. * self.a0 * self.a14 * r.a12 + 2. * self.a1 * self.a9 * r.a14 - 2. * self.a2 * self.a7 * r.a14 + 2. * self.a2 * self.a9 * r.a13 - 2. * self.a2 * self.a10 * r.a12 + 2. * self.a3 * self.a8 * r.a11 + 2. * self.a3 * self.a9 * r.a12 + 2. * self.a3 * self.a10 * r.a13 - 2. * self.a3 * self.a15 * r.a14 + 2. * self.a4 * self.a5 * r.a14 - 2. * self.a4 * self.a8 * r.a12 + 2. * self.a4 * self.a9 * r.a11 + 2. * self.a6 * self.a14 * r.a14 - 2. * self.a8 * self.a13 * r.a14 + 2. * self.a8 * self.a14 * r.a13 + 2. * self.a10 * self.a11 * r.a14 - 2. * self.a10 * self.a14 * r.a11,
            a7: -2. * self.a0 * self.a2 * r.a12 + 2. * self.a0 * self.a3 * r.a13 + 2. * self.a0 * self.a11 * r.a14 - 2. * self.a0 * self.a14 * r.a11 + 2. * self.a1 * self.a8 * r.a14 + 2. * self.a2 * self.a6 * r.a14 + 2. * self.a2 * self.a8 * r.a13 - 2. * self.a2 * self.a10 * r.a11 - 2. * self.a3 * self.a5 * r.a14 + 2. * self.a3 * self.a8 * r.a12 - 2. * self.a3 * self.a9 * r.a11 + 2. * self.a4 * self.a8 * r.a11 + 2. * self.a4 * self.a9 * r.a12 + 2. * self.a4 * self.a10 * r.a13 - 2. * self.a4 * self.a15 * r.a14 + 2. * self.a7 * self.a14 * r.a14 + 2. * self.a9 * self.a13 * r.a14 - 2. * self.a9 * self.a14 * r.a13 - 2. * self.a10 * self.a12 * r.a14 + 2. * self.a10 * self.a14 * r.a12,
            a8: 2. * r.a14 * (self.a0 * self.a4 + self.a2 * self.a9 - self.a3 * self.a10 + self.a8 * self.a14),
            a9: 2. * r.a14 * (self.a0 * self.a3 - self.a2 * self.a8 + self.a4 * self.a10 + self.a9 * self.a14),
            a10: 2. * r.a14 * (self.a0 * self.a2 + self.a3 * self.a8 - self.a4 * self.a9 + self.a10 * self.a14),
            a11: self.a0.powi(2) * r.a11 - 2. * self.a0 * self.a7 * r.a14 + 2. * self.a0 * self.a9 * r.a13 - 2. * self.a0 * self.a10 * r.a12 - 2. * self.a1 * self.a4 * r.a14 + self.a2.powi(2) * r.a11 - 2. * self.a2 * self.a4 * r.a13 + 2. * self.a2 * self.a12 * r.a14 - 2. * self.a2 * self.a14 * r.a12 + self.a3.powi(2) * r.a11 - 2. * self.a3 * self.a4 * r.a12 - 2. * self.a3 * self.a13 * r.a14 + 2. * self.a3 * self.a14 * r.a13 - self.a4.powi(2) * r.a11 - 2. * self.a5 * self.a9 * r.a14 + 2. * self.a6 * self.a10 * r.a14 + self.a8.powi(2) * r.a11 + 2. * self.a8 * self.a9 * r.a12 + 2. * self.a8 * self.a10 * r.a13 - 2. * self.a8 * self.a15 * r.a14 - self.a9.powi(2) * r.a11 - self.a10.powi(2) * r.a11 + 2. * self.a11 * self.a14 * r.a14 - self.a14.powi(2) * r.a11,
            a12: self.a0.powi(2) * r.a12 - 2. * self.a0 * self.a6 * r.a14 - 2. * self.a0 * self.a8 * r.a13 + 2. * self.a0 * self.a10 * r.a11 - 2. * self.a1 * self.a3 * r.a14 + self.a2.powi(2) * r.a12 - 2. * self.a2 * self.a3 * r.a13 - 2. * self.a2 * self.a11 * r.a14 + 2. * self.a2 * self.a14 * r.a11 - self.a3.powi(2) * r.a12 - 2. * self.a3 * self.a4 * r.a11 + self.a4.powi(2) * r.a12 + 2. * self.a4 * self.a13 * r.a14 - 2. * self.a4 * self.a14 * r.a13 + 2. * self.a5 * self.a8 * r.a14 - 2. * self.a7 * self.a10 * r.a14 - self.a8.powi(2) * r.a12 + 2. * self.a8 * self.a9 * r.a11 + self.a9.powi(2) * r.a12 + 2. * self.a9 * self.a10 * r.a13 - 2. * self.a9 * self.a15 * r.a14 - self.a10.powi(2) * r.a12 + 2. * self.a12 * self.a14 * r.a14 - self.a14.powi(2) * r.a12,
            a13: self.a0.powi(2) * r.a13 - 2. * self.a0 * self.a5 * r.a14 + 2. * self.a0 * self.a8 * r.a12 - 2. * self.a0 * self.a9 * r.a11 - 2. * self.a1 * self.a2 * r.a14 - self.a2.powi(2) * r.a13 - 2. * self.a2 * self.a3 * r.a12 - 2. * self.a2 * self.a4 * r.a11 + self.a3.powi(2) * r.a13 + 2. * self.a3 * self.a11 * r.a14 - 2. * self.a3 * self.a14 * r.a11 + self.a4.powi(2) * r.a13 - 2. * self.a4 * self.a12 * r.a14 + 2. * self.a4 * self.a14 * r.a12 - 2. * self.a6 * self.a8 * r.a14 + 2. * self.a7 * self.a9 * r.a14 - self.a8.powi(2) * r.a13 + 2. * self.a8 * self.a10 * r.a11 - self.a9.powi(2) * r.a13 + 2. * self.a9 * self.a10 * r.a12 + self.a10.powi(2) * r.a13 - 2. * self.a10 * self.a15 * r.a14 + 2. * self.a13 * self.a14 * r.a14 - self.a14.powi(2) * r.a13,
            a14: r.a14 * (self.a0.powi(2) + self.a2.powi(2) + self.a3.powi(2) + self.a4.powi(2) + self.a8.powi(2) + self.a9.powi(2) + self.a10.powi(2) + self.a14.powi(2)),
            a15: 0.,
        }
    }
}

impl Shr<FullMultivector> for FullMultivector {
    type Output = FullMultivector;

    fn shr(self, r: FullMultivector) -> FullMultivector {
        FullMultivector {
            a0: self.a0.powi(2) * r.a0 + 2. * self.a0 * self.a2 * r.a2 + 2. * self.a0 * self.a3 * r.a3 + 2. * self.a0 * self.a4 * r.a4 + self.a2.powi(2) * r.a0 + 2. * self.a2 * self.a8 * r.a3 - 2. * self.a2 * self.a9 * r.a4 + self.a3.powi(2) * r.a0 - 2. * self.a3 * self.a8 * r.a2 + 2. * self.a3 * self.a10 * r.a4 + self.a4.powi(2) * r.a0 + 2. * self.a4 * self.a9 * r.a2 - 2. * self.a4 * self.a10 * r.a3 + self.a8.powi(2) * r.a0 + 2. * self.a8 * self.a14 * r.a4 + self.a9.powi(2) * r.a0 + 2. * self.a9 * self.a14 * r.a3 + self.a10.powi(2) * r.a0 + 2. * self.a10 * self.a14 * r.a2 + self.a14.powi(2) * r.a0,
            a1: self.a0.powi(2) * r.a1 + 2. * self.a0 * self.a1 * r.a0 + 2. * self.a0 * self.a5 * r.a2 + 2. * self.a0 * self.a6 * r.a3 + 2. * self.a0 * self.a7 * r.a4 + 2. * self.a0 * self.a14 * r.a15 + 2. * self.a1 * self.a2 * r.a2 + 2. * self.a1 * self.a3 * r.a3 + 2. * self.a1 * self.a4 * r.a4 - self.a2.powi(2) * r.a1 + 2. * self.a2 * self.a5 * r.a0 - 2. * self.a2 * self.a10 * r.a15 - 2. * self.a2 * self.a11 * r.a3 + 2. * self.a2 * self.a12 * r.a4 - self.a3.powi(2) * r.a1 + 2. * self.a3 * self.a6 * r.a0 - 2. * self.a3 * self.a9 * r.a15 + 2. * self.a3 * self.a11 * r.a2 - 2. * self.a3 * self.a13 * r.a4 - self.a4.powi(2) * r.a1 + 2. * self.a4 * self.a7 * r.a0 - 2. * self.a4 * self.a8 * r.a15 - 2. * self.a4 * self.a12 * r.a2 + 2. * self.a4 * self.a13 * r.a3 + 2. * self.a5 * self.a8 * r.a3 - 2. * self.a5 * self.a9 * r.a4 - 2. * self.a6 * self.a8 * r.a2 + 2. * self.a6 * self.a10 * r.a4 + 2. * self.a7 * self.a9 * r.a2 - 2. * self.a7 * self.a10 * r.a3 + self.a8.powi(2) * r.a1 - 2. * self.a8 * self.a11 * r.a0 + 2. * self.a8 * self.a15 * r.a4 + self.a9.powi(2) * r.a1 - 2. * self.a9 * self.a12 * r.a0 + 2. * self.a9 * self.a15 * r.a3 + self.a10.powi(2) * r.a1 - 2. * self.a10 * self.a13 * r.a0 + 2. * self.a10 * self.a15 * r.a2 - 2. * self.a11 * self.a14 * r.a4 - 2. * self.a12 * self.a14 * r.a3 - 2. * self.a13 * self.a14 * r.a2 - self.a14.powi(2) * r.a1 + 2. * self.a14 * self.a15 * r.a0,
            a2: self.a0.powi(2) * r.a2 + 2. * self.a0 * self.a2 * r.a0 + 2. * self.a0 * self.a8 * r.a3 - 2. * self.a0 * self.a9 * r.a4 + self.a2.powi(2) * r.a2 + 2. * self.a2 * self.a3 * r.a3 + 2. * self.a2 * self.a4 * r.a4 - self.a3.powi(2) * r.a2 + 2. * self.a3 * self.a8 * r.a0 + 2. * self.a3 * self.a14 * r.a4 - self.a4.powi(2) * r.a2 - 2. * self.a4 * self.a9 * r.a0 - 2. * self.a4 * self.a14 * r.a3 - self.a8.powi(2) * r.a2 + 2. * self.a8 * self.a10 * r.a4 - self.a9.powi(2) * r.a2 + 2. * self.a9 * self.a10 * r.a3 + self.a10.powi(2) * r.a2 + 2. * self.a10 * self.a14 * r.a0 + self.a14.powi(2) * r.a2,
            a3: self.a0.powi(2) * r.a3 + 2. * self.a0 * self.a3 * r.a0 - 2. * self.a0 * self.a8 * r.a2 + 2. * self.a0 * self.a10 * r.a4 - self.a2.powi(2) * r.a3 + 2. * self.a2 * self.a3 * r.a2 - 2. * self.a2 * self.a8 * r.a0 - 2. * self.a2 * self.a14 * r.a4 + self.a3.powi(2) * r.a3 + 2. * self.a3 * self.a4 * r.a4 - self.a4.powi(2) * r.a3 + 2. * self.a4 * self.a10 * r.a0 + 2. * self.a4 * self.a14 * r.a2 - self.a8.powi(2) * r.a3 + 2. * self.a8 * self.a9 * r.a4 + self.a9.powi(2) * r.a3 + 2. * self.a9 * self.a10 * r.a2 + 2. * self.a9 * self.a14 * r.a0 - self.a10.powi(2) * r.a3 + self.a14.powi(2) * r.a3,
            a4: self.a0.powi(2) * r.a4 + 2. * self.a0 * self.a4 * r.a0 + 2. * self.a0 * self.a9 * r.a2 - 2. * self.a0 * self.a10 * r.a3 - self.a2.powi(2) * r.a4 + 2. * self.a2 * self.a4 * r.a2 + 2. * self.a2 * self.a9 * r.a0 + 2. * self.a2 * self.a14 * r.a3 - self.a3.powi(2) * r.a4 + 2. * self.a3 * self.a4 * r.a3 - 2. * self.a3 * self.a10 * r.a0 - 2. * self.a3 * self.a14 * r.a2 + self.a4.powi(2) * r.a4 + self.a8.powi(2) * r.a4 + 2. * self.a8 * self.a9 * r.a3 + 2. * self.a8 * self.a10 * r.a2 + 2. * self.a8 * self.a14 * r.a0 - self.a9.powi(2) * r.a4 - self.a10.powi(2) * r.a4 + self.a14.powi(2) * r.a4,
            a5: self.a0.powi(2) * r.a5 - 2. * self.a0 * self.a3 * r.a11 + 2. * self.a0 * self.a4 * r.a12 - 2. * self.a0 * self.a6 * r.a8 + 2. * self.a0 * self.a7 * r.a9 + 2. * self.a0 * self.a8 * r.a6 - 2. * self.a0 * self.a9 * r.a7 + 2. * self.a0 * self.a13 * r.a14 - 2. * self.a0 * self.a14 * r.a13 - 2. * self.a0 * self.a15 * r.a10 + 2. * self.a1 * self.a3 * r.a8 - 2. * self.a1 * self.a4 * r.a9 + 2. * self.a1 * self.a10 * r.a14 + 2. * self.a1 * self.a14 * r.a10 - self.a2.powi(2) * r.a5 - 2. * self.a2 * self.a3 * r.a6 - 2. * self.a2 * self.a4 * r.a7 + 2. * self.a2 * self.a8 * r.a11 + 2. * self.a2 * self.a9 * r.a12 + 2. * self.a2 * self.a10 * r.a13 + 2. * self.a2 * self.a11 * r.a8 + 2. * self.a2 * self.a12 * r.a9 + 2. * self.a2 * self.a13 * r.a10 - 2. * self.a2 * self.a15 * r.a14 + self.a3.powi(2) * r.a5 + 2. * self.a3 * self.a7 * r.a14 - 2. * self.a3 * self.a9 * r.a13 + 2. * self.a3 * self.a10 * r.a12 - 2. * self.a3 * self.a12 * r.a10 + 2. * self.a3 * self.a13 * r.a9 - 2. * self.a3 * self.a14 * r.a7 + self.a4.powi(2) * r.a5 - 2. * self.a4 * self.a6 * r.a14 - 2. * self.a4 * self.a8 * r.a13 + 2. * self.a4 * self.a10 * r.a11 - 2. * self.a4 * self.a11 * r.a10 + 2. * self.a4 * self.a13 * r.a8 + 2. * self.a4 * self.a14 * r.a6 + 2. * self.a5 * self.a8 * r.a8 + 2. * self.a5 * self.a9 * r.a9 + 2. * self.a5 * self.a10 * r.a10 + 2. * self.a5 * self.a14 * r.a14 - 2. * self.a6 * self.a9 * r.a10 + 2. * self.a6 * self.a10 * r.a9 - 2. * self.a7 * self.a8 * r.a10 + 2. * self.a7 * self.a10 * r.a8 - self.a8.powi(2) * r.a5 + 2. * self.a8 * self.a10 * r.a7 + 2. * self.a8 * self.a12 * r.a14 - 2. * self.a8 * self.a14 * r.a12 - 2. * self.a8 * self.a15 * r.a9 - self.a9.powi(2) * r.a5 + 2. * self.a9 * self.a10 * r.a6 - 2. * self.a9 * self.a11 * r.a14 + 2. * self.a9 * self.a14 * r.a11 + 2. * self.a9 * self.a15 * r.a8 + self.a10.powi(2) * r.a5 - 2. * self.a11 * self.a14 * r.a9 + 2. * self.a12 * self.a14 * r.a8 - self.a14.powi(2) * r.a5,
            a6: self.a0.powi(2) * r.a6 + 2. * self.a0 * self.a2 * r.a11 - 2. * self.a0 * self.a4 * r.a13 + 2. * self.a0 * self.a5 * r.a8 - 2. * self.a0 * self.a7 * r.a10 - 2. * self.a0 * self.a8 * r.a5 + 2. * self.a0 * self.a10 * r.a7 + 2. * self.a0 * self.a12 * r.a14 - 2. * self.a0 * self.a14 * r.a12 - 2. * self.a0 * self.a15 * r.a9 - 2. * self.a1 * self.a2 * r.a8 + 2. * self.a1 * self.a4 * r.a10 + 2. * self.a1 * self.a9 * r.a14 + 2. * self.a1 * self.a14 * r.a9 + self.a2.powi(2) * r.a6 - 2. * self.a2 * self.a3 * r.a5 - 2. * self.a2 * self.a7 * r.a14 + 2. * self.a2 * self.a9 * r.a13 - 2. * self.a2 * self.a10 * r.a12 + 2. * self.a2 * self.a12 * r.a10 - 2. * self.a2 * self.a13 * r.a9 + 2. * self.a2 * self.a14 * r.a7 - self.a3.powi(2) * r.a6 - 2. * self.a3 * self.a4 * r.a7 + 2. * self.a3 * self.a8 * r.a11 + 2. * self.a3 * self.a9 * r.a12 + 2. * self.a3 * self.a10 * r.a13 + 2. * self.a3 * self.a11 * r.a8 + 2. * self.a3 * self.a12 * r.a9 + 2. * self.a3 * self.a13 * r.a10 - 2. * self.a3 * self.a15 * r.a14 + self.a4.powi(2) * r.a6 + 2. * self.a4 * self.a5 * r.a14 - 2. * self.a4 * self.a8 * r.a12 + 2. * self.a4 * self.a9 * r.a11 - 2. * self.a4 * self.a11 * r.a9 + 2. * self.a4 * self.a12 * r.a8 - 2. * self.a4 * self.a14 * r.a5 + 2. * self.a5 * self.a9 * r.a10 - 2. * self.a5 * self.a10 * r.a9 + 2. * self.a6 * self.a8 * r.a8 + 2. * self.a6 * self.a9 * r.a9 + 2. * self.a6 * self.a10 * r.a10 + 2. * self.a6 * self.a14 * r.a14 - 2. * self.a7 * self.a8 * r.a9 + 2. * self.a7 * self.a9 * r.a8 - self.a8.powi(2) * r.a6 + 2. * self.a8 * self.a9 * r.a7 - 2. * self.a8 * self.a13 * r.a14 + 2. * self.a8 * self.a14 * r.a13 + 2. * self.a8 * self.a15 * r.a10 + self.a9.powi(2) * r.a6 + 2. * self.a9 * self.a10 * r.a5 - self.a10.powi(2) * r.a6 + 2. * self.a10 * self.a11 * r.a14 - 2. * self.a10 * self.a14 * r.a11 - 2. * self.a10 * self.a15 * r.a8 + 2. * self.a11 * self.a14 * r.a10 - 2. * self.a13 * self.a14 * r.a8 - self.a14.powi(2) * r.a6,
            a7: self.a0.powi(2) * r.a7 - 2. * self.a0 * self.a2 * r.a12 + 2. * self.a0 * self.a3 * r.a13 - 2. * self.a0 * self.a5 * r.a9 + 2. * self.a0 * self.a6 * r.a10 + 2. * self.a0 * self.a9 * r.a5 - 2. * self.a0 * self.a10 * r.a6 + 2. * self.a0 * self.a11 * r.a14 - 2. * self.a0 * self.a14 * r.a11 - 2. * self.a0 * self.a15 * r.a8 + 2. * self.a1 * self.a2 * r.a9 - 2. * self.a1 * self.a3 * r.a10 + 2. * self.a1 * self.a8 * r.a14 + 2. * self.a1 * self.a14 * r.a8 + self.a2.powi(2) * r.a7 - 2. * self.a2 * self.a4 * r.a5 + 2. * self.a2 * self.a6 * r.a14 + 2. * self.a2 * self.a8 * r.a13 - 2. * self.a2 * self.a10 * r.a11 + 2. * self.a2 * self.a11 * r.a10 - 2. * self.a2 * self.a13 * r.a8 - 2. * self.a2 * self.a14 * r.a6 + self.a3.powi(2) * r.a7 - 2. * self.a3 * self.a4 * r.a6 - 2. * self.a3 * self.a5 * r.a14 + 2. * self.a3 * self.a8 * r.a12 - 2. * self.a3 * self.a9 * r.a11 + 2. * self.a3 * self.a11 * r.a9 - 2. * self.a3 * self.a12 * r.a8 + 2. * self.a3 * self.a14 * r.a5 - self.a4.powi(2) * r.a7 + 2. * self.a4 * self.a8 * r.a11 + 2. * self.a4 * self.a9 * r.a12 + 2. * self.a4 * self.a10 * r.a13 + 2. * self.a4 * self.a11 * r.a8 + 2. * self.a4 * self.a12 * r.a9 + 2. * self.a4 * self.a13 * r.a10 - 2. * self.a4 * self.a15 * r.a14 + 2. * self.a5 * self.a8 * r.a10 - 2. * self.a5 * self.a10 * r.a8 + 2. * self.a6 * self.a8 * r.a9 - 2. * self.a6 * self.a9 * r.a8 + 2. * self.a7 * self.a8 * r.a8 + 2. * self.a7 * self.a9 * r.a9 + 2. * self.a7 * self.a10 * r.a10 + 2. * self.a7 * self.a14 * r.a14 + self.a8.powi(2) * r.a7 + 2. * self.a8 * self.a9 * r.a6 + 2. * self.a8 * self.a10 * r.a5 - self.a9.powi(2) * r.a7 + 2. * self.a9 * self.a13 * r.a14 - 2. * self.a9 * self.a14 * r.a13 - 2. * self.a9 * self.a15 * r.a10 - self.a10.powi(2) * r.a7 - 2. * self.a10 * self.a12 * r.a14 + 2. * self.a10 * self.a14 * r.a12 + 2. * self.a10 * self.a15 * r.a9 - 2. * self.a12 * self.a14 * r.a10 + 2. * self.a13 * self.a14 * r.a9 - self.a14.powi(2) * r.a7,
            a8: self.a0.powi(2) * r.a8 + 2. * self.a0 * self.a4 * r.a14 + 2. * self.a0 * self.a9 * r.a10 - 2. * self.a0 * self.a10 * r.a9 - self.a2.powi(2) * r.a8 + 2. * self.a2 * self.a4 * r.a10 + 2. * self.a2 * self.a9 * r.a14 + 2. * self.a2 * self.a14 * r.a9 - self.a3.powi(2) * r.a8 + 2. * self.a3 * self.a4 * r.a9 - 2. * self.a3 * self.a10 * r.a14 - 2. * self.a3 * self.a14 * r.a10 + self.a4.powi(2) * r.a8 + self.a8.powi(2) * r.a8 + 2. * self.a8 * self.a9 * r.a9 + 2. * self.a8 * self.a10 * r.a10 + 2. * self.a8 * self.a14 * r.a14 - self.a9.powi(2) * r.a8 - self.a10.powi(2) * r.a8 + self.a14.powi(2) * r.a8,
            a9: self.a0.powi(2) * r.a9 + 2. * self.a0 * self.a3 * r.a14 - 2. * self.a0 * self.a8 * r.a10 + 2. * self.a0 * self.a10 * r.a8 - self.a2.powi(2) * r.a9 + 2. * self.a2 * self.a3 * r.a10 - 2. * self.a2 * self.a8 * r.a14 - 2. * self.a2 * self.a14 * r.a8 + self.a3.powi(2) * r.a9 + 2. * self.a3 * self.a4 * r.a8 - self.a4.powi(2) * r.a9 + 2. * self.a4 * self.a10 * r.a14 + 2. * self.a4 * self.a14 * r.a10 - self.a8.powi(2) * r.a9 + 2. * self.a8 * self.a9 * r.a8 + self.a9.powi(2) * r.a9 + 2. * self.a9 * self.a10 * r.a10 + 2. * self.a9 * self.a14 * r.a14 - self.a10.powi(2) * r.a9 + self.a14.powi(2) * r.a9,
            a10: self.a0.powi(2) * r.a10 + 2. * self.a0 * self.a2 * r.a14 + 2. * self.a0 * self.a8 * r.a9 - 2. * self.a0 * self.a9 * r.a8 + self.a2.powi(2) * r.a10 + 2. * self.a2 * self.a3 * r.a9 + 2. * self.a2 * self.a4 * r.a8 - self.a3.powi(2) * r.a10 + 2. * self.a3 * self.a8 * r.a14 + 2. * self.a3 * self.a14 * r.a8 - self.a4.powi(2) * r.a10 - 2. * self.a4 * self.a9 * r.a14 - 2. * self.a4 * self.a14 * r.a9 - self.a8.powi(2) * r.a10 + 2. * self.a8 * self.a10 * r.a8 - self.a9.powi(2) * r.a10 + 2. * self.a9 * self.a10 * r.a9 + self.a10.powi(2) * r.a10 + 2. * self.a10 * self.a14 * r.a14 + self.a14.powi(2) * r.a10,
            a11: self.a0.powi(2) * r.a11 - 2. * self.a0 * self.a1 * r.a8 + 2. * self.a0 * self.a2 * r.a6 - 2. * self.a0 * self.a3 * r.a5 - 2. * self.a0 * self.a7 * r.a14 + 2. * self.a0 * self.a9 * r.a13 - 2. * self.a0 * self.a10 * r.a12 + 2. * self.a0 * self.a12 * r.a10 - 2. * self.a0 * self.a13 * r.a9 + 2. * self.a0 * self.a14 * r.a7 - 2. * self.a1 * self.a4 * r.a14 - 2. * self.a1 * self.a9 * r.a10 + 2. * self.a1 * self.a10 * r.a9 + self.a2.powi(2) * r.a11 - 2. * self.a2 * self.a4 * r.a13 + 2. * self.a2 * self.a5 * r.a8 - 2. * self.a2 * self.a7 * r.a10 - 2. * self.a2 * self.a8 * r.a5 + 2. * self.a2 * self.a10 * r.a7 + 2. * self.a2 * self.a12 * r.a14 - 2. * self.a2 * self.a14 * r.a12 - 2. * self.a2 * self.a15 * r.a9 + self.a3.powi(2) * r.a11 - 2. * self.a3 * self.a4 * r.a12 + 2. * self.a3 * self.a6 * r.a8 - 2. * self.a3 * self.a7 * r.a9 - 2. * self.a3 * self.a8 * r.a6 + 2. * self.a3 * self.a9 * r.a7 - 2. * self.a3 * self.a13 * r.a14 + 2. * self.a3 * self.a14 * r.a13 + 2. * self.a3 * self.a15 * r.a10 - self.a4.powi(2) * r.a11 - 2. * self.a4 * self.a5 * r.a10 - 2. * self.a4 * self.a6 * r.a9 - 2. * self.a4 * self.a7 * r.a8 - 2. * self.a4 * self.a8 * r.a7 - 2. * self.a4 * self.a9 * r.a6 - 2. * self.a4 * self.a10 * r.a5 - 2. * self.a5 * self.a9 * r.a14 - 2. * self.a5 * self.a14 * r.a9 + 2. * self.a6 * self.a10 * r.a14 + 2. * self.a6 * self.a14 * r.a10 + self.a8.powi(2) * r.a11 + 2. * self.a8 * self.a9 * r.a12 + 2. * self.a8 * self.a10 * r.a13 + 2. * self.a8 * self.a11 * r.a8 + 2. * self.a8 * self.a12 * r.a9 + 2. * self.a8 * self.a13 * r.a10 - 2. * self.a8 * self.a15 * r.a14 - self.a9.powi(2) * r.a11 + 2. * self.a9 * self.a11 * r.a9 - 2. * self.a9 * self.a12 * r.a8 + 2. * self.a9 * self.a14 * r.a5 - self.a10.powi(2) * r.a11 + 2. * self.a10 * self.a11 * r.a10 - 2. * self.a10 * self.a13 * r.a8 - 2. * self.a10 * self.a14 * r.a6 + 2. * self.a11 * self.a14 * r.a14 - self.a14.powi(2) * r.a11 - 2. * self.a14 * self.a15 * r.a8,
            a12: self.a0.powi(2) * r.a12 - 2. * self.a0 * self.a1 * r.a9 - 2. * self.a0 * self.a2 * r.a7 + 2. * self.a0 * self.a4 * r.a5 - 2. * self.a0 * self.a6 * r.a14 - 2. * self.a0 * self.a8 * r.a13 + 2. * self.a0 * self.a10 * r.a11 - 2. * self.a0 * self.a11 * r.a10 + 2. * self.a0 * self.a13 * r.a8 + 2. * self.a0 * self.a14 * r.a6 - 2. * self.a1 * self.a3 * r.a14 + 2. * self.a1 * self.a8 * r.a10 - 2. * self.a1 * self.a10 * r.a8 + self.a2.powi(2) * r.a12 - 2. * self.a2 * self.a3 * r.a13 + 2. * self.a2 * self.a5 * r.a9 - 2. * self.a2 * self.a6 * r.a10 - 2. * self.a2 * self.a9 * r.a5 + 2. * self.a2 * self.a10 * r.a6 - 2. * self.a2 * self.a11 * r.a14 + 2. * self.a2 * self.a14 * r.a11 + 2. * self.a2 * self.a15 * r.a8 - self.a3.powi(2) * r.a12 - 2. * self.a3 * self.a4 * r.a11 - 2. * self.a3 * self.a5 * r.a10 - 2. * self.a3 * self.a6 * r.a9 - 2. * self.a3 * self.a7 * r.a8 - 2. * self.a3 * self.a8 * r.a7 - 2. * self.a3 * self.a9 * r.a6 - 2. * self.a3 * self.a10 * r.a5 + self.a4.powi(2) * r.a12 - 2. * self.a4 * self.a6 * r.a8 + 2. * self.a4 * self.a7 * r.a9 + 2. * self.a4 * self.a8 * r.a6 - 2. * self.a4 * self.a9 * r.a7 + 2. * self.a4 * self.a13 * r.a14 - 2. * self.a4 * self.a14 * r.a13 - 2. * self.a4 * self.a15 * r.a10 + 2. * self.a5 * self.a8 * r.a14 + 2. * self.a5 * self.a14 * r.a8 - 2. * self.a7 * self.a10 * r.a14 - 2. * self.a7 * self.a14 * r.a10 - self.a8.powi(2) * r.a12 + 2. * self.a8 * self.a9 * r.a11 - 2. * self.a8 * self.a11 * r.a9 + 2. * self.a8 * self.a12 * r.a8 - 2. * self.a8 * self.a14 * r.a5 + self.a9.powi(2) * r.a12 + 2. * self.a9 * self.a10 * r.a13 + 2. * self.a9 * self.a11 * r.a8 + 2. * self.a9 * self.a12 * r.a9 + 2. * self.a9 * self.a13 * r.a10 - 2. * self.a9 * self.a15 * r.a14 - self.a10.powi(2) * r.a12 + 2. * self.a10 * self.a12 * r.a10 - 2. * self.a10 * self.a13 * r.a9 + 2. * self.a10 * self.a14 * r.a7 + 2. * self.a12 * self.a14 * r.a14 - self.a14.powi(2) * r.a12 - 2. * self.a14 * self.a15 * r.a9,
            a13: self.a0.powi(2) * r.a13 - 2. * self.a0 * self.a1 * r.a10 + 2. * self.a0 * self.a3 * r.a7 - 2. * self.a0 * self.a4 * r.a6 - 2. * self.a0 * self.a5 * r.a14 + 2. * self.a0 * self.a8 * r.a12 - 2. * self.a0 * self.a9 * r.a11 + 2. * self.a0 * self.a11 * r.a9 - 2. * self.a0 * self.a12 * r.a8 + 2. * self.a0 * self.a14 * r.a5 - 2. * self.a1 * self.a2 * r.a14 - 2. * self.a1 * self.a8 * r.a9 + 2. * self.a1 * self.a9 * r.a8 - self.a2.powi(2) * r.a13 - 2. * self.a2 * self.a3 * r.a12 - 2. * self.a2 * self.a4 * r.a11 - 2. * self.a2 * self.a5 * r.a10 - 2. * self.a2 * self.a6 * r.a9 - 2. * self.a2 * self.a7 * r.a8 - 2. * self.a2 * self.a8 * r.a7 - 2. * self.a2 * self.a9 * r.a6 - 2. * self.a2 * self.a10 * r.a5 + self.a3.powi(2) * r.a13 - 2. * self.a3 * self.a5 * r.a9 + 2. * self.a3 * self.a6 * r.a10 + 2. * self.a3 * self.a9 * r.a5 - 2. * self.a3 * self.a10 * r.a6 + 2. * self.a3 * self.a11 * r.a14 - 2. * self.a3 * self.a14 * r.a11 - 2. * self.a3 * self.a15 * r.a8 + self.a4.powi(2) * r.a13 - 2. * self.a4 * self.a5 * r.a8 + 2. * self.a4 * self.a7 * r.a10 + 2. * self.a4 * self.a8 * r.a5 - 2. * self.a4 * self.a10 * r.a7 - 2. * self.a4 * self.a12 * r.a14 + 2. * self.a4 * self.a14 * r.a12 + 2. * self.a4 * self.a15 * r.a9 - 2. * self.a6 * self.a8 * r.a14 - 2. * self.a6 * self.a14 * r.a8 + 2. * self.a7 * self.a9 * r.a14 + 2. * self.a7 * self.a14 * r.a9 - self.a8.powi(2) * r.a13 + 2. * self.a8 * self.a10 * r.a11 - 2. * self.a8 * self.a11 * r.a10 + 2. * self.a8 * self.a13 * r.a8 + 2. * self.a8 * self.a14 * r.a6 - self.a9.powi(2) * r.a13 + 2. * self.a9 * self.a10 * r.a12 - 2. * self.a9 * self.a12 * r.a10 + 2. * self.a9 * self.a13 * r.a9 - 2. * self.a9 * self.a14 * r.a7 + self.a10.powi(2) * r.a13 + 2. * self.a10 * self.a11 * r.a8 + 2. * self.a10 * self.a12 * r.a9 + 2. * self.a10 * self.a13 * r.a10 - 2. * self.a10 * self.a15 * r.a14 + 2. * self.a13 * self.a14 * r.a14 - self.a14.powi(2) * r.a13 - 2. * self.a14 * self.a15 * r.a10,
            a14: self.a0.powi(2) * r.a14 + 2. * self.a0 * self.a2 * r.a10 + 2. * self.a0 * self.a3 * r.a9 + 2. * self.a0 * self.a4 * r.a8 + self.a2.powi(2) * r.a14 + 2. * self.a2 * self.a8 * r.a9 - 2. * self.a2 * self.a9 * r.a8 + self.a3.powi(2) * r.a14 - 2. * self.a3 * self.a8 * r.a10 + 2. * self.a3 * self.a10 * r.a8 + self.a4.powi(2) * r.a14 + 2. * self.a4 * self.a9 * r.a10 - 2. * self.a4 * self.a10 * r.a9 + self.a8.powi(2) * r.a14 + 2. * self.a8 * self.a14 * r.a8 + self.a9.powi(2) * r.a14 + 2. * self.a9 * self.a14 * r.a9 + self.a10.powi(2) * r.a14 + 2. * self.a10 * self.a14 * r.a10 + self.a14.powi(2) * r.a14,
            a15: self.a0.powi(2) * r.a15 - 2. * self.a0 * self.a11 * r.a4 - 2. * self.a0 * self.a12 * r.a3 - 2. * self.a0 * self.a13 * r.a2 - 2. * self.a0 * self.a14 * r.a1 + 2. * self.a0 * self.a15 * r.a0 - 2. * self.a1 * self.a8 * r.a4 - 2. * self.a1 * self.a9 * r.a3 - 2. * self.a1 * self.a10 * r.a2 - 2. * self.a1 * self.a14 * r.a0 - self.a2.powi(2) * r.a15 + 2. * self.a2 * self.a6 * r.a4 - 2. * self.a2 * self.a7 * r.a3 + 2. * self.a2 * self.a10 * r.a1 - 2. * self.a2 * self.a13 * r.a0 + 2. * self.a2 * self.a15 * r.a2 - self.a3.powi(2) * r.a15 - 2. * self.a3 * self.a5 * r.a4 + 2. * self.a3 * self.a7 * r.a2 + 2. * self.a3 * self.a9 * r.a1 - 2. * self.a3 * self.a12 * r.a0 + 2. * self.a3 * self.a15 * r.a3 - self.a4.powi(2) * r.a15 + 2. * self.a4 * self.a5 * r.a3 - 2. * self.a4 * self.a6 * r.a2 + 2. * self.a4 * self.a8 * r.a1 - 2. * self.a4 * self.a11 * r.a0 + 2. * self.a4 * self.a15 * r.a4 - 2. * self.a5 * self.a10 * r.a0 - 2. * self.a5 * self.a14 * r.a2 - 2. * self.a6 * self.a9 * r.a0 - 2. * self.a6 * self.a14 * r.a3 - 2. * self.a7 * self.a8 * r.a0 - 2. * self.a7 * self.a14 * r.a4 + self.a8.powi(2) * r.a15 + 2. * self.a8 * self.a12 * r.a2 - 2. * self.a8 * self.a13 * r.a3 + self.a9.powi(2) * r.a15 - 2. * self.a9 * self.a11 * r.a2 + 2. * self.a9 * self.a13 * r.a4 + self.a10.powi(2) * r.a15 + 2. * self.a10 * self.a11 * r.a3 - 2. * self.a10 * self.a12 * r.a4 - self.a14.powi(2) * r.a15,
        }
    }
}

impl Bivector {
    pub fn exp(self) -> ScalarAndBivector {
        let theta = self.norm();
        if theta.abs() < FLOAT_DIVISION_EPSILON {
            1. + self
        } else {
            theta.cos() + (theta.sin() / theta) * self
        }
    }
}

pub type Point = Trivector;
pub type Line = Bivector;
pub type Plane = Vector;

impl Point {
    pub fn from_xyz(x: Float, y: Float, z: Float) -> Point {
        Point {
            a13: x,
            a12: y,
            a11: z,
            a14: 1.,
        }
    }

    pub fn to_xyz(self) -> (Float, Float, Float) {
        let inv_w = 1. / self.a14;
        (inv_w * self.a13, inv_w * self.a12, inv_w * self.a11)
    }
}

